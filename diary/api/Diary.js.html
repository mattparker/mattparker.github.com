<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns:yui="http://yuilibrary.com/rdf/1.0/yui.rdf#">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<title>API: diary   Diary.js  (YUI Library)</title>

	<link rel="stylesheet" type="text/css" href="assets/reset-fonts-grids-min.css?stamp=1273870729.64" />
	<link rel="stylesheet" type="text/css" href="assets/api.css?stamp=1273870729.64" />

    <script type="text/javascript" src="assets/api-js?stamp=1273870729.64"></script>
    <script type="text/javascript" src="assets/ac-js?stamp=1273870729.64"></script>
</head>

<body id="yahoo-com">

<div id="doc3" class="yui-t2">
	<div id="hd">
        <h1><a href="http://developer.yahoo.com/yui/" title="Yahoo! UI Library">Yahoo! UI Library</a></h1>
        <h3>Diary widget&nbsp; <span class="subtitle">1.0</span></h3>
        <a href="./index.html" title="Yahoo! UI Library">Yahoo! UI Library</a> 
            &gt; <a href="./module_diary.html" title="diary">diary</a>
                
                 &gt; Diary.js (source view) 
        <form onsubmit="return false">
            <div id="propertysearch">
                Search: <input autocomplete="off" id="searchinput" />
                <div id="searchresults">
                    &nbsp;
                </div>
            </div>
        </form>
	</div>

	<div id="bd">
		<div id="yui-main">
			<div class="yui-b">
            <form action="#" name="yui-classopts-form" method="get" id="yui-classopts-form">
                <fieldset>
                    <legend>Filters</legend>
                <span class="classopts"><input type="checkbox" name="show_private" id="show_private" /> <label for="show_private">Show Private</label></span>
                <span class="classopts"><input type="checkbox" name="show_protected" id="show_protected" /> <label for="show_protected">Show Protected</label></span>
                <span class="classopts"><input type="checkbox" name="show_deprecated" id="show_deprecated" /> <label for="show_deprecated">Show Deprecated</label></span>
                </fieldset>
            </form>

                    <div id="srcout">
                        <style>
                            #doc3 .classopts { display:none; }
                        </style>
<div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">Copyright (c) 2010, Lamplight Database Systems Limited, http://www.lamplightdb.co.uk</span>
<span class="cm">Code licensed under the BSD License:</span>
<span class="cm">http://developer.yahoo.com/yui/license.html</span>
<span class="cm">version: 1.0</span>
<span class="cm">*/</span>


<span class="cm">/**</span>
<span class="cm"> * YAHOO.widget.Diary produces a weekly diary showing events, and allows them to</span>
<span class="cm"> * be editted.</span>
<span class="cm"> *</span>
<span class="cm"> * @module diary</span>
<span class="cm"> * @requires yahoo, event, event-delegate, event-mouseenter, dom, datasource, selector, dragdrop, resize, datemath, calendar</span>
<span class="cm"> * @optional anim, container</span>
<span class="cm"> * @title Diary widget</span>
<span class="cm"> *</span>
<span class="cm"> * @description</span>
<span class="cm"> * &lt;p&gt;Diary uses a YAHOO.util.Datasource with, minimally, start and end dates.</span>
<span class="cm"> * Items in the diary can be rescheduled using drag and drop, or times changed using resize.</span>
<span class="cm"> * New items can be added by click-and-dragging on the diary to provide the </span>
<span class="cm"> * start and end times.&lt;/p&gt;</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>


    <span class="kd">var</span> <span class="nx">Dom</span> <span class="o">=</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Dom</span><span class="p">,</span>
        <span class="nx">Ev</span>  <span class="o">=</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Event</span><span class="p">,</span>
        <span class="nx">DM</span>  <span class="o">=</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">DateMath</span><span class="p">,</span>
        <span class="nx">Lang</span> <span class="o">=</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">lang</span><span class="p">,</span>
      
      

     
     
        <span class="nx">CLASS_DIARY</span>                    <span class="o">=</span> <span class="s2">&quot;yui-diary&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_ITEM_DETAILS</span>       <span class="o">=</span> <span class="s2">&quot;yui-diary-item-details&quot;</span> <span class="p">,</span>
        <span class="nx">CLASS_DIARY_ITEM</span>               <span class="o">=</span> <span class="s2">&quot;yui-diary-item&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_DATACONTAINER</span>      <span class="o">=</span> <span class="s2">&quot;yui-diary-datacontainer&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARYDAY_CONTAINER</span>       <span class="o">=</span> <span class="s2">&quot;yui-diaryday-container&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_BACKGROUND</span>         <span class="o">=</span> <span class="s2">&quot;yui-diary-background&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_HOURBLOCK</span>          <span class="o">=</span> <span class="s2">&quot;yui-diary-hourblock&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_DAY</span>                <span class="o">=</span> <span class="s2">&quot;yui-diary-day&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_CONTAINER</span>          <span class="o">=</span> <span class="s2">&quot;yui-diary-container&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_NAV</span>                <span class="o">=</span> <span class="s2">&quot;yui-diary-nav&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_TITLE</span>              <span class="o">=</span> <span class="s2">&quot;yui-diary-title&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_NAV_LEFT</span>           <span class="o">=</span> <span class="s2">&quot;yui-diary-nav-left&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_NAV_RIGHT</span>          <span class="o">=</span> <span class="s2">&quot;yui-diary-nav-right&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_NAV_TODAY</span>          <span class="o">=</span> <span class="s2">&quot;yui-diary-nav-today&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_NAV_CAL</span>            <span class="o">=</span> <span class="s2">&quot;yui-diary-nav-cal&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_NAV_CALBUTTON</span>      <span class="o">=</span> <span class="s2">&quot;yui-diary-nav-calbutton&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_COLLABEL_CONTAINER</span> <span class="o">=</span> <span class="s2">&quot;yui-diary-collabel-container&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_COLLABEL</span>           <span class="o">=</span> <span class="s2">&quot;yui-diary-collabel&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_ITEM_HIDDEN</span>        <span class="o">=</span> <span class="s2">&quot;yui-diary-item-hidden&quot;</span><span class="p">,</span>
        <span class="nx">CLASS_DIARY_SELECTOR</span>           <span class="o">=</span> <span class="s2">&quot;yui-diary-selector&quot;</span><span class="p">,</span>
        
  <span class="cm">/**</span>
<span class="cm">   *</span>
<span class="cm">   * &lt;p&gt;DiaryItem class for individual items in the Diary.&lt;/p&gt;</span>
<span class="cm">   *</span>
<span class="cm">   * &lt;p&gt;Data and display for particular diary item.</span>
<span class="cm">   * Extends resize (and includes drag drop).  This class shouldn&#39;t be used</span>
<span class="cm">   * directly; items to be added should be added by the Diary.addItem() method.</span>
<span class="cm">   * &lt;/p&gt;</span>
<span class="cm">   *</span>
<span class="cm">   * @class DiaryItem</span>
<span class="cm">   * @extends YAHOO.util.Resize</span>
<span class="cm">   * @param elContainer {HTMLElement | String} Container for the DiaryItem</span>
<span class="cm">   * @param oCfg {Object}  Object literal of configuration values.  oCfg.DTSTART and oCfg.DTEND are required.</span>
<span class="cm">   *</span>
<span class="cm">   */</span>
  <span class="nx">DiaryItem</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">oCfg</span><span class="p">)</span> <span class="p">{</span>

     
        <span class="nx">oCfg</span><span class="p">.</span><span class="nx">handles</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">oCfg</span><span class="p">.</span><span class="nx">resizeTop</span><span class="p">)</span> <span class="p">{</span> 
            <span class="nx">oCfg</span><span class="p">.</span><span class="nx">handles</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">);</span> 
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">oCfg</span><span class="p">.</span><span class="nx">resizeBottom</span><span class="p">)</span> <span class="p">{</span> 
            <span class="nx">oCfg</span><span class="p">.</span><span class="nx">handles</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">);</span> 
        <span class="p">}</span>


        <span class="nx">oCfg</span><span class="p">.</span><span class="nx">draggable</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="nx">oCfg</span><span class="p">.</span><span class="nx">hiddenHandles</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">oCfg</span><span class="p">.</span><span class="nx">proxy</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="nx">oCfg</span><span class="p">.</span><span class="nx">yTicks</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">oCfg</span><span class="p">.</span><span class="nx">pxPerHour</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>


        <span class="c1">// add a drag drop separately</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">oCfg</span><span class="p">.</span><span class="nx">enableDragDrop</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">dd</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">DD</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">isTarget</span><span class="o">:</span> <span class="kc">false</span><span class="p">});</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span> <span class="o">=</span> <span class="nx">dd</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
     
     
        <span class="k">this</span><span class="p">.</span><span class="nx">_multiDayChildren</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_categories</span> <span class="o">=</span> <span class="p">[];</span>
     
        <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;constructor for new DiaryItem &quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">);</span>     
     
        <span class="nx">DiaryItem</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">el</span><span class="p">,</span> <span class="nx">oCfg</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span><span class="p">.</span><span class="nx">setYConstraint</span><span class="p">(</span> 
                <span class="k">this</span><span class="p">.</span><span class="nx">calculateTop</span><span class="p">(),</span> 
                <span class="nb">parseInt</span><span class="p">((</span><span class="mi">24</span> <span class="o">*</span> <span class="nx">oCfg</span><span class="p">.</span><span class="nx">pxPerHour</span> <span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">calculateTop</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">),</span> <span class="mi">10</span><span class="p">),</span> 
                <span class="nx">oCfg</span><span class="p">.</span><span class="nx">yTicks</span> 
            <span class="p">);</span>
        <span class="p">}</span>
     
        <span class="c1">// default no animation initially</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">anim</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

     


        <span class="k">this</span><span class="p">.</span><span class="nx">initContent</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">initListeners</span><span class="p">();</span>


        
	      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span>



  <span class="cm">/**</span>
<span class="cm">   * DiaryItem extends Resize:</span>
<span class="cm">   */</span>
  <span class="nx">Lang</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">DiaryItem</span><span class="p">,</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Resize</span><span class="p">,</span> <span class="p">{</span>

      <span class="cm">/**</span>
<span class="cm">       * String that separates hours and minutes</span>
<span class="cm">       * @property TIME_SEPARATOR </span>
<span class="cm">       * @type {String}</span>
<span class="cm">       * @default &quot;:&quot;</span>
<span class="cm">       */</span>
      <span class="nx">TIME_SEPARATOR</span><span class="o">:</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span>
      
      <span class="cm">/**</span>
<span class="cm">       * What vertical line is this one in?</span>
<span class="cm">       * @property _line</span>
<span class="cm">       * @type Int</span>
<span class="cm">       * @private</span>
<span class="cm">       * @default 1</span>
<span class="cm">       */</span>
      <span class="nx">_line</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
      
      <span class="cm">/**</span>
<span class="cm">       * Element holding the details</span>
<span class="cm">       * @property _detailsEl</span>
<span class="cm">       * @private</span>
<span class="cm">       * @default: null</span>
<span class="cm">       * @type HTMLElement</span>
<span class="cm">       */</span>
      <span class="nx">_detailsEl</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
      
      <span class="cm">/**</span>
<span class="cm">       * The YAHOO.util.DD instance.</span>
<span class="cm">       * We don&#39;t use the built-in one with Resize because some events don&#39;t</span>
<span class="cm">       * come through properly.</span>
<span class="cm">       * @property dragdrop</span>
<span class="cm">       * @type YAHOO.util.DragDrop</span>
<span class="cm">       * @default null</span>
<span class="cm">       */</span>
      <span class="nx">dragdrop</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
      
      <span class="cm">/**</span>
<span class="cm">       * For animating movement on drag drop</span>
<span class="cm">       * @property anim</span>
<span class="cm">       * @default: false</span>
<span class="cm">       * @type YAHOO.util.Anim</span>
<span class="cm">       */</span>
      <span class="nx">anim</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
      
      <span class="cm">/**</span>
<span class="cm">       * Remembers where we start from</span>
<span class="cm">       * @property _cacheDates</span>
<span class="cm">       * @private</span>
<span class="cm">       * @default: Array</span>
<span class="cm">       * @type Array</span>
<span class="cm">       */</span>
      <span class="nx">_cacheDates</span><span class="o">:</span> <span class="p">{},</span>
      

      
      
      <span class="cm">/**</span>
<span class="cm">       * References to other elements in multi-day events</span>
<span class="cm">       * @property _multiDayChildren</span>
<span class="cm">       * @private</span>
<span class="cm">       * @default: []</span>
<span class="cm">       * @type Array</span>
<span class="cm">       */</span>
      <span class="nx">_multiDayChildren</span><span class="o">:</span> <span class="p">[],</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * Array of categories, set by CATEGORIES method which parses the string</span>
<span class="cm">       * given in the config object.</span>
<span class="cm">       * @property _categories</span>
<span class="cm">       * @private</span>
<span class="cm">       * @default: []</span>
<span class="cm">       * @type Array</span>
<span class="cm">       */</span>
      <span class="nx">_categories</span><span class="o">:</span> <span class="p">[],</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * Implementation of Element&#39;s abstract method. Sets up config values.</span>
<span class="cm">       *</span>
<span class="cm">       * @method initAttributes</span>
<span class="cm">       * @param oCfg {Object} Object literal definition of configuration values.</span>
<span class="cm">       * @private</span>
<span class="cm">       */</span>
      <span class="nx">initAttributes</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">oCfg</span><span class="p">){</span>

         
         <span class="nx">DiaryItem</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">initAttributes</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">oCfg</span><span class="p">);</span>
         

         <span class="cm">/**</span>
<span class="cm">          * @attribute UID</span>
<span class="cm">          * @description The unique id of the item.  Write once.</span>
<span class="cm">          * @default: &#39;&#39;</span>
<span class="cm">          * @type String</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;UID&#39;</span><span class="p">,</span> <span class="p">{</span>
         
           <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
           <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="p">,</span>
           <span class="nx">writeOnce</span><span class="o">:</span> <span class="kc">true</span>
         
         <span class="p">});</span>
         
         <span class="cm">/**</span>
<span class="cm">          * @attribute LOCATION</span>
<span class="cm">          * @descrition The location of the Item</span>
<span class="cm">          * @default: &#39;&#39;</span>
<span class="cm">          * @type String</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;LOCATION&#39;</span><span class="p">,</span> <span class="p">{</span>
           <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
           <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span>
         <span class="p">});</span>
         
         
         
         <span class="cm">/**</span>
<span class="cm">          * @attribute useCssCategories</span>
<span class="cm">          * @description If true, any CATEGORIES will be added as css classes</span>
<span class="cm">          * to the container element for the item, allowing styling and filtering.</span>
<span class="cm">          * Anything passed to backClass will also be added.  Spaces in categories</span>
<span class="cm">          * will be changed to hyphens.</span>
<span class="cm">          * @type Boolean</span>
<span class="cm">          * @default false</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;useCssCategories&#39;</span><span class="p">,</span> <span class="p">{</span>
           <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span><span class="p">,</span>
           <span class="nx">value</span><span class="o">:</span> <span class="kc">false</span>
         <span class="p">});</span>
         
         
         <span class="cm">/**</span>
<span class="cm">          * @attribute CATEGORIES</span>
<span class="cm">          * @description Comma separated string of categories for this Item.  If</span>
<span class="cm">          * useCssCategories is true these will be added as css classes (with</span>
<span class="cm">          * hyphens replacing spaces.</span>
<span class="cm">          * @type String</span>
<span class="cm">          * @default &#39;&#39;</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;CATEGORIES&#39;</span><span class="p">,</span> <span class="p">{</span>
           <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="p">,</span>
           <span class="nx">method</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span>
           
             <span class="kd">var</span> <span class="nx">spaceToHyphen</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">return</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">str</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/ /g</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">);</span>
             <span class="p">},</span>
                 <span class="nx">cats</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="nx">i</span><span class="p">,</span>
                 <span class="nx">openQuote</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
                 <span class="nx">thisCategory</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
           
             <span class="c1">// if there are quotes in the string, we&#39;ll need to parse it carefully</span>
             <span class="k">if</span> <span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span> <span class="s1">&#39;&quot;&#39;</span> <span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>

                 <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">v</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
                   
                   <span class="k">switch</span> <span class="p">(</span><span class="nx">v</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="p">{</span>
                     <span class="k">case</span> <span class="s1">&#39;&quot;&#39;</span><span class="o">:</span>
                       <span class="nx">openQuote</span> <span class="o">=</span> <span class="o">!</span><span class="nx">openQuote</span><span class="p">;</span>
                       <span class="c1">// end of a string</span>
                       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">openQuote</span><span class="p">)</span> <span class="p">{</span>
                         <span class="k">this</span><span class="p">.</span><span class="nx">_categories</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="nx">spaceToHyphen</span><span class="p">(</span><span class="nx">thisCategory</span><span class="p">)</span> <span class="p">);</span>
                         <span class="nx">thisCategory</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
                       <span class="p">}</span> 
                     <span class="k">break</span><span class="p">;</span>
                    
                     <span class="k">default</span><span class="o">:</span>
                       <span class="nx">thisCategory</span> <span class="o">+=</span> <span class="nx">v</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                     <span class="k">break</span><span class="p">;</span>
                   <span class="p">}</span>
                   
                 <span class="p">}</span>
               
             <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span> <span class="p">{</span>
               <span class="c1">// multiple items: split them up and tidy them up</span>
               <span class="nx">cats</span> <span class="o">=</span> <span class="nx">v</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">);</span>
               <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">cats</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                 <span class="nx">cats</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">spaceToHyphen</span><span class="p">(</span><span class="nx">cats</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
               <span class="p">}</span>
               <span class="k">this</span><span class="p">.</span><span class="nx">_categories</span> <span class="o">=</span> <span class="nx">cats</span><span class="p">;</span>
             <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
               <span class="c1">// just one category</span>
               <span class="k">this</span><span class="p">.</span><span class="nx">_categories</span> <span class="o">=</span> <span class="p">[</span><span class="nx">spaceToHyphen</span><span class="p">(</span><span class="nx">v</span><span class="p">)];</span>
             <span class="p">}</span>
           <span class="p">}</span>
         <span class="p">});</span>
         

         <span class="cm">/**</span>
<span class="cm">          * @attribute SUMMARY</span>
<span class="cm">          * @description Summary text displayed on diary</span>
<span class="cm">          * @type String</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;SUMMARY&#39;</span><span class="p">,</span> <span class="p">{</span>
         
           <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
           <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span>
         
         <span class="p">});</span>
         
         
         <span class="cm">/**</span>
<span class="cm">          * @attribute DESCRIPTION</span>
<span class="cm">          * @description Full text displayed on diary </span>
<span class="cm">          * @type String</span>
<span class="cm">          * @default &quot;&quot;</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;DESCRIPTION&#39;</span><span class="p">,</span> <span class="p">{</span>
         
           <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
           <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span>
         
         <span class="p">});</span>

         <span class="cm">/**</span>
<span class="cm">          * @attribute useAnimation</span>
<span class="cm">          * @description  Whether to use animation after drag drops</span>
<span class="cm">          * @type Boolean</span>
<span class="cm">          * @default false</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;useAnimation&#39;</span><span class="p">,</span> <span class="p">{</span>
          
          <span class="nx">value</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
          <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span>
         
         <span class="p">});</span> 
         
         <span class="cm">/**</span>
<span class="cm">          * @attribute backClass</span>
<span class="cm">          * @description Adds css class(es) to the background Item container</span>
<span class="cm">          * @type String class name to add</span>
<span class="cm">          * @default &quot;&quot;</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;backClass&#39;</span><span class="p">,</span> <span class="p">{</span>
         
           <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
           <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span>
         
         <span class="p">});</span>
         
         <span class="cm">/**</span>
<span class="cm">          * @attribute detailClass</span>
<span class="cm">          * @description Adds css class(es) to the text div container Item container</span>
<span class="cm">          * @type String class name to add</span>
<span class="cm">          * @default &quot;&quot;</span>
<span class="cm">          */</span>         
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;detailClass&#39;</span><span class="p">,</span> <span class="p">{</span>
         
           <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
           <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span>
         
         <span class="p">});</span>



         <span class="cm">/**</span>
<span class="cm">          * @attribute column</span>
<span class="cm">          * @description Reference to the column (ie day) this item is in</span>
<span class="cm">          * @type Object DiaryDay</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="p">{</span>
         
           <span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
           <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isObject</span>
         
         <span class="p">});</span>
         
         
         <span class="cm">/**</span>
<span class="cm">          * @attribute multiDayPosition</span>
<span class="cm">          * @description Where this item falls if it&#39;s a multi-day event</span>
<span class="cm">          * @type False | String      May be &quot;first&quot;, &quot;last&quot;, or &quot;mid&quot;</span>
<span class="cm">          * @private</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;multiDayPosition&#39;</span><span class="p">,</span> <span class="p">{</span>

           <span class="nx">value</span><span class="o">:</span> <span class="kc">false</span>
         
         <span class="p">});</span>


         
         <span class="cm">/**</span>
<span class="cm">          * @attribute multiDayParent</span>
<span class="cm">          * @description parent DiaryItem for multi-day events</span>
<span class="cm">          * @type DiaryItem</span>
<span class="cm">          * @private</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;multiDayParent&#39;</span><span class="p">,</span> <span class="p">{</span>

           <span class="nx">value</span><span class="o">:</span> <span class="kc">false</span>
         
         <span class="p">});</span>
         
         
         <span class="cm">/**</span>
<span class="cm">          * @attribute DTSTART</span>
<span class="cm">          * @description Start time/ date</span>
<span class="cm">          * @type Object Date object</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;DTSTART&#39;</span><span class="p">,</span> <span class="p">{</span>
         
           <span class="nx">setter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">){</span>
             <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;_displayDTSTART&quot;</span><span class="p">,</span> <span class="nx">v</span><span class="p">);</span>
             <span class="k">return</span> <span class="nx">v</span><span class="p">;</span>
           <span class="p">}</span>
         
         <span class="p">});</span>
         
         <span class="cm">/**</span>
<span class="cm">          * @attribute _displayDTSTART</span>
<span class="cm">          * @descripiton Start time as displayed - may be different to DTSTART for multi-day items</span>
<span class="cm">          * @private</span>
<span class="cm">          * @type Object Date object</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;_displayDTSTART&#39;</span><span class="p">);</span>
         
         
         <span class="cm">/**</span>
<span class="cm">          * @attribute DTEND</span>
<span class="cm">          * @description End time/ date</span>
<span class="cm">          * @type Object Date object</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;DTEND&#39;</span><span class="p">,</span> <span class="p">{</span>
         
           <span class="nx">setter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span>
             <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;_displayDTEND&quot;</span> <span class="p">,</span> <span class="nx">v</span> <span class="p">);</span>
             <span class="k">return</span> <span class="nx">v</span><span class="p">;</span>
           <span class="p">}</span>
         <span class="p">});</span>
         


         <span class="cm">/**</span>
<span class="cm">          * @attribute _displayDTEND</span>
<span class="cm">          * @descripiton Start time as displayed - may be different to DTEND for multi-day items</span>
<span class="cm">          * @private</span>
<span class="cm">          * @type Object Date object</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;_displayDTEND&#39;</span><span class="p">);</span>
         
         
         
         <span class="cm">/**</span>
<span class="cm">          * @attribute URL</span>
<span class="cm">          * @description URL data for item</span>
<span class="cm">          * @type String</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;URL&#39;</span><span class="p">,</span> <span class="p">{</span>
         
           <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span>
         
         <span class="p">});</span>
         

          <span class="cm">/**</span>
<span class="cm">           * @attribute pxPerHour</span>
<span class="cm">           * @description  Number of pixels per hour</span>
<span class="cm">           * @default: 20</span>
<span class="cm">           * @type Number</span>
<span class="cm">           */</span> 
           <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s2">&quot;pxPerHour&quot;</span><span class="p">,</span> <span class="p">{</span>
             <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">,</span>
             <span class="nx">value</span><span class="o">:</span> <span class="mi">20</span>
           <span class="p">});</span>    
     
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @description Initializer, sets up the details Element</span>
<span class="cm">       * @protected</span>
<span class="cm">       * @method initContent</span>
<span class="cm">       */</span>
      <span class="nx">initContent</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

        <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">detailsEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
            
        <span class="c1">// add some classes</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">detailsEl</span><span class="p">,</span> <span class="nx">CLASS_DIARY_ITEM_DETAILS</span> <span class="p">);</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">detailsEl</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;detailClass&quot;</span><span class="p">));</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">detailsEl</span><span class="p">);</span>
        
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;backClass&quot;</span><span class="p">));</span>
        
        <span class="c1">// add categories as classes if needed:</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;useCssCategories&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_categories</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="k">this</span><span class="p">.</span><span class="nx">_categories</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">_detailsEl</span> <span class="o">=</span> <span class="nx">detailsEl</span><span class="p">;</span>
      
      <span class="p">},</span>
      
      
      
      <span class="cm">/**</span>
<span class="cm">       *</span>
<span class="cm">       * @description Initialize listeners for this item.</span>
<span class="cm">       * @protected</span>
<span class="cm">       * @method initListeners</span>
<span class="cm">       */</span>
      <span class="nx">initListeners</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;startResize&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_handleBeforeStartDrag</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;startResize&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_handleDiaryStartDrag</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;endResize&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_handleDiaryEndDrag</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;resize&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_handleDiaryDragOver</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;SUMMARYChange&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">renderDetails</span> <span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;DTSTARTChange&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">renderDetails</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;DTENDChange&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">renderDetails</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
       
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;b4StartDragEvent&quot;</span> <span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_handleBeforeStartDrag</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;startDragEvent&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_handleDiaryStartDrag</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;endDragEvent&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_handleDiaryEndDrag</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;dragEnterEvent&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_handleDiaryDragEnter</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;dragOverEvent&quot;</span> <span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_handleDiaryDragOver</span> <span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @description Fires an event and stops the drag if subscriber returns false</span>
<span class="cm">       * @method _handleBeforeStartDrag</span>
<span class="cm">       * @param ev {HTMLEvent} The before start drag event</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>
      <span class="nx">_handleBeforeStartDrag</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/**</span>
<span class="cm">         * @event itemBeforeStartMove</span>
<span class="cm">         * @description Fired before everything starts moving.  Return false to cancel move.</span>
<span class="cm">         * @param oArgs.item   DiaryItem that&#39;s about to be moved.</span>
<span class="cm">         */</span>
        <span class="k">if</span> <span class="p">(</span><span class="kc">false</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">getDiary</span><span class="p">().</span><span class="nx">fireEvent</span><span class="p">(</span><span class="s2">&quot;itemBeforeStartMove&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">item</span><span class="o">:</span> <span class="k">this</span><span class="p">}))</span> <span class="p">{</span>
           <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">DDM</span><span class="p">.</span><span class="nx">stopDrag</span><span class="p">();</span>
           <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">DDM</span><span class="p">.</span><span class="nx">stopEvent</span><span class="p">();</span>
           <span class="k">this</span><span class="p">.</span><span class="nx">_handleDiaryEndDrag</span><span class="p">();</span>
           <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * Start dragging handler.  Caches dates, sets Anim if needed.</span>
<span class="cm">       * @method _handleDiaryStartDrag</span>
<span class="cm">       * @protected       </span>
<span class="cm">       */</span>
      <span class="nx">_handleDiaryStartDrag</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
 
        <span class="k">this</span><span class="p">.</span><span class="nx">_cacheDates</span> <span class="o">=</span> <span class="p">{</span>
           <span class="nx">startTimeDay</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getStartTimeDay</span><span class="p">(),</span>
           <span class="nx">DTSTART</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;DTSTART&quot;</span><span class="p">)),</span>
           <span class="nx">DTEND</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;DTEND&quot;</span><span class="p">))</span>
        <span class="p">};</span>
        
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="s2">&quot;z-index&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Anim</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> 
            <span class="k">this</span><span class="p">.</span><span class="nx">anim</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">&amp;&amp;</span> 
            <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;useAnimation&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
           
              <span class="k">this</span><span class="p">.</span><span class="nx">anim</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Anim</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="p">{},</span> <span class="mf">0.5</span><span class="p">);</span>
              
        <span class="p">}</span>
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * While entering a day, update this item&#39;s current day</span>
<span class="cm">       * @method _handleDiaryDragEnter</span>
<span class="cm">       * @param ev {Event}</span>
<span class="cm">       * @param String   Id passed by dragenter event</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>
      <span class="nx">_handleDiaryDragEnter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span> <span class="p">,</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
      
      
         <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot; DiaryItem._handleDiaryDragOver &quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">);</span> 
         <span class="kd">var</span> <span class="nx">dayTarget</span> <span class="o">=</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">DDM</span><span class="p">.</span><span class="nx">getDDById</span><span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">info</span><span class="p">).</span><span class="nx">_diaryDay</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;coldate&quot;</span><span class="p">);</span>
     
         <span class="k">this</span><span class="p">.</span><span class="nx">setStartTimeDay</span><span class="p">(</span><span class="nx">dayTarget</span><span class="p">);</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setEndTimeDay</span><span class="p">(</span><span class="nx">dayTarget</span><span class="p">);</span>

      <span class="p">},</span>


      
      
      <span class="cm">/**</span>
<span class="cm">       * While dragging over a day, update this item&#39;s current time and display it</span>
<span class="cm">       * @method _handleDiaryDragOver</span>
<span class="cm">       * @param ev Event</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>      
      <span class="nx">_handleDiaryDragOver</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
  
        <span class="c1">// change the start times if this is a one-day item, </span>
        <span class="c1">//or the start of a multi-day item</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;multiDayPosition&quot;</span> <span class="p">)</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">||</span> 
            <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;multiDayPosition&quot;</span> <span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;first&quot;</span><span class="p">)</span> <span class="p">{</span>
              
              <span class="k">this</span><span class="p">.</span><span class="nx">getParentItem</span><span class="p">().</span><span class="nx">setStartTimeSecs</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">calcStartFromPosition</span><span class="p">());</span>
              
        <span class="p">}</span>
        <span class="c1">// change the end times if this is a one-day item, or the end of a multi-day item</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;multiDayPosition&quot;</span> <span class="p">)</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">||</span> 
            <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;multiDayPosition&quot;</span> <span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;last&quot;</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">getParentItem</span><span class="p">().</span><span class="nx">setEndTimeSecs</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">calcEndFromPosition</span><span class="p">());</span>
        <span class="p">}</span>
        
        <span class="c1">// redisplay times</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">renderDetails</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * At the end, update times and days and re-render</span>
<span class="cm">       * @method _handleDiaryEndDrag</span>
<span class="cm">       * @param ev Event</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>
      <span class="nx">_handleDiaryEndDrag</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
      
        <span class="kd">var</span> <span class="nx">startTimeDay</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">endCol</span><span class="p">,</span> <span class="nx">el</span><span class="p">,</span>
            <span class="nx">startCol</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;column&quot;</span><span class="p">),</span>
            <span class="nx">diary</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getDiary</span><span class="p">(),</span>
            <span class="nx">cache</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_cacheDates</span><span class="p">,</span>
            <span class="nx">cacheStart</span> <span class="o">=</span> <span class="nx">cache</span><span class="p">.</span><span class="nx">DTSTART</span> <span class="p">,</span>
            <span class="nx">cacheEnd</span>   <span class="o">=</span> <span class="nx">cache</span><span class="p">.</span><span class="nx">DTEND</span> <span class="p">;</span>
      
        <span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span><span class="p">.</span><span class="nx">lock</span><span class="p">();</span>

        <span class="cm">/**</span>
<span class="cm">         * @event itemBeforeEndMove</span>
<span class="cm">         * @description fired when an item is moved or resized (ie the times change).</span>
<span class="cm">         * Return false to cancel the resize/move</span>
<span class="cm">         * @param oArgs.from   Object literal containing original DTSTART and DTEND</span>
<span class="cm">         * @param oArgs.to     Object literal containing final DTSTART and DTEND</span>
<span class="cm">         * @param oArgs.item   DiaryItem that&#39;s being moved</span>
<span class="cm">         * @param oArgs.originEvent    Original event from resize/dragdrop passed through.</span>
<span class="cm">         */</span>

        <span class="k">if</span><span class="p">(</span> <span class="kc">false</span> <span class="o">===</span> <span class="nx">diary</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span> <span class="s2">&quot;itemBeforeEndMove&quot;</span> <span class="p">,</span> <span class="p">{</span> 
                <span class="nx">from</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">DTSTART</span><span class="o">:</span> <span class="nx">cacheStart</span> <span class="p">,</span> 
                         <span class="nx">DTEND</span> <span class="o">:</span> <span class="nx">cacheEnd</span> 
                <span class="p">},</span>
                <span class="nx">to</span><span class="o">:</span> <span class="p">{</span> <span class="nx">DTSTART</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTSTART&quot;</span> <span class="p">),</span>
                      <span class="nx">DTEND</span>  <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTEND&quot;</span> <span class="p">)</span> 
                <span class="p">},</span> 
                <span class="nx">item</span><span class="o">:</span> <span class="k">this</span><span class="p">,</span>
                <span class="nx">originEvent</span><span class="o">:</span> <span class="nx">ev</span> <span class="p">}</span> 
               <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
           
             <span class="c1">// reset dates to where they started from:</span>
             <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span> <span class="s2">&quot;DTSTART&quot;</span> <span class="p">,</span> <span class="nx">cacheStart</span> <span class="p">);</span>
             <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span> <span class="s2">&quot;DTEND&quot;</span><span class="p">,</span> <span class="nx">cacheEnd</span> <span class="p">);</span>
           
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        
            
            <span class="c1">// change the times</span>
            <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;multiDayPosition&quot;</span> <span class="p">)</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;multiDayPosition&quot;</span> <span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;first&quot;</span> <span class="p">){</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">getParentItem</span><span class="p">().</span><span class="nx">setStartTimeSecs</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">calcStartFromPosition</span><span class="p">()</span> <span class="p">);</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;multiDayPosition&quot;</span> <span class="p">)</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;multiDayPosition&quot;</span> <span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;last&quot;</span> <span class="p">){</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">getParentItem</span><span class="p">().</span><span class="nx">setEndTimeSecs</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">calcEndFromPosition</span><span class="p">()</span> <span class="p">);</span>
            <span class="p">}</span>
            
          
            <span class="nx">startTimeDay</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getStartTimeDay</span><span class="p">();</span>
            <span class="nx">element</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">);</span>
          
            <span class="c1">// remove the node from the current col and stick it in the new one</span>
            <span class="c1">// and then re-render the start and end columns</span>
            <span class="k">if</span><span class="p">(</span> <span class="nx">cache</span><span class="p">.</span><span class="nx">startTimeDay</span> <span class="o">!==</span> <span class="nx">startTimeDay</span> <span class="p">){</span>
    
              <span class="nx">endCol</span>   <span class="o">=</span> <span class="nx">diary</span><span class="p">.</span><span class="nx">getDiaryDay</span><span class="p">(</span> <span class="nx">startTimeDay</span> <span class="p">);</span>
              <span class="nx">el</span>       <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span> <span class="nx">element</span> <span class="p">);</span>

              
              <span class="nx">startCol</span><span class="p">.</span><span class="nx">removeItemFromBlock</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>  
              <span class="nx">endCol</span><span class="p">.</span><span class="nx">_dataEl</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">el</span> <span class="p">);</span>
              
              <span class="nx">endCol</span><span class="p">.</span><span class="nx">_addItemToBlock</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>
              
              <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;column&quot;</span><span class="p">,</span> <span class="nx">endCol</span> <span class="p">);</span>
      
              <span class="nx">startCol</span><span class="p">.</span><span class="nx">_rebuildBlocks</span><span class="p">();</span>
              <span class="nx">startCol</span><span class="p">.</span><span class="nx">_renderBlocks</span><span class="p">();</span>
              
              <span class="nx">startCol</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;column&quot;</span><span class="p">);</span>
              
              
            <span class="p">}</span>
   
        <span class="p">}</span>


        <span class="c1">// startCol may be where we ended up (not started)</span>
        <span class="nx">startCol</span><span class="p">.</span><span class="nx">_rebuildBlocks</span><span class="p">();</span>
        <span class="nx">startCol</span><span class="p">.</span><span class="nx">_renderBlocks</span><span class="p">();</span>
 
 
        <span class="cm">/**</span>
<span class="cm">         * @event itemEndMove</span>
<span class="cm">         * @description fired when an item is moved or resized (ie the times change)</span>
<span class="cm">         * @param oArgs.from   Object literal containing original DTSTART and DTEND</span>
<span class="cm">         * @param oArgs.to     Object literal containing final DTSTART and DTEND</span>
<span class="cm">         * @param oArgs.item   DiaryItem that&#39;s being moved</span>
<span class="cm">         * @param oArgs.originEvent    Original event from resize/dragdrop passed through.</span>
<span class="cm">         */</span>

        <span class="nx">diary</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span> <span class="s2">&quot;itemEndMove&quot;</span> <span class="p">,</span> <span class="p">{</span> 
            <span class="nx">from</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">DTSTART</span><span class="o">:</span> <span class="nx">cacheStart</span> <span class="p">,</span> 
                     <span class="nx">DTEND</span> <span class="o">:</span> <span class="nx">cacheEnd</span> 
            <span class="p">},</span>
            <span class="nx">to</span><span class="o">:</span> <span class="p">{</span> <span class="nx">DTSTART</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTSTART&quot;</span> <span class="p">),</span>
                  <span class="nx">DTEND</span>  <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTEND&quot;</span> <span class="p">)</span> 
            <span class="p">},</span> 
            <span class="nx">item</span><span class="o">:</span> <span class="k">this</span><span class="p">,</span>
            <span class="nx">originEvent</span><span class="o">:</span> <span class="nx">ev</span> <span class="p">}</span> 
        <span class="p">);</span>
        
        <span class="c1">// final tidying up</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_cacheDates</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span><span class="p">.</span><span class="nx">unlock</span><span class="p">();</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="nx">element</span> <span class="p">,</span> <span class="s2">&quot;z-index&quot;</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method getDiary</span>
<span class="cm">       * @description Returns Diary instance we&#39;re in.</span>
<span class="cm">       * @return {YAHOO.widget.Diary}</span>
<span class="cm">       */</span>
      <span class="nx">getDiary</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;column&quot;</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;diary&quot;</span><span class="p">);</span>
      <span class="p">},</span>

      
      <span class="cm">/**</span>
<span class="cm">       * @method setStartTimeDay</span>
<span class="cm">       * @description Sets the start day/month/year of this item (but not times)</span>
<span class="cm">       * @param {Object} Date to extract date/month/year from</span>
<span class="cm">       */</span>
      <span class="nx">setStartTimeDay</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">date</span> <span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">start</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;DTSTART&quot;</span><span class="p">);</span>
        <span class="nx">start</span><span class="p">.</span><span class="nx">setYear</span><span class="p">(</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="p">);</span>
        <span class="nx">start</span><span class="p">.</span><span class="nx">setMonth</span><span class="p">(</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="p">);</span>
        <span class="nx">start</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="p">);</span>

      <span class="p">},</span>


      <span class="cm">/**</span>
<span class="cm">       * @method setEndTimeDay</span>
<span class="cm">       * @description Sets the end day/month/year of this item</span>
<span class="cm">       * @param {Object} Date to extract date/month/year from</span>
<span class="cm">       */</span>      
      <span class="nx">setEndTimeDay</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">date</span> <span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">end</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;DTEND&quot;</span><span class="p">);</span>
        <span class="nx">end</span><span class="p">.</span><span class="nx">setYear</span><span class="p">(</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="p">);</span>  
        <span class="nx">end</span><span class="p">.</span><span class="nx">setMonth</span><span class="p">(</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="p">);</span>
        <span class="nx">end</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="p">);</span>
            
      <span class="p">},</span>

      <span class="cm">/**</span>
<span class="cm">       * @method getStartTimeDay</span>
<span class="cm">       * @description Gets the start time ( milliseconds) of the day of this item (ie at 00:00)</span>
<span class="cm">       * @return {Int}</span>
<span class="cm">       */</span>      
      <span class="nx">getStartTimeDay</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;DTSTART&quot;</span><span class="p">).</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getStartTimeSecs</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span> <span class="p">);</span>
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method getStartTimeSecs</span>
<span class="cm">       * @description Gets the start time as seconds from 00:00</span>
<span class="cm">       * @return {Int}</span>
<span class="cm">       */</span>
      <span class="nx">getStartTimeSecs</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTSTART&quot;</span> <span class="p">).</span><span class="nx">getHours</span><span class="p">()</span> <span class="o">*</span> <span class="mi">3600</span> <span class="p">);</span>
				 <span class="nx">r</span> <span class="o">+=</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTSTART&quot;</span> <span class="p">).</span><span class="nx">getMinutes</span><span class="p">()</span> <span class="o">*</span> <span class="mi">60</span> <span class="p">);</span>
				 <span class="nx">r</span> <span class="o">+=</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTSTART&quot;</span> <span class="p">).</span><span class="nx">getSeconds</span><span class="p">()</span> <span class="p">);</span>
				 <span class="k">return</span> <span class="nx">r</span><span class="p">;</span>
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method getEndTimeSecs</span>
<span class="cm">       * @description Gets the end time as seconds from 00:00</span>
<span class="cm">       * @return {Int}</span>
<span class="cm">       */</span>
      <span class="nx">getEndTimeSecs</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTEND&quot;</span> <span class="p">).</span><span class="nx">getHours</span><span class="p">()</span> <span class="o">*</span> <span class="mi">3600</span> <span class="p">);</span>
				<span class="nx">r</span> <span class="o">+=</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTEND&quot;</span> <span class="p">).</span><span class="nx">getMinutes</span><span class="p">()</span> <span class="o">*</span> <span class="mi">60</span> <span class="p">);</span>
				<span class="nx">r</span> <span class="o">+=</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTEND&quot;</span> <span class="p">).</span><span class="nx">getSeconds</span><span class="p">()</span> <span class="p">);</span>
				<span class="k">return</span> <span class="nx">r</span><span class="p">;</span>
      <span class="p">},</span>


      
      
      <span class="cm">/**</span>
<span class="cm">       * @method getDisplayStartTimeSecs</span>
<span class="cm">       * @description Gets the displayed start time as seconds from 00:00</span>
<span class="cm">       * @protected</span>
<span class="cm">       * @return {Int}</span>
<span class="cm">       */</span>
      <span class="nx">getDisplayStartTimeSecs</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;_displayDTSTART&quot;</span> <span class="p">).</span><span class="nx">getHours</span><span class="p">()</span> <span class="o">*</span> <span class="mi">3600</span> <span class="p">);</span>
				<span class="nx">r</span> <span class="o">+=</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;_displayDTSTART&quot;</span> <span class="p">).</span><span class="nx">getMinutes</span><span class="p">()</span> <span class="o">*</span> <span class="mi">60</span> <span class="p">);</span>
				<span class="nx">r</span> <span class="o">+=</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;_displayDTSTART&quot;</span> <span class="p">).</span><span class="nx">getSeconds</span><span class="p">()</span> <span class="p">);</span>
				<span class="k">return</span> <span class="nx">r</span><span class="p">;</span>
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method getDisplayEndTimeSecs</span>
<span class="cm">       * @description  Gets the displayed end time as seconds from 00:00</span>
<span class="cm">       * @protected</span>
<span class="cm">       * @return {Int}</span>
<span class="cm">       */</span>
      <span class="nx">getDisplayEndTimeSecs</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">e</span> <span class="o">=</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;_displayDTEND&quot;</span> <span class="p">).</span><span class="nx">getHours</span><span class="p">()</span> <span class="o">*</span> <span class="mi">3600</span> <span class="p">);</span>
				<span class="nx">e</span> <span class="o">+=</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;_displayDTEND&quot;</span> <span class="p">).</span><span class="nx">getMinutes</span><span class="p">()</span> <span class="o">*</span> <span class="mi">60</span> <span class="p">);</span>
				<span class="nx">e</span> <span class="o">+=</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;_displayDTEND&quot;</span> <span class="p">).</span><span class="nx">getSeconds</span><span class="p">()</span> <span class="p">);</span>
				<span class="k">return</span> <span class="nx">e</span><span class="p">;</span>
      <span class="p">},</span>
      
      
            
      <span class="cm">/**</span>
<span class="cm">       * @method setStartTimeSecs</span>
<span class="cm">       * @description  Sets the start time (but not date) from seconds</span>
<span class="cm">       * @param Int</span>
<span class="cm">       */</span>      
      <span class="nx">setStartTimeSecs</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">secs</span> <span class="p">)</span> <span class="p">{</span>
         <span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span> <span class="nx">secs</span> <span class="o">/</span> <span class="mi">3600</span> <span class="p">),</span>
             <span class="nx">m</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span> <span class="p">(</span><span class="nx">secs</span> <span class="o">-</span> <span class="p">(</span> <span class="nx">h</span> <span class="o">*</span> <span class="mi">3600</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">60</span> <span class="p">);</span>
        
         <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;DTSTART&quot;</span><span class="p">).</span><span class="nx">setHours</span><span class="p">(</span> <span class="nx">h</span> <span class="p">,</span> <span class="p">(</span><span class="nx">m</span> <span class="o">-</span> <span class="nx">m</span><span class="o">%</span><span class="mi">15</span><span class="p">)</span> <span class="p">);</span>
      
      <span class="p">},</span>
 
 
 
 
      
      <span class="cm">/**</span>
<span class="cm">       * @method setEndTimeSecs</span>
<span class="cm">       * @description  Sets the end time (but not date) from seconds</span>
<span class="cm">       * @param Int</span>
<span class="cm">       */</span>          
      <span class="nx">setEndTimeSecs</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">secs</span> <span class="p">)</span> <span class="p">{</span>
         <span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span> <span class="nx">secs</span> <span class="o">/</span> <span class="mi">3600</span> <span class="p">),</span>
             <span class="nx">m</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span> <span class="p">(</span><span class="nx">secs</span> <span class="o">-</span> <span class="p">(</span> <span class="nx">h</span> <span class="o">*</span> <span class="mi">3600</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">60</span> <span class="p">);</span>
        
         <span class="k">if</span><span class="p">(</span> <span class="nx">m</span><span class="o">%</span><span class="mi">15</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="p">){</span>
           <span class="nx">m</span> <span class="o">=</span> <span class="nx">m</span> <span class="o">-</span> <span class="nx">m</span><span class="o">%</span><span class="mi">15</span><span class="p">;</span>
         <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
           <span class="nx">m</span> <span class="o">=</span> <span class="nx">m</span> <span class="o">+</span> <span class="p">(</span> <span class="mi">15</span> <span class="o">-</span> <span class="nx">m</span><span class="o">%</span><span class="mi">15</span> <span class="p">);</span>
         <span class="p">}</span>
            
         <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;DTEND&quot;</span><span class="p">).</span><span class="nx">setHours</span><span class="p">(</span> <span class="nx">h</span> <span class="p">,</span> <span class="nx">m</span> <span class="p">);</span>      
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method calculateHeight</span>
<span class="cm">       * @description Calculate the height (in pixels) of this based on times</span>
<span class="cm">       * @return {Int}</span>
<span class="cm">       */</span>
      <span class="nx">calculateHeight</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
      
        <span class="k">return</span> <span class="p">(</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">getDisplayEndTimeSecs</span><span class="p">()</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">getDisplayStartTimeSecs</span><span class="p">()</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;pxPerHour&quot;</span><span class="p">)</span> <span class="o">/</span><span class="mi">3600</span><span class="p">)</span>  <span class="o">-</span> <span class="mi">2</span><span class="p">);</span>
      
      <span class="p">},</span>

      <span class="cm">/**</span>
<span class="cm">       * @method calculateTop</span>
<span class="cm">       * @description Calculate the top (in pixels) of this based on times</span>
<span class="cm">       * @return {Int}</span>
<span class="cm">       */</span>      
      <span class="nx">calculateTop</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">return</span> <span class="p">(</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">getDisplayStartTimeSecs</span><span class="p">()</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;pxPerHour&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">)</span> <span class="p">);</span>
      <span class="p">},</span>

      <span class="cm">/**</span>
<span class="cm">       * @method calcStartFromPosition</span>
<span class="cm">       * @description Calculate the start time (seconds) based on position</span>
<span class="cm">       * @return {Int}</span>
<span class="cm">       */</span>      
      <span class="nx">calcStartFromPosition</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">t</span><span class="p">,</span> <span class="nx">pxPerHour</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span><span class="p">(</span> <span class="nx">t</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span>
           <span class="nx">t</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span> <span class="p">,</span> <span class="mi">10</span> <span class="p">);</span>
         <span class="p">}</span>
         <span class="k">if</span><span class="p">(</span><span class="nx">pxPerHour</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
           <span class="nx">pxPerHour</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;pxPerHour&quot;</span><span class="p">);</span>
         <span class="p">}</span>
         <span class="k">return</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span> <span class="nx">t</span> <span class="o">*</span> <span class="mi">3600</span> <span class="p">)</span> <span class="o">/</span> <span class="nx">pxPerHour</span><span class="p">),</span> <span class="mi">10</span> <span class="p">);</span>
      
      <span class="p">},</span>

      <span class="cm">/**</span>
<span class="cm">       * @method calcEndFromPosition</span>
<span class="cm">       * @description Calculate the end time (seconds) based on position</span>
<span class="cm">       * @return {Int}</span>
<span class="cm">       */</span>        
      <span class="nx">calcEndFromPosition</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">h</span> <span class="p">,</span> <span class="nx">t</span><span class="p">,</span> <span class="nx">pxPerHour</span><span class="p">)</span> <span class="p">{</span>
      
         <span class="k">if</span><span class="p">(</span> <span class="nx">h</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="p">){</span>
           <span class="nx">h</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">),</span><span class="mi">10</span><span class="p">);</span>
         <span class="p">}</span>
         <span class="k">if</span><span class="p">(</span> <span class="nx">t</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span>
           <span class="nx">t</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span> <span class="p">,</span> <span class="mi">10</span> <span class="p">);</span>
         <span class="p">}</span>
         <span class="k">if</span><span class="p">(</span><span class="nx">pxPerHour</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
           <span class="nx">pxPerHour</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;pxPerHour&quot;</span><span class="p">);</span>
         <span class="p">}</span>      
         <span class="k">return</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span> <span class="p">(</span> <span class="nx">h</span> <span class="o">+</span> <span class="nx">t</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">3600</span> <span class="p">)</span> <span class="o">/</span> <span class="nx">pxPerHour</span><span class="p">),</span> <span class="mi">10</span> <span class="p">);</span>
      
      <span class="p">},</span>




      <span class="cm">/**</span>
<span class="cm">       * @method renderStartTime</span>
<span class="cm">       * @description Gets start time as string hh:mm format</span>
<span class="cm">       * @return {String}</span>
<span class="cm">       */</span>
      <span class="nx">renderStartTime</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTSTART&quot;</span> <span class="p">),</span>
            <span class="nx">h</span> <span class="o">=</span> <span class="p">(</span><span class="nx">s</span> <span class="o">?</span> <span class="nx">s</span><span class="p">.</span><span class="nx">getHours</span><span class="p">()</span> <span class="o">:</span> <span class="mi">0</span> <span class="p">),</span>
            <span class="nx">m</span> <span class="o">=</span> <span class="p">(</span><span class="nx">s</span> <span class="o">?</span> <span class="nx">s</span><span class="p">.</span><span class="nx">getMinutes</span><span class="p">()</span> <span class="o">:</span> <span class="mi">0</span> <span class="p">);</span>
        <span class="k">return</span> <span class="p">(</span> <span class="nx">h</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">?</span> <span class="s1">&#39;0&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span> <span class="o">+</span> <span class="nx">h</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">TIME_SEPARATOR</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">m</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">?</span> <span class="s1">&#39;0&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span> <span class="o">+</span> <span class="nx">m</span> <span class="p">;</span>
      <span class="p">},</span>
      
      <span class="cm">/**</span>
<span class="cm">       * @method renderEndTime</span>
<span class="cm">       * @description Gets end time as string</span>
<span class="cm">       * @return {String}</span>
<span class="cm">       */</span>      
      <span class="nx">renderEndTime</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTEND&quot;</span> <span class="p">),</span>
            <span class="nx">h</span> <span class="o">=</span> <span class="p">(</span><span class="nx">s</span> <span class="o">?</span> <span class="nx">s</span><span class="p">.</span><span class="nx">getHours</span><span class="p">()</span> <span class="o">:</span> <span class="mi">0</span> <span class="p">),</span>
            <span class="nx">m</span> <span class="o">=</span> <span class="p">(</span><span class="nx">s</span> <span class="o">?</span> <span class="nx">s</span><span class="p">.</span><span class="nx">getMinutes</span><span class="p">()</span> <span class="o">:</span> <span class="mi">0</span> <span class="p">);</span>
        <span class="k">return</span> <span class="p">(</span> <span class="nx">h</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">?</span> <span class="s1">&#39;0&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span> <span class="o">+</span> <span class="nx">h</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">TIME_SEPARATOR</span> <span class="o">+</span> <span class="p">(</span> <span class="nx">m</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">?</span> <span class="s1">&#39;0&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span> <span class="o">+</span> <span class="nx">m</span> <span class="p">;</span>

      
      <span class="p">},</span>
      
      <span class="cm">/**</span>
<span class="cm">       * @method render</span>
<span class="cm">       * @description Render the item</span>
<span class="cm">       * @param Object Containing some dimensions { width: Int, linesInBlock: Int}</span>
<span class="cm">       */</span>          
      <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">oDetails</span> <span class="p">)</span> <span class="p">{</span>

        <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;DiaryItem.render()&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">);</span>
        
        <span class="c1">// set the offset and width</span>
        <span class="kd">var</span> <span class="nx">lineWidth</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span> <span class="nx">oDetails</span><span class="p">.</span><span class="nx">width</span>  <span class="o">-</span> <span class="mi">20</span> <span class="p">)</span><span class="o">/</span> <span class="nx">oDetails</span><span class="p">.</span><span class="nx">linesInBlock</span> <span class="p">),</span> <span class="mi">10</span> <span class="p">),</span>
            <span class="nx">w</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lineWidth</span> <span class="o">-</span> <span class="mi">4</span> <span class="p">),</span>
            <span class="nx">l</span> <span class="o">=</span>  <span class="nb">parseInt</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_line</span> <span class="p">)</span> <span class="o">*</span> <span class="nx">lineWidth</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">20</span> <span class="p">,</span> <span class="mi">10</span> <span class="p">),</span>
            <span class="nx">t</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">calculateTop</span><span class="p">()</span> <span class="p">,</span> <span class="mi">10</span> <span class="p">),</span>
            <span class="nx">h</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">calculateHeight</span><span class="p">()</span> <span class="p">,</span> <span class="mi">10</span> <span class="p">);</span>

             
        <span class="k">this</span><span class="p">.</span><span class="nx">renderDetails</span><span class="p">(</span> <span class="kc">false</span> <span class="p">);</span>
        
        
        <span class="k">this</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="s2">&quot;top&quot;</span> <span class="p">,</span> <span class="nx">t</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="s2">&quot;left&quot;</span> <span class="p">,</span> <span class="nx">l</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span> <span class="p">);</span>
        
        <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">anim</span> <span class="o">===</span> <span class="kc">false</span> <span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="s2">&quot;width&quot;</span> <span class="p">,</span> <span class="nx">w</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span> <span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="s2">&quot;height&quot;</span> <span class="p">,</span> <span class="nx">h</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span><span class="p">);</span>
          <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_detailsEl</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="nx">h</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span><span class="p">);</span>

        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">anim</span><span class="p">.</span><span class="nx">attributes</span> <span class="o">=</span> <span class="p">{</span>  <span class="nx">height</span><span class="o">:</span> <span class="p">{</span> <span class="nx">to</span><span class="o">:</span> <span class="nx">h</span> <span class="p">},</span> <span class="nx">width</span><span class="o">:</span> <span class="p">{</span> <span class="nx">to</span> <span class="o">:</span> <span class="nx">w</span> <span class="p">}</span> <span class="p">};</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">anim</span><span class="p">.</span><span class="nx">animate</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">CLASS_DIARY_ITEM</span> <span class="p">);</span>


      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method renderDetails</span>
<span class="cm">       * @description Writes the text to the this._detailsEl element</span>
<span class="cm">       * @param {Boolean} Whether to use the item&#39;s parent (if a multi-day item)</span>
<span class="cm">       */</span>
      <span class="nx">renderDetails</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">useParent</span> <span class="p">){</span>

        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">item</span> <span class="o">=</span> <span class="p">(</span> <span class="nx">useParent</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">getParentItem</span><span class="p">()</span> <span class="o">:</span> <span class="k">this</span> <span class="p">),</span> <span class="nx">shortText</span><span class="p">;</span>
        
        <span class="k">if</span><span class="p">(</span> <span class="nx">item</span> <span class="o">===</span> <span class="k">this</span> <span class="p">){</span>

          <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_multiDayChildren</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_multiDayChildren</span><span class="p">[</span> <span class="nx">i</span> <span class="p">].</span><span class="nx">renderDetails</span><span class="p">(</span> <span class="p">);</span>
          <span class="p">}</span>
        
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        
          <span class="nx">item</span><span class="p">.</span><span class="nx">renderDetails</span><span class="p">();</span>
        
        <span class="p">}</span>
        <span class="c1">// put the actual details</span>
        <span class="nx">shortText</span> <span class="o">=</span>  <span class="nx">item</span><span class="p">.</span><span class="nx">renderStartTime</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">renderEndTime</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;SUMMARY&quot;</span><span class="p">)</span> <span class="p">;</span> 

        <span class="k">this</span><span class="p">.</span><span class="nx">_detailsEl</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">shortText</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_detailsEl</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">shortText</span><span class="p">;</span>


      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method renderFullDetails</span>
<span class="cm">       * @description Returns a string showing full details of the item.</span>
<span class="cm">       * @return {String}</span>
<span class="cm">       */</span>
      <span class="nx">renderFullDetails</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
 
        <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getParentItem</span><span class="p">(),</span>
        <span class="c1">// put the actual details</span>
            <span class="nx">shortText</span> <span class="o">=</span>  <span class="nx">item</span><span class="p">.</span><span class="nx">renderStartTime</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">renderEndTime</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;SUMMARY&quot;</span><span class="p">)</span> <span class="p">;</span> 
        
        <span class="nx">shortText</span> <span class="o">+=</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;DESCRIPTION&quot;</span><span class="p">);</span>
        
        <span class="k">return</span> <span class="nx">shortText</span><span class="p">;</span>

      <span class="p">},</span>      
      
      <span class="cm">/**</span>
<span class="cm">       * @method setLine</span>
<span class="cm">       * @description Which &#39;line&#39; (ie what offset) is this one in?</span>
<span class="cm">       * @param Int</span>
<span class="cm">       */</span>
      <span class="nx">setLine</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">line</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_line</span> <span class="o">=</span> <span class="nx">line</span><span class="p">;</span>
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method addMultiDayChild</span>
<span class="cm">       * @description Adds a linked child diary item to the stack:</span>
<span class="cm">       * @param oDiaryItem {DiaryItem}</span>
<span class="cm">       */</span>
      <span class="nx">addMultiDayChild</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">oDiaryItem</span> <span class="p">){</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">_multiDayChildren</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="nx">oDiaryItem</span> <span class="p">);</span> 
      <span class="p">},</span>


      
      <span class="cm">/**</span>
<span class="cm">       * @method getParentItem</span>
<span class="cm">       * @description Provides access to the parent item.  For single-day events, it&#39;s this,</span>
<span class="cm">       * for multi-day events it&#39;s the parent, which will give proper dates/times etc</span>
<span class="cm">       * and ids for editing and so on.</span>
<span class="cm">       * @return {DiaryItem}</span>
<span class="cm">       */</span>
      <span class="nx">getParentItem</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;multiDayParent&quot;</span><span class="p">)</span> <span class="p">){</span>
          <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;multiDayParent&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method destroy</span>
<span class="cm">       * @description Destroys the DiaryItem</span>
<span class="cm">       */</span>
      <span class="nx">destroy</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      
        <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
            <span class="nx">numChildren</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_multiDayChildren</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
            <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span>
            <span class="nx">parent</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
      
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">dragdrop</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
        <span class="p">}</span>


        <span class="k">this</span><span class="p">.</span><span class="nx">_line</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_detailsEl</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">anim</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">anim</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">anim</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_cacheDates</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  
        <span class="k">if</span> <span class="p">(</span><span class="nx">numChildren</span><span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numChildren</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_multiDayChildren</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_multiDayChildren</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        
        <span class="nx">DiaryItem</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">destroy</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">parent</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="cm">/**</span>
<span class="cm">         * @event destroy</span>
<span class="cm">         * @description Fired after destruction process</span>
<span class="cm">         */</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span><span class="s2">&quot;destroy&quot;</span><span class="p">);</span>
      
      <span class="p">}</span>
  
  <span class="p">});</span>  
  
  
  
  
  
  <span class="cm">/**</span>
<span class="cm">   *</span>
<span class="cm">   * A block of diary items.</span>
<span class="cm">   * Holds diary items that overlap in time within a single day.  You won&#39;t want</span>
<span class="cm">   * to deal with these directly.</span>
<span class="cm">   *</span>
<span class="cm">   * @class DiaryBlock </span>
<span class="cm">   *</span>
<span class="cm">   */</span>
  <span class="kd">var</span> <span class="nx">DiaryBlock</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="p">){</span>
      <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;new DiaryBlock called&quot;</span> <span class="p">,</span> <span class="s2">&quot;info&quot;</span> <span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
  <span class="p">};</span>
  

  <span class="nx">DiaryBlock</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  
    <span class="cm">/**</span>
<span class="cm">     * Array of DiaryItem in this block.</span>
<span class="cm">     * @property _items</span>
<span class="cm">     * @type Array</span>
<span class="cm">     * @default []</span>
<span class="cm">     * @protected</span>
<span class="cm">     */</span>
    <span class="nx">_items</span><span class="o">:</span><span class="p">[],</span>
    
    <span class="cm">/**</span>
<span class="cm">     * Time of day, in seconds of the start of this block.</span>
<span class="cm">     * @property _startSecs</span>
<span class="cm">     * @type Int</span>
<span class="cm">     * @default 86401</span>
<span class="cm">     * @protected</span>
<span class="cm">     */</span>
    <span class="nx">_startSecs</span><span class="o">:</span> <span class="mi">86401</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * Time, in seconds, of the end of this block.</span>
<span class="cm">     * @property _endSecs</span>
<span class="cm">     * @type Int</span>
<span class="cm">     * @default -1</span>
<span class="cm">     * @protected</span>
<span class="cm">     */</span>
     
    <span class="nx">_endSecs</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>

    <span class="cm">/**</span>
<span class="cm">     * The number of vertical lines in the block.</span>
<span class="cm">     * Array holding an objects for each line, of the form</span>
<span class="cm">     * { startSecs: 123, endSecs: 456 }</span>
<span class="cm">     * @property _lines</span>
<span class="cm">     * @type Array</span>
<span class="cm">     * @default []</span>
<span class="cm">     * @protected</span>
<span class="cm">     */</span>
    <span class="nx">_lines</span><span class="o">:</span> <span class="p">[],</span>



    <span class="cm">/**</span>
<span class="cm">     * @method init</span>
<span class="cm">     * @description Initializer function.</span>
<span class="cm">     * @protected</span>
<span class="cm">     */</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_items</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_startSecs</span> <span class="o">=</span> <span class="mi">86401</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_endSecs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_lines</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="p">},</span>
  
    <span class="cm">/**</span>
<span class="cm">     * Adds a DiaryItem to the block.</span>
<span class="cm">     * @method addItem</span>
<span class="cm">     * @param item {DiaryItem}</span>
<span class="cm">     */</span>
    <span class="nx">addItem</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    
      <span class="c1">// which vertical line will this sit in?</span>
      <span class="kd">var</span> <span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_findLineForItem</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
      <span class="c1">// add a new one if needed</span>
      <span class="k">if</span><span class="p">(</span> <span class="nx">line</span> <span class="o">===</span> <span class="kc">false</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_lines</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">startSecs</span><span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">getDisplayStartTimeSecs</span><span class="p">(),</span>
                          <span class="nx">endSecs</span> <span class="o">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">getDisplayEndTimeSecs</span><span class="p">()});</span>
        <span class="nx">line</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_lines</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_lines</span><span class="p">[</span><span class="nx">line</span><span class="p">].</span><span class="nx">startSecs</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_lines</span><span class="p">[</span><span class="nx">line</span><span class="p">].</span><span class="nx">startSecs</span><span class="p">,</span> 
                                               <span class="nx">item</span><span class="p">.</span><span class="nx">getDisplayStartTimeSecs</span><span class="p">());</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_lines</span><span class="p">[</span><span class="nx">line</span><span class="p">].</span><span class="nx">endSecs</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_lines</span><span class="p">[</span><span class="nx">line</span><span class="p">].</span><span class="nx">endSecs</span><span class="p">,</span> 
                                             <span class="nx">item</span><span class="p">.</span><span class="nx">getDisplayEndTimeSecs</span><span class="p">());</span>
      <span class="p">}</span>
      <span class="nx">item</span><span class="p">.</span><span class="nx">setLine</span><span class="p">(</span> <span class="nx">line</span> <span class="p">);</span>
    
      <span class="c1">// store the item</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="nx">item</span> <span class="p">);</span>
      
      <span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">a</span><span class="p">,</span><span class="nx">b</span> <span class="p">){</span> <span class="k">return</span> <span class="p">(</span> <span class="nx">a</span><span class="p">.</span><span class="nx">startSecs</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">startSecs</span> <span class="p">);</span> <span class="p">}</span> <span class="p">);</span>
      
      
      <span class="c1">// update min/max times</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_startSecs</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_startSecs</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">getDisplayStartTimeSecs</span><span class="p">()</span> <span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_endSecs</span>   <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_endSecs</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">getDisplayEndTimeSecs</span><span class="p">()</span> <span class="p">);</span>
  
    <span class="p">},</span>
    
    <span class="cm">/**</span>
<span class="cm">     * @method removeItem</span>
<span class="cm">     * @description Removes an item from the block</span>
<span class="cm">     * @param {DiaryItem}  DiaryItem to remove</span>
<span class="cm">     * @return {Boolean}  True if removed, false if not found</span>
<span class="cm">     */</span>
    <span class="nx">removeItem</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">item</span> <span class="p">)</span> <span class="p">{</span>
       <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">allItems</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="p">;</span>
       
       <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">allItems</span><span class="p">.</span><span class="nx">length</span> <span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>

        <span class="k">if</span><span class="p">(</span> <span class="nx">allItems</span><span class="p">[</span> <span class="nx">i</span> <span class="p">].</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="nx">item</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
          <span class="nx">allItems</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span> <span class="nx">i</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
          <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    
    <span class="p">},</span>
    
    
    
    <span class="cm">/**</span>
<span class="cm">     * @method _findLineForItem</span>
<span class="cm">     * @description  Will the item fit in an existing vertical line?</span>
<span class="cm">     * @return {Int} || {False}  - line number </span>
<span class="cm">     * @protected</span>
<span class="cm">     * @param {DiaryItem}</span>
<span class="cm">     */</span>
    <span class="nx">_findLineForItem</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">item</span> <span class="p">)</span> <span class="p">{</span>
    
      <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> 
          <span class="nx">lines</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_lines</span><span class="p">;</span>
      
      <span class="c1">// will it fit in this line?</span>
      <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">lines</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
        
         <span class="k">if</span><span class="p">(</span> <span class="nx">item</span><span class="p">.</span><span class="nx">getDisplayEndTimeSecs</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="nx">lines</span><span class="p">[</span> <span class="nx">i</span> <span class="p">].</span><span class="nx">startSecs</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">getDisplayStartTimeSecs</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nx">lines</span><span class="p">[</span> <span class="nx">i</span> <span class="p">].</span><span class="nx">endSecs</span> <span class="p">){</span>
         
           <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
         
         <span class="p">}</span>
        
      <span class="p">}</span>
      
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    
    <span class="p">},</span>
    
    
    <span class="cm">/**</span>
<span class="cm">     * @method contains</span>
<span class="cm">     * @description  Does item overlap with this block?</span>
<span class="cm">     * @param item {DiaryItem}</span>
<span class="cm">     * @return {Boolean}</span>
<span class="cm">     */</span>
    <span class="nx">contains</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// starts before the end of the block, or ends after the start of the block:</span>
      <span class="k">return</span> <span class="nx">item</span><span class="p">.</span><span class="nx">getDisplayStartTimeSecs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_endSecs</span> <span class="o">&amp;&amp;</span> <span class="nx">item</span><span class="p">.</span><span class="nx">getDisplayEndTimeSecs</span><span class="p">()</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_startSecs</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * @method render</span>
<span class="cm">     * @description  Renders the DiaryItems in the block</span>
<span class="cm">     * @param Object   Literal containing width property of entire column</span>
<span class="cm">     * @return {Boolean}</span>
<span class="cm">     */</span>    
    <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">oCfg</span> <span class="p">){</span>
      <span class="kd">var</span> <span class="nx">i</span><span class="p">;</span>
      
      <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="p">[</span> <span class="nx">i</span> <span class="p">].</span><span class="nx">render</span><span class="p">(</span> <span class="p">{</span><span class="nx">linesInBlock</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_lines</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> 
                                  <span class="nx">width</span><span class="o">:</span> <span class="nx">oCfg</span><span class="p">.</span><span class="nx">width</span> <span class="o">||</span> <span class="mi">150</span> <span class="p">});</span>
      <span class="p">}</span>
    <span class="p">},</span>
    
    <span class="cm">/**</span>
<span class="cm">     * @method toString</span>
<span class="cm">     * @return {String}</span>
<span class="cm">     */</span>
    <span class="nx">toString</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
      <span class="k">return</span> <span class="s2">&quot;DiaryBlock&quot;</span><span class="p">;</span>
    <span class="p">},</span>
    
    <span class="cm">/**</span>
<span class="cm">     * @method destroy</span>
<span class="cm">     */</span>
    <span class="nx">destroy</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
    <span class="p">}</span>
  
  <span class="p">};</span>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <span class="cm">/**</span>
<span class="cm">   *</span>
<span class="cm">   * A days worth of diary items. Contains none or more DiaryBlocks.</span>
<span class="cm">   * @class DiaryDay</span>
<span class="cm">   * @param {HTMLElement || String} Html element to render to</span>
<span class="cm">   * @param Object   Configuration object literal</span>
<span class="cm">   * @extends YAHOO.util.Element</span>
<span class="cm">   *</span>
<span class="cm">   */</span>
  <span class="kd">var</span> <span class="nx">DiaryDay</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">el</span><span class="p">,</span> <span class="nx">oCfg</span> <span class="p">){</span>

    <span class="nx">DiaryDay</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">el</span><span class="p">,</span> <span class="nx">oCfg</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="c1">// Add some elements</span>
    <span class="kd">var</span> <span class="nx">dataEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s2">&quot;div&quot;</span> <span class="p">);</span>
    <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">dataEl</span> <span class="p">,</span> <span class="nx">CLASS_DIARY_DATACONTAINER</span> <span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">dataEl</span> <span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_dataEl</span> <span class="o">=</span> <span class="nx">dataEl</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">backgroundEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s2">&quot;div&quot;</span> <span class="p">);</span>
    <span class="nx">backgroundEl</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">&quot;bdy-&quot;</span> <span class="o">+</span> <span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span> <span class="mi">4</span> <span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">backgroundEl</span> <span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_backgroundEl</span> <span class="o">=</span> <span class="nx">backgroundEl</span><span class="p">;</span>    


    <span class="c1">// Make the background a DDTarget</span>
    <span class="kd">var</span> <span class="nx">ddt</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">DDTarget</span><span class="p">(</span> <span class="nx">backgroundEl</span> <span class="p">,</span> <span class="s2">&quot;default&quot;</span> <span class="p">);</span>
    
    <span class="c1">// Store a ref to this day so we know on drag drop where we are easily</span>
    <span class="nx">ddt</span><span class="p">.</span><span class="nx">_diaryDay</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">ddTarget</span> <span class="o">=</span> <span class="nx">ddt</span><span class="p">;</span>
    
  <span class="p">};</span>
  

  <span class="nx">DiaryDay</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span>  <span class="kd">function</span><span class="p">(){</span>
       <span class="k">return</span> <span class="s2">&quot;DiaryDay item &quot;</span> <span class="o">+</span> <span class="nx">oDay</span><span class="p">;</span>
  <span class="p">};</span>

  
  
  
  
	<span class="nx">Lang</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span> <span class="nx">DiaryDay</span><span class="p">,</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Element</span><span class="p">,</span> <span class="p">{</span>


      
      <span class="cm">/**</span>
<span class="cm">       * @method initAttributes</span>
<span class="cm">       * @param oCfg {Object} Object literal of config values</span>
<span class="cm">       * @private</span>
<span class="cm">       */</span>
      <span class="nx">initAttributes</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">oCfg</span> <span class="p">){</span>

         <span class="nx">DiaryDay</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">initAttributes</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">oCfg</span> <span class="p">);</span>
         
         <span class="cm">/**</span>
<span class="cm">          * @attribute diary</span>
<span class="cm">          * @type YAHOO.util.Diary</span>
<span class="cm">          * @description reference to the Diary object holding this DiayDay</span>
<span class="cm">          * </span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s1">&#39;diary&#39;</span> <span class="p">);</span>
         <span class="cm">/**</span>
<span class="cm">          * @attribute coldate</span>
<span class="cm">          * @type {Object} </span>
<span class="cm">          * @description Date object for this column</span>
<span class="cm">          * </span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s1">&#39;coldate&#39;</span> <span class="p">);</span>
         
         
         <span class="cm">/**</span>
<span class="cm">          * @attribute width</span>
<span class="cm">          * @type {Int}</span>
<span class="cm">          * @default 150</span>
<span class="cm">          * @description Width of the column (as an integer) in pixels.</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s2">&quot;width&quot;</span> <span class="p">,</span> <span class="p">{</span>
           <span class="nx">method</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">){</span>
             <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="s2">&quot;width&quot;</span> <span class="p">,</span> <span class="nx">v</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span> <span class="p">);</span>
           <span class="p">},</span>
           <span class="nx">value</span> <span class="o">:</span> <span class="mi">150</span>
          <span class="p">}</span>
         <span class="p">);</span>

     
      <span class="p">},</span>


     <span class="cm">/**</span>
<span class="cm">      * </span>
<span class="cm">      * @property _blocks</span>
<span class="cm">      * @description Holds blocks of items</span>
<span class="cm">      * @type Array</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>
     <span class="nx">_blocks</span><span class="o">:</span> <span class="p">[],</span>

     <span class="cm">/**</span>
<span class="cm">      * </span>
<span class="cm">      * @property _dataEl</span>
<span class="cm">      * @description HTMLElement holding the HTMLElements for the DiaryItems</span>
<span class="cm">      * @type HTMLElement</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>     
     <span class="nx">_dataEl</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
     
  
     <span class="cm">/**</span>
<span class="cm">      * @method addItem</span>
<span class="cm">      * @description Adds the item to the day</span>
<span class="cm">      * @param {Object}  Object literal of data for the new DiaryItem</span>
<span class="cm">      * @return {Object} DiaryItem</span>
<span class="cm">      */</span>
     <span class="nx">addItem</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">oData</span> <span class="p">)</span> <span class="p">{</span>
     
       <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;DiaryDay.addItem &quot;</span><span class="p">,</span><span class="s2">&quot;info&quot;</span> <span class="p">);</span>
       <span class="kd">var</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">itemEl</span><span class="p">;</span>
       
         <span class="c1">// create an element for the new item</span>
         <span class="nx">itemEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s2">&quot;div&quot;</span> <span class="p">);</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">_dataEl</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">itemEl</span> <span class="p">);</span>
         
         <span class="c1">// set the column of the new item</span>
         <span class="nx">oData</span><span class="p">.</span><span class="nx">column</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

         <span class="nx">item</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DiaryItem</span><span class="p">(</span> <span class="nx">itemEl</span><span class="p">,</span> <span class="nx">oData</span> <span class="p">);</span>

         <span class="c1">// Work out how this new item fits among the other existing ones</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">_addItemToBlock</span><span class="p">(</span> <span class="nx">item</span> <span class="p">);</span>
           
         <span class="k">return</span> <span class="nx">item</span><span class="p">;</span>
  
     <span class="p">},</span>


     <span class="cm">/**</span>
<span class="cm">      * @method _addItemToBlock</span>
<span class="cm">      * @description Works out which of existing blocks to add this item to, or</span>
<span class="cm">      * create a new block if needed.</span>
<span class="cm">      * @param {Object}  DiaryItem</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>     
     <span class="nx">_addItemToBlock</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">item</span> <span class="p">){</span>
       
       <span class="kd">var</span> <span class="nx">i</span><span class="p">;</span>
       
       <span class="c1">// see if item fits in existing blocks:</span>
       <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span><span class="p">.</span><span class="nx">length</span> <span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
         
         <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span><span class="p">[</span> <span class="nx">i</span> <span class="p">].</span><span class="nx">contains</span><span class="p">(</span> <span class="nx">item</span> <span class="p">)</span> <span class="p">){</span>
           <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span><span class="p">[</span> <span class="nx">i</span> <span class="p">].</span><span class="nx">addItem</span><span class="p">(</span> <span class="nx">item</span> <span class="p">);</span>
           <span class="k">return</span><span class="p">;</span>
         <span class="p">}</span>
         
       <span class="p">}</span>
       
       <span class="c1">// if not, create a new one</span>
       <span class="kd">var</span> <span class="nx">newBlock</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DiaryBlock</span><span class="p">();</span>
       <span class="nx">newBlock</span><span class="p">.</span><span class="nx">addItem</span><span class="p">(</span> <span class="nx">item</span> <span class="p">);</span>
       <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="nx">newBlock</span> <span class="p">);</span>
     
     <span class="p">},</span>
     
     
     <span class="cm">/**</span>
<span class="cm">      * @method removeItemFromBlock</span>
<span class="cm">      * @description Removes an item from its block</span>
<span class="cm">      * @param item {DiaryItem}</span>
<span class="cm">      * @return {Boolean}  Whether it was successfully removed</span>
<span class="cm">      */</span>
     <span class="nx">removeItemFromBlock</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">item</span> <span class="p">){</span>
       
       <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">blocks</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span><span class="p">;</span>
       
       <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">blocks</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">++</span> <span class="p">){</span>
         <span class="k">if</span><span class="p">(</span> <span class="nx">blocks</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">removeItem</span><span class="p">(</span> <span class="nx">item</span> <span class="p">)</span> <span class="p">){</span>
           <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
         <span class="p">}</span>
       <span class="p">}</span>
       
       <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
       
     <span class="p">},</span>
     
     
     <span class="cm">/**</span>
<span class="cm">      * @method _rebuildBlocks</span>
<span class="cm">      * @description Gets current items and rebuilds blocks in case some have changed.</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>
     <span class="nx">_rebuildBlocks</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
         
         <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;rebuilding&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">);</span>     
         <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">allItems</span> <span class="o">=</span> <span class="p">[];</span>
       
         <span class="c1">// Get the existing items into a temp array and get rid of the blocks</span>
         <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>
         
           <span class="k">for</span><span class="p">(</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span><span class="p">[</span> <span class="nx">i</span> <span class="p">].</span><span class="nx">_items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
  
              <span class="nx">allItems</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span><span class="p">[</span> <span class="nx">i</span> <span class="p">].</span><span class="nx">_items</span><span class="p">[</span> <span class="nx">j</span> <span class="p">]</span> <span class="p">);</span>
           
           <span class="p">}</span>
           
           <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span><span class="p">[</span> <span class="nx">i</span> <span class="p">].</span><span class="nx">destroy</span><span class="p">();</span>
  
         <span class="p">}</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span> <span class="o">=</span> <span class="p">[];</span>
        
         <span class="c1">// Sort the items</span>
         <span class="nx">allItems</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span> <span class="nx">Diary</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_itemSorter</span><span class="p">);</span>
         
         <span class="c1">// Re-add the items</span>
         <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">allItems</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
           <span class="k">this</span><span class="p">.</span><span class="nx">_addItemToBlock</span><span class="p">(</span> <span class="nx">allItems</span><span class="p">[</span> <span class="nx">i</span> <span class="p">]</span> <span class="p">);</span>
         <span class="p">}</span>

     
     <span class="p">},</span>
     
     
     <span class="cm">/**</span>
<span class="cm">      * @method render</span>
<span class="cm">      * @description Renders the day view.</span>
<span class="cm">      */</span>
     <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
       
       <span class="c1">// render the columns</span>
       <span class="k">this</span><span class="p">.</span><span class="nx">_renderColumn</span><span class="p">();</span>
       
       <span class="c1">// render each block</span>
       <span class="k">this</span><span class="p">.</span><span class="nx">_renderBlocks</span><span class="p">();</span>

     <span class="p">},</span>



     <span class="cm">/**</span>
<span class="cm">      * @method _renderColumn</span>
<span class="cm">      * @description Draws a column for the day</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>
     <span class="nx">_renderColumn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        
        <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;renderColumn&quot;</span> <span class="p">,</span> <span class="s2">&quot;info&quot;</span> <span class="p">);</span>
        
        <span class="kd">var</span> <span class="nx">h</span><span class="p">,</span>    <span class="c1">// hour counter</span>
            <span class="nx">parent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span>
            <span class="nx">newEl</span><span class="p">,</span>
            <span class="nx">backgroundEl</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_backgroundEl</span><span class="p">,</span>
            <span class="nx">containerEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s2">&quot;div&quot;</span> <span class="p">),</span>
            <span class="nx">baseEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s2">&quot;div&quot;</span> <span class="p">);</span>
        
        <span class="c1">// container:</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">containerEl</span> <span class="p">,</span> <span class="nx">CLASS_DIARYDAY_CONTAINER</span> <span class="p">);</span>
        
        <span class="c1">// container for background:</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">backgroundEl</span><span class="p">,</span> <span class="nx">CLASS_DIARY_BACKGROUND</span> <span class="p">);</span>
       
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">baseEl</span> <span class="p">,</span> <span class="nx">CLASS_DIARY_HOURBLOCK</span><span class="p">);</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="nx">baseEl</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span> <span class="p">,</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;diary&quot;</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;pxPerHour&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span><span class="p">);</span>
        
        
        <span class="c1">// add times</span>
        <span class="k">for</span><span class="p">(</span> <span class="nx">h</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">h</span> <span class="o">&lt;</span> <span class="mi">24</span><span class="p">;</span> <span class="nx">h</span><span class="o">++</span> <span class="p">){</span>
          
          <span class="nx">newEl</span> <span class="o">=</span> <span class="nx">baseEl</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span> <span class="kc">false</span> <span class="p">);</span>
          <span class="nx">newEl</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span><span class="p">(</span> <span class="nx">h</span> <span class="o">&lt;=</span> <span class="mi">12</span> <span class="o">?</span> <span class="nx">h</span> <span class="o">+</span> <span class="s2">&quot;am&quot;</span> <span class="o">:</span> <span class="p">(</span><span class="nx">h</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;pm&quot;</span> <span class="p">);</span>
          <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">newEl</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span> <span class="o">+</span> <span class="nx">h</span> <span class="p">);</span>
          <span class="nx">backgroundEl</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">newEl</span> <span class="p">);</span>
          
        <span class="p">}</span>
        
        <span class="nx">containerEl</span><span class="p">.</span><span class="nx">appendChild</span> <span class="p">(</span>  <span class="nx">backgroundEl</span> <span class="p">);</span>
        <span class="nx">containerEl</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_dataEl</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_dataEl</span> <span class="p">)</span> <span class="p">);</span>
        <span class="nx">parent</span><span class="p">.</span><span class="nx">appendChild</span> <span class="p">(</span> <span class="nx">containerEl</span> <span class="p">);</span>

     <span class="p">},</span>



     <span class="cm">/**</span>
<span class="cm">      * @method _renderBlocks</span>
<span class="cm">      * @description Loops through the items in the block and renders them</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>
     <span class="nx">_renderBlocks</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
       <span class="k">for</span><span class="p">(</span> <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">render</span><span class="p">(</span> <span class="p">{</span> <span class="nx">width</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span> <span class="p">});</span>
       <span class="p">}</span>
     
     <span class="p">},</span>
     
     
     
     
     <span class="cm">/**</span>
<span class="cm">      * Navigate among columns</span>
<span class="cm">      * </span>
<span class="cm">      */</span>
      
     <span class="cm">/**</span>
<span class="cm">      * @method next</span>
<span class="cm">      * @description Get the next column, or null if it&#39;s the last.</span>
<span class="cm">      * @return DiaryDay || null</span>
<span class="cm">      */</span>
     <span class="nx">next</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
       <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;diary&quot;</span><span class="p">).</span><span class="nx">getDiaryDay</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;coldate&quot;</span><span class="p">).</span><span class="nx">setHours</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">86400000</span> <span class="p">);</span>
     <span class="p">},</span>
     

     <span class="cm">/**</span>
<span class="cm">      * @method previous</span>
<span class="cm">      * @description  Gets the previous column, or null if it&#39;s the first</span>
<span class="cm">      * @return DiaryDay || null</span>
<span class="cm">      */</span>
     <span class="nx">previous</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
       <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;diary&quot;</span><span class="p">).</span><span class="nx">getDiaryDay</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;coldate&quot;</span><span class="p">).</span><span class="nx">setHours</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">86400000</span> <span class="p">);</span>
     <span class="p">},</span>
     
     
     <span class="cm">/**</span>
<span class="cm">      * @method destroy</span>
<span class="cm">      * @description Destructor</span>
<span class="cm">      */</span>
     <span class="nx">destroy</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
       
       <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">blocks</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_blocks</span><span class="p">;</span>
       
       <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">blocks</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>
         
         <span class="k">for</span><span class="p">(</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">blocks</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">_items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span> <span class="p">){</span>
           <span class="nx">blocks</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">_items</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">destroy</span><span class="p">();</span>
         <span class="p">}</span>
         <span class="nx">blocks</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">destroy</span><span class="p">();</span>
       <span class="p">}</span>
     <span class="p">}</span>
  
  <span class="p">});</span>
  
  
  
  
  
  
  
  <span class="cm">/**</span>
<span class="cm">   *</span>
<span class="cm">   * The main diary; </span>
<span class="cm">   *</span>
<span class="cm">   * &lt;p&gt;This is the main object.  It:</span>
<span class="cm">   *  &lt;ol style=&quot;margin-left:30px;&quot;&gt;</span>
<span class="cm">   *   &lt;li&gt;gets the data&lt;/li&gt;</span>
<span class="cm">   *   &lt;li&gt;does the main background display&lt;/li&gt;</span>
<span class="cm">   *   &lt;li&gt;sets up the DiaryDay objects and calls their render methods&lt;/li&gt;</span>
<span class="cm">   *   &lt;li&gt;holds delegated event listeners for the DiaryItems&lt;/li&gt;</span>
<span class="cm">   * &lt;/ol&gt;</span>
<span class="cm">   *</span>
<span class="cm">   * @namespace YAHOO.widget</span>
<span class="cm">   * @class Diary</span>
<span class="cm">   * @extends YAHOO.util.Element</span>
<span class="cm">   * @constructor</span>
<span class="cm">   * @param el {HTMLElement} Container element for the Diary</span>
<span class="cm">   * @param oDS {YAHOO.util.DataSource} DataSource instance.  Each &#39;row&#39; in the</span>
<span class="cm">   *  data will need a start date/time and end date/time, both as js Date objects.</span>
<span class="cm">   *  Use the fieldMap config attribute to map data fields to those expected</span>
<span class="cm">   *  by Diary - DTSTART and DTEND.</span>
<span class="cm">   * @param oCfg {Object} Object literal of config values.</span>
<span class="cm">   *</span>
<span class="cm">   */</span>
  <span class="kd">var</span> <span class="nx">Diary</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">el</span><span class="p">,</span> <span class="nx">oDS</span><span class="p">,</span> <span class="nx">oCfg</span> <span class="p">){</span>

    <span class="nx">Diary</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">el</span><span class="p">,</span> <span class="nx">oCfg</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">setupDays</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">initListeners</span><span class="p">();</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">initData</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">oCfg</span><span class="p">,</span> <span class="nx">oDS</span> <span class="p">);</span>

  <span class="p">};</span>
  
  
	<span class="nx">Lang</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span> <span class="nx">Diary</span><span class="p">,</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Element</span><span class="p">,</span> <span class="p">{</span>
  
     <span class="cm">/**</span>
<span class="cm">      * @property _colToDayMap</span>
<span class="cm">      * @type Object</span>
<span class="cm">      * @description provieds a map from columns id&#39;s to dates (in seconds)</span>
<span class="cm">      * @protected </span>
<span class="cm">      */</span>
     <span class="nx">_colToDayMap</span><span class="o">:</span><span class="p">{},</span>
     
     <span class="cm">/**</span>
<span class="cm">      * @property _selector</span>
<span class="cm">      * @type Object</span>
<span class="cm">      * @description Holds details of a click-and-drag to add new Items</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>
     <span class="nx">_selector</span><span class="o">:</span><span class="p">{},</span>
     
     <span class="cm">/**</span>
<span class="cm">      * @property _colWidth</span>
<span class="cm">      * @type Int</span>
<span class="cm">      * @description Column widths</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>
     <span class="nx">_colWidth</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
     
     <span class="cm">/**</span>
<span class="cm">      * @property _ds</span>
<span class="cm">      * @type YAHOO.util.DataSource</span>
<span class="cm">      * @description Reference to the datasource passed in</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>
     <span class="nx">_ds</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
     

     <span class="cm">/**</span>
<span class="cm">      * @property _navCalendar</span>
<span class="cm">      * @type YAHOO.widget.Calendar</span>
<span class="cm">      * @description Navigation calendar</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>
     <span class="nx">_navCalendar</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>

     <span class="cm">/**</span>
<span class="cm">      * @property _tooltip</span>
<span class="cm">      * @type YAHOO.widget.Tooltip</span>
<span class="cm">      * @description Re-usable tooltip, if included on page</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>
     <span class="nx">_tooltip</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>


     <span class="cm">/**</span>
<span class="cm">      * @property _diaryData</span>
<span class="cm">      * @type Array</span>
<span class="cm">      * @description Array holding currently displayed data</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>
      <span class="nx">_diaryData</span><span class="o">:</span> <span class="p">[],</span>


     <span class="cm">/**</span>
<span class="cm">      * @property _itemHash</span>
<span class="cm">      * @type Array</span>
<span class="cm">      * @description Array holding DiaryItem element ids and DiaryItem refs</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>
      <span class="nx">_itemHash</span><span class="o">:</span> <span class="p">[],</span>
      

     <span class="cm">/**</span>
<span class="cm">      * @property _filters</span>
<span class="cm">      * @type Object</span>
<span class="cm">      * @description Object of filters currently applied</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>
      <span class="nx">_filters</span><span class="o">:</span> <span class="p">{},</span>


     <span class="cm">/**</span>
<span class="cm">      * @method initAttributes</span>
<span class="cm">      * @param Object</span>
<span class="cm">      * @description Object of filters currently applied</span>
<span class="cm">      * @private</span>
<span class="cm">      */</span>
     <span class="nx">initAttributes</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">oCfg</span> <span class="p">){</span>
 
        <span class="nx">Diary</span><span class="p">.</span><span class="nx">superclass</span><span class="p">.</span><span class="nx">initAttributes</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">oCfg</span> <span class="p">);</span>

           <span class="cm">/**</span>
<span class="cm">            * @attribute endDate</span>
<span class="cm">            * @description Final date currently displayed on Diary</span>
<span class="cm">            * @type {Date} (Optional)</span>
<span class="cm">            * @default 7 days on from startDate</span>
<span class="cm">            */</span>
           <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s1">&#39;endDate&#39;</span> <span class="p">);</span>
           

           <span class="cm">/**</span>
<span class="cm">            * @attribute startDate</span>
<span class="cm">            * @description When to start the diary display from</span>
<span class="cm">            * @type {Date}</span>
<span class="cm">            */</span>
           <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s1">&#39;startDate&#39;</span> <span class="p">,</span> <span class="p">{</span>
             <span class="nx">method</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">){</span>
               <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;endDate&quot;</span><span class="p">))</span> <span class="p">{</span>
                  <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;endDate&quot;</span><span class="p">,</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span> <span class="nx">v</span><span class="p">,</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">DAY</span><span class="p">,</span> <span class="mi">7</span> <span class="p">));</span>
               <span class="p">}</span>
             <span class="p">}</span>
           <span class="p">});</span>
    			 

           <span class="cm">/**</span>
<span class="cm">            * @attribute width</span>
<span class="cm">            * @description Overall width of Diary (in pixels)</span>
<span class="cm">            * @type Number (Optional) Will use element styled width if no value provided and it has one</span>
<span class="cm">            */</span>
    			 <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s2">&quot;width&quot;</span> <span class="p">,</span> <span class="p">{</span>
    			   <span class="nx">method</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">v</span> <span class="p">){</span>
    			     <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="p">(</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span> <span class="nx">v</span> <span class="p">)</span> <span class="p">)</span> <span class="p">){</span>
    			       <span class="nx">v</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="s2">&quot;width&quot;</span> <span class="p">)</span> <span class="p">,</span> <span class="mi">10</span> <span class="p">);</span> 
    			     <span class="p">}</span>
               <span class="k">if</span><span class="p">(</span> <span class="nx">v</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">){</span>
                  <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="s2">&quot;width&quot;</span> <span class="p">,</span> <span class="nx">v</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span> <span class="p">);</span>
               <span class="p">}</span>
    			   <span class="p">}</span>
    			  <span class="p">}</span>
    			<span class="p">);</span>
    
    
           <span class="cm">/**</span>
<span class="cm">            * @attribute scaleColumns</span>
<span class="cm">            * @description Whether to scale columns to width.  writeOnce</span>
<span class="cm">            * @type Boolean</span>
<span class="cm">            * @default true</span>
<span class="cm">            */</span>			 
          <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s1">&#39;scaleColumns&#39;</span> <span class="p">,</span> <span class="p">{</span>
            
            <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">method</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">){</span>
              <span class="k">if</span><span class="p">(</span> <span class="nx">v</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;width&quot;</span> <span class="p">)</span> <span class="p">){</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_colWidth</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;width&quot;</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">8</span><span class="p">;</span> <span class="c1">// ( 7 days / week )</span>
              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_colWidth</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
              <span class="p">}</span>
            <span class="p">},</span>
            <span class="nx">writeOnce</span><span class="o">:</span> <span class="kc">true</span>
             
            <span class="p">}</span> 
    			 <span class="p">);</span>
    			 
    			 
    			 <span class="cm">/**</span>
<span class="cm">    			  * </span>
<span class="cm">    			  */</span>
           <span class="cm">/**</span>
<span class="cm">            * @attribute display</span>
<span class="cm">            * @description Display formats: object literal with format </span>
<span class="cm">            * and start and end times (in 24-hour clock hours) displayed</span>
<span class="cm">            * in the main window (the rest are above and below the scroll.</span>
<span class="cm">            * &lt;pre&gt;{ format: &quot;week&quot;, startTime: 8, endTime: 20 }&lt;/pre&gt;.</span>
<span class="cm">            * The only format available currently is &quot;week&quot;.  Write once.</span>
<span class="cm">            * @type Object</span>
<span class="cm">            * @default &lt;pre&gt;{ format: &quot;week&quot;, startTime: 8, endTime: 20 }&lt;/pre&gt;</span>
<span class="cm">            */</span>	
           <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s1">&#39;display&#39;</span> <span class="p">,</span> <span class="p">{</span>
             <span class="nx">value</span><span class="o">:</span>  <span class="p">{</span> <span class="nx">format</span><span class="o">:</span> <span class="s2">&quot;week&quot;</span> <span class="p">,</span> <span class="nx">startTime</span><span class="o">:</span> <span class="mi">8</span><span class="p">,</span> <span class="nx">endTime</span><span class="o">:</span> <span class="mi">20</span> <span class="p">},</span>
             <span class="nx">writeOnce</span><span class="o">:</span> <span class="kc">true</span>
            <span class="p">}</span> 
    			 <span class="p">);</span>
    			 			 
    
    
    			 
           <span class="cm">/**</span>
<span class="cm">            * @attribute calenderNav</span>
<span class="cm">            * @description Whether to use a YAHOO.widget.Calendar in the navigation.</span>
<span class="cm">            *   Write once.</span>
<span class="cm">            * @type Boolean</span>
<span class="cm">            * @default true</span>
<span class="cm">            */</span>			 
           <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s1">&#39;calenderNav&#39;</span><span class="p">,</span> <span class="p">{</span>
             <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span><span class="p">,</span>
             <span class="nx">value</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
             <span class="nx">writeOnce</span><span class="o">:</span> <span class="kc">true</span>
           <span class="p">});</span>
           
           

           <span class="cm">/**</span>
<span class="cm">            * @attribute fieldMap</span>
<span class="cm">            * @description  Field map, mapping keys of DataSource to expected </span>
<span class="cm">            * keys of data for DiaryItems.  DiaryItem keys are the keys in the </span>
<span class="cm">            * object passed; values are the names of the fields in the DataSource.</span>
<span class="cm">            * backClass is the css class string applied to the background container of the</span>
<span class="cm">            * DiaryItem; detailClass is the css class string applied to the element</span>
<span class="cm">            * holding the text of the item.  These can be used by addItemFilter</span>
<span class="cm">            * to show or hide items by category.  Write once</span>
<span class="cm">            *</span>
<span class="cm">            * @type {Object}</span>
<span class="cm">            * @default &lt;pre&gt; </span>
<span class="cm">             &amp;nbsp;        { UID: &quot;UID&quot;,</span>
<span class="cm">             &amp;nbsp;          DTSTART: &quot;DTSTART&quot;,</span>
<span class="cm">             &amp;nbsp;          DTEND:   &quot;DTEND&quot;,</span>
<span class="cm">             &amp;nbsp;          SUMMARY: &quot;SUMMARY&quot;,</span>
<span class="cm">             &amp;nbsp;          DESCRIPTION: &quot;DESCRIPTION&quot;,</span>
<span class="cm">             &amp;nbsp;          CATEGORIES: &quot;CATEGORIES&quot;,</span>
<span class="cm">             &amp;nbsp;          LOCATION: &quot;LOCATION&quot;,</span>
<span class="cm">             &amp;nbsp;          URL: &quot;URL&quot;,</span>
<span class="cm">             &amp;nbsp;          backClass: &quot;backClass&quot;,</span>
<span class="cm">             &amp;nbsp;          detailClass: &quot;detailClass&quot; }&lt;/pre&gt;</span>
<span class="cm">            */</span>	
            <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s1">&#39;fieldMap&#39;</span> <span class="p">,</span> <span class="p">{</span>
            
              <span class="nx">value</span><span class="o">:</span> <span class="p">{</span> <span class="nx">UID</span><span class="o">:</span> <span class="s2">&quot;UID&quot;</span><span class="p">,</span>
                       <span class="nx">DTSTART</span><span class="o">:</span> <span class="s2">&quot;DTSTART&quot;</span><span class="p">,</span>
                       <span class="nx">DTEND</span><span class="o">:</span>   <span class="s2">&quot;DTEND&quot;</span><span class="p">,</span>
                       <span class="nx">SUMMARY</span><span class="o">:</span> <span class="s2">&quot;SUMMARY&quot;</span><span class="p">,</span>
                       <span class="nx">DESCRIPTION</span><span class="o">:</span> <span class="s2">&quot;DESCRIPTION&quot;</span><span class="p">,</span>
                       <span class="nx">URL</span><span class="o">:</span> <span class="s2">&quot;URL&quot;</span><span class="p">,</span>
                       <span class="nx">CATEGORIES</span><span class="o">:</span> <span class="s2">&quot;CATEGORIES&quot;</span><span class="p">,</span>
                       <span class="nx">LOCATION</span><span class="o">:</span> <span class="s2">&quot;LOCATION&quot;</span><span class="p">,</span>
                       <span class="nx">backClass</span><span class="o">:</span> <span class="s2">&quot;backClass&quot;</span><span class="p">,</span>
                       <span class="nx">detailClass</span><span class="o">:</span> <span class="s2">&quot;detailClass&quot;</span> <span class="p">},</span>
              <span class="nx">setter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">oMap</span> <span class="p">){</span>
              
                <span class="k">return</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span> <span class="p">{</span> 
                       <span class="nx">UID</span><span class="o">:</span> <span class="s2">&quot;UID&quot;</span><span class="p">,</span>
                       <span class="nx">DTSTART</span><span class="o">:</span> <span class="s2">&quot;DTSTART&quot;</span><span class="p">,</span>
                       <span class="nx">DTEND</span><span class="o">:</span>   <span class="s2">&quot;DTEND&quot;</span><span class="p">,</span>
                       <span class="nx">SUMMARY</span><span class="o">:</span> <span class="s2">&quot;SUMMARY&quot;</span><span class="p">,</span>
                       <span class="nx">DESCRIPTION</span><span class="o">:</span> <span class="s2">&quot;DESCRIPTION&quot;</span><span class="p">,</span>
                       <span class="nx">URL</span><span class="o">:</span> <span class="s2">&quot;URL&quot;</span><span class="p">,</span>
                       <span class="nx">CATEGORIES</span><span class="o">:</span> <span class="s2">&quot;CATEGORIES&quot;</span><span class="p">,</span>
                       <span class="nx">LOCATION</span><span class="o">:</span> <span class="s2">&quot;LOCATION&quot;</span><span class="p">,</span>
                       <span class="nx">backClass</span><span class="o">:</span> <span class="s2">&quot;backClass&quot;</span><span class="p">,</span>
                       <span class="nx">detailClass</span><span class="o">:</span> <span class="s2">&quot;detailClass&quot;</span>
                    <span class="p">},</span> <span class="nx">oMap</span>
                <span class="p">);</span>
              
              <span class="p">},</span>
              <span class="nx">writeOnce</span><span class="o">:</span> <span class="kc">true</span>
            
          
          <span class="p">}</span> <span class="p">);</span>
  			 

           <span class="cm">/**</span>
<span class="cm">            * @attribute titleString</span>
<span class="cm">            * @description String to use as template for title.  You can use </span>
<span class="cm">            * strftime type identifiers.  Write once.</span>
<span class="cm">            * @type String</span>
<span class="cm">            * @default &quot;Diary w/c %A, %e %B %Y&quot;</span>
<span class="cm">            */</span>	
           <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s2">&quot;titleString&quot;</span> <span class="p">,</span> <span class="p">{</span>
             <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="p">,</span>
             <span class="nx">value</span><span class="o">:</span> <span class="s2">&quot;Diary w/c %A, %e %B %Y&quot;</span><span class="p">,</span>
             <span class="nx">writeOnce</span><span class="o">:</span> <span class="kc">true</span>
           <span class="p">});</span>
           

           <span class="cm">/**</span>
<span class="cm">            * @attribute itemClickCreateNew</span>
<span class="cm">            * @description Whether you can click and drag on an existing item </span>
<span class="cm">            * to start creating a new one.</span>
<span class="cm">            * @type Boolean</span>
<span class="cm">            * @default false</span>
<span class="cm">            */</span>
           <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s2">&quot;itemClickCreateNew&quot;</span><span class="p">,</span> <span class="p">{</span>
             <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span><span class="p">,</span>
             <span class="nx">value</span><span class="o">:</span> <span class="kc">false</span>
           <span class="p">});</span>
           
           
   
          <span class="cm">/**</span>
<span class="cm">           * @attribute allowCreateMultiDayItems</span>
<span class="cm">           * @description  Whether, when creating new items, they&#39;re allowed to span multi days</span>
<span class="cm">           * @default: false</span>
<span class="cm">           * @type Boolean</span>
<span class="cm">           */</span> 
           <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s2">&quot;allowCreateMultiDayItems&quot;</span><span class="p">,</span> <span class="p">{</span>
             <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span><span class="p">,</span>
             <span class="nx">value</span><span class="o">:</span> <span class="kc">false</span>
           <span class="p">});</span>        
          
          
   
          <span class="cm">/**</span>
<span class="cm">           * @attribute tooltip</span>
<span class="cm">           * @description  Whether to use tooltip for mouseover events to show details.</span>
<span class="cm">           *   Write once.</span>
<span class="cm">           * @default: false</span>
<span class="cm">           * @type Boolean</span>
<span class="cm">           */</span> 
           <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s2">&quot;tooltip&quot;</span><span class="p">,</span> <span class="p">{</span>
             <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span><span class="p">,</span>
             <span class="nx">value</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
             <span class="nx">writeOnce</span><span class="o">:</span> <span class="kc">true</span>
           <span class="p">});</span>        
                  
          
   
          <span class="cm">/**</span>
<span class="cm">           * @attribute animate</span>
<span class="cm">           * @description  Whether to use animation when moving items around.</span>
<span class="cm">           *    Write once.</span>
<span class="cm">           * @default: false</span>
<span class="cm">           * @type Boolean</span>
<span class="cm">           */</span> 
           <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s2">&quot;useAnimation&quot;</span><span class="p">,</span> <span class="p">{</span>
             <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span><span class="p">,</span>
             <span class="nx">value</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
             <span class="nx">writeOnce</span><span class="o">:</span> <span class="kc">true</span>
           <span class="p">});</span> 
           
   
          <span class="cm">/**</span>
<span class="cm">           * @attribute pxPerHour</span>
<span class="cm">           * @description  Number of pixels per hour.   Write once.</span>
<span class="cm">           * @default: 20</span>
<span class="cm">           * @type Number</span>
<span class="cm">           */</span> 
           <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span> <span class="s2">&quot;pxPerHour&quot;</span><span class="p">,</span> <span class="p">{</span>
             <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">,</span>
             <span class="nx">value</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span>
             <span class="nx">writeOnce</span><span class="o">:</span> <span class="kc">true</span>
           <span class="p">});</span>



         
           <span class="cm">/**</span>
<span class="cm">            * @attribute useCssCategories</span>
<span class="cm">            * @description If true, any CATEGORIES will be added as css classes</span>
<span class="cm">            * to the container element for the DiaryItem, allowing styling and filtering.</span>
<span class="cm">            * Anything passed to backClass will also be added.  Spaces in categories</span>
<span class="cm">            * will be changed to hyphens.</span>
<span class="cm">            * @type Boolean</span>
<span class="cm">            * @default false</span>
<span class="cm">            */</span>
           <span class="k">this</span><span class="p">.</span><span class="nx">setAttributeConfig</span><span class="p">(</span><span class="s1">&#39;useCssCategories&#39;</span><span class="p">,</span> <span class="p">{</span>
             <span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span><span class="p">,</span>
             <span class="nx">value</span><span class="o">:</span> <span class="kc">false</span>
           <span class="p">});</span>

                        
         			 
			<span class="p">},</span>







       <span class="cm">/**</span>
<span class="cm">        * @method initListeners</span>
<span class="cm">        * @description Set up delegated event listeners for rendering and mouse events</span>
<span class="cm">        * @protected</span>
<span class="cm">        */</span>
       <span class="nx">initListeners</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
       
          <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span> <span class="s2">&quot;parseData&quot;</span> <span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">,</span> <span class="k">this</span> <span class="p">);</span>
          
          <span class="c1">// click and drag new items</span>
          <span class="nx">Ev</span><span class="p">.</span><span class="nx">delegate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="s2">&quot;mousedown&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_startNewItem</span><span class="p">,</span> <span class="s2">&quot;div.&quot;</span> <span class="o">+</span> <span class="nx">CLASS_DIARY</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
          
          <span class="c1">// click on existing diary items</span>
          <span class="nx">Ev</span><span class="p">.</span><span class="nx">delegate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleItemClick</span><span class="p">,</span> <span class="s2">&quot;div.&quot;</span> <span class="o">+</span> <span class="nx">CLASS_DIARY_ITEM</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
          
          <span class="c1">// mouseover</span>
          <span class="nx">Ev</span><span class="p">.</span><span class="nx">delegate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="s2">&quot;mouseenter&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleItemMouseEnter</span><span class="p">,</span> <span class="s2">&quot;div.&quot;</span> <span class="o">+</span> <span class="nx">CLASS_DIARY_ITEM</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
          
          <span class="c1">// change display date</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;startDateChange&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_reDo</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
       
       <span class="p">},</span>



       <span class="cm">/**</span>
<span class="cm">        * @method setupDays</span>
<span class="cm">        * @description Display days of the week holders</span>
<span class="cm">        * @protected</span>
<span class="cm">        */</span>
       <span class="nx">setupDays</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      
         <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Diary.setupDays&quot;</span> <span class="p">,</span><span class="s2">&quot;info&quot;</span> <span class="p">);</span>
      
         <span class="kd">var</span> <span class="nx">calHolder</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s2">&quot;div&quot;</span> <span class="p">);</span>


        
         <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">calHolder</span><span class="p">,</span> <span class="nx">CLASS_DIARY</span> <span class="p">);</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">_calHolder</span> <span class="o">=</span> <span class="nx">calHolder</span><span class="p">;</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">calHolder</span> <span class="p">);</span>
                
          <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nx">calHolder</span><span class="p">,</span>
              <span class="nx">dayEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s2">&quot;div&quot;</span> <span class="p">),</span>
              <span class="nx">newDayEl</span> <span class="p">,</span> 
              <span class="nx">zeroTime</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;startDate&quot;</span><span class="p">).</span><span class="nx">getTime</span><span class="p">(),</span> <span class="mi">10</span> <span class="p">),</span>
              <span class="nx">day</span><span class="p">;</span>
  
          
          
          <span class="nx">dayEl</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="nx">CLASS_DIARY_DAY</span><span class="p">;</span>
          
          <span class="c1">// loop through from start to end adding a new DiaryDay for each</span>
          <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">zeroTime</span> <span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">zeroTime</span> <span class="o">+</span> <span class="mi">604800000</span> <span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">86400000</span> <span class="p">)</span> <span class="p">{</span>
        
            <span class="nx">newDayEl</span> <span class="o">=</span> <span class="nx">dayEl</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
            <span class="nx">j</span> <span class="o">=</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">generateId</span><span class="p">(</span> <span class="nx">newDayEl</span> <span class="p">,</span> <span class="s1">&#39;day-&#39;</span> <span class="p">);</span>
            
            <span class="nx">day</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span> <span class="nx">i</span> <span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_diaryData</span><span class="p">[</span> <span class="nx">i</span> <span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DiaryDay</span><span class="p">(</span> <span class="nx">newDayEl</span><span class="p">,</span> <span class="p">{</span> <span class="nx">coldate</span><span class="o">:</span> <span class="nx">day</span> <span class="p">,</span> <span class="nx">diary</span><span class="o">:</span> <span class="k">this</span> <span class="p">,</span> <span class="nx">width</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_colWidth</span> <span class="p">}</span>  <span class="p">);</span>
        
            <span class="nx">parent</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">newDayEl</span> <span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_colToDayMap</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
        
                    
          <span class="p">}</span>
       <span class="p">},</span>
       
       
       <span class="cm">/**</span>
<span class="cm">        * @method getDiaryDay</span>
<span class="cm">        * @description Get the DiaryDay object based on date (in seconds)</span>
<span class="cm">        * @param secsDate {Int}  start time in seconds.</span>
<span class="cm">        * @return {Object} DiaryDay </span>
<span class="cm">        */</span>
       <span class="nx">getDiaryDay</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">secsDate</span> <span class="p">)</span> <span class="p">{</span>
         <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Diary.getDiaryDay &quot;</span> <span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">);</span>
         <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_diaryData</span><span class="p">[</span> <span class="nx">secsDate</span> <span class="p">];</span>
       <span class="p">},</span>



       <span class="cm">/**</span>
<span class="cm">        * @description Click and drag to add new DiaryItem</span>
<span class="cm">        * @method _startNewItem</span>
<span class="cm">        * @protected</span>
<span class="cm">        * @param ev {Event}</span>
<span class="cm">        */</span>
       <span class="nx">_startNewItem</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">ev</span> <span class="p">){</span>
          
          <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Diary._startNewItem&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">);</span>

          <span class="kd">var</span> <span class="nx">el</span><span class="p">,</span> <span class="nx">sel</span><span class="p">,</span> <span class="nx">dayEl</span><span class="p">,</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">Ev</span><span class="p">.</span><span class="nx">getTarget</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">div</span><span class="p">;</span>



           <span class="cm">/**</span>
<span class="cm">            * @event itemBeforeStartCreate</span>
<span class="cm">            * @description Before starting to create a new item by click and dragging</span>
<span class="cm">            * If subscribers return false the start is cancelled.</span>
<span class="cm">            * @param oArgs.originEvent  Event passed through</span>
<span class="cm">            */</span>
           <span class="k">if</span><span class="p">(</span> <span class="kc">false</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span> <span class="s2">&quot;itemBeforeStartCreate&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">originEvent</span><span class="o">:</span> <span class="nx">ev</span> <span class="p">}</span> <span class="p">)</span> <span class="p">){</span>

             <span class="k">return</span><span class="p">;</span>
           <span class="p">}</span>
           
           <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span> <span class="nx">target</span><span class="p">,</span> <span class="nx">CLASS_DIARY_ITEM</span><span class="p">)</span> <span class="o">||</span> 
                 <span class="nx">Dom</span><span class="p">.</span><span class="nx">getAncestorByClassName</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span>  <span class="nx">CLASS_DIARY_ITEM</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> 
                 <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;itemClickCreateNew&quot;</span> <span class="p">)</span> <span class="p">){</span> 
            <span class="k">return</span><span class="p">;</span>
           <span class="p">}</span>
  
           <span class="c1">// only start a new one if previous ones have finished:</span>
           <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_selector</span><span class="p">.</span><span class="nx">selectorDiv</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_selector</span><span class="p">.</span><span class="nx">selectorDiv</span> <span class="o">===</span> <span class="kc">null</span> <span class="p">){</span> 
  
            <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_calHolder</span><span class="p">;</span>
            <span class="nx">sel</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_selector</span><span class="p">;</span>
  
           <span class="c1">// column we&#39;re over:</span>
  				  <span class="nx">dayEl</span> <span class="o">=</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">getAncestorByClassName</span><span class="p">(</span> <span class="nx">Ev</span><span class="p">.</span><span class="nx">getTarget</span><span class="p">(</span><span class="nx">ev</span><span class="p">),</span> <span class="nx">CLASS_DIARY_DAY</span><span class="p">);</span>
  				  <span class="k">if</span><span class="p">(</span> <span class="nx">dayEl</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">dayEl</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="p">){</span>
  				    <span class="k">return</span><span class="p">;</span>
  				  <span class="p">}</span>
  				  <span class="nx">sel</span><span class="p">.</span><span class="nx">dayNumber</span> <span class="o">=</span> <span class="nx">dayEl</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
  
     
             <span class="nx">Ev</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span> <span class="nx">el</span> <span class="p">,</span> <span class="s1">&#39;mousemove&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_resizeSelectorDiv</span> <span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span> <span class="p">);</span>
             <span class="nx">Ev</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span> <span class="nx">el</span> <span class="p">,</span> <span class="s1">&#39;mouseup&#39;</span> <span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_endSelector</span> <span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span> <span class="p">);</span>
             
             <span class="nx">x</span> <span class="o">=</span> <span class="nx">Ev</span><span class="p">.</span><span class="nx">getPageX</span><span class="p">(</span> <span class="nx">ev</span> <span class="p">);</span><span class="c1">// ev.clientX;</span>
    				 <span class="nx">y</span> <span class="o">=</span> <span class="nx">Ev</span><span class="p">.</span><span class="nx">getPageY</span><span class="p">(</span> <span class="nx">ev</span> <span class="p">)</span> <span class="o">-</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">getDocumentScrollTop</span><span class="p">();</span> <span class="c1">//ev.clientY;</span>
    				 
    				 <span class="nx">sel</span><span class="p">.</span><span class="nx">startX</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
    				 <span class="nx">sel</span><span class="p">.</span><span class="nx">startY</span> <span class="o">=</span> <span class="nx">y</span><span class="p">;</span>
    				 
    				 <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s1">&#39;div&#39;</span> <span class="p">);</span>
    				 <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">div</span><span class="p">,</span> <span class="nx">CLASS_DIARY_SELECTOR</span><span class="p">);</span>
    				 <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="nx">div</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="nx">x</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span> <span class="p">);</span>
    				 <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="nx">div</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="nx">y</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span> <span class="p">);</span>
    				 <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="nx">div</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="s1">&#39;0px&#39;</span> <span class="p">);</span>
    				 <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="nx">div</span> <span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;0px&#39;</span> <span class="p">);</span>

    
   				 
    				 <span class="nx">sel</span><span class="p">.</span><span class="nx">selectorDiv</span> <span class="o">=</span> <span class="nx">div</span><span class="p">;</span>
    				 <span class="c1">// append to the data el</span>
    				 <span class="nx">Dom</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span> <span class="nx">CLASS_DIARY_DATACONTAINER</span><span class="p">,</span>
                                        <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="nx">dayEl</span><span class="p">,</span> 
                                        <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="nx">n</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">div</span><span class="p">);}</span> <span class="p">);</span>

    				 <span class="nx">Ev</span><span class="p">.</span><span class="nx">stopEvent</span><span class="p">(</span><span class="nx">ev</span><span class="p">);</span>
  				<span class="p">}</span>
  				 
       <span class="p">},</span>
       
 
     
     <span class="cm">/**</span>
<span class="cm">      * @description Resizes the selector when creating a new item</span>
<span class="cm">      * @method _resizeSelectorDiv</span>
<span class="cm">      * @protected</span>
<span class="cm">      * @param ev {Event}</span>
<span class="cm">      */</span>    
     <span class="nx">_resizeSelectorDiv</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">ev</span> <span class="p">){</span>
     
        <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">Ev</span><span class="p">.</span><span class="nx">getPageX</span><span class="p">(</span> <span class="nx">ev</span> <span class="p">);</span><span class="c1">// ev.clientX;</span>
        <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">Ev</span><span class="p">.</span><span class="nx">getPageY</span><span class="p">(</span> <span class="nx">ev</span> <span class="p">)</span> <span class="o">-</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">getDocumentScrollTop</span><span class="p">();</span><span class="c1">//ev.clientY;</span>
        <span class="kd">var</span> <span class="nx">startX</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_selector</span><span class="p">.</span><span class="nx">startX</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">startY</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_selector</span><span class="p">.</span><span class="nx">startY</span><span class="p">;</span>
        
        <span class="kd">var</span> <span class="nx">top</span><span class="p">,</span> <span class="nx">left</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">;</span>
        
        <span class="c1">// work out co-ords</span>
        <span class="k">if</span><span class="p">(</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="nx">startX</span> <span class="p">){</span>
           <span class="nx">width</span> <span class="o">=</span> <span class="nx">startX</span> <span class="o">-</span> <span class="nx">x</span><span class="p">;</span>
           <span class="nx">left</span>  <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
           <span class="nx">width</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">-</span> <span class="nx">startX</span><span class="p">;</span>
           <span class="nx">left</span>  <span class="o">=</span> <span class="nx">startX</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">if</span><span class="p">(</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="nx">startY</span> <span class="p">){</span>
           <span class="nx">top</span>   <span class="o">=</span> <span class="nx">y</span><span class="p">;</span>
           <span class="nx">height</span> <span class="o">=</span> <span class="nx">startY</span> <span class="o">-</span> <span class="nx">y</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
           <span class="nx">top</span>    <span class="o">=</span> <span class="nx">startY</span><span class="p">;</span>
           <span class="nx">height</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">-</span> <span class="nx">startY</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="c1">//height -= Dom.getDocumentScrollTop();</span>
        
        
        <span class="kd">var</span> <span class="nx">div</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_selector</span><span class="p">.</span><span class="nx">selectorDiv</span><span class="p">;</span>
      
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="nx">div</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span> <span class="p">,</span> <span class="nx">width</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span> <span class="p">);</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="nx">div</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span> <span class="p">,</span> <span class="nx">height</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span> <span class="p">);</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="nx">div</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span> <span class="p">,</span> <span class="nx">left</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span> <span class="p">);</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="nx">div</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span> <span class="p">,</span> <span class="nx">top</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span> <span class="p">);</span>
        
        <span class="nx">Ev</span><span class="p">.</span><span class="nx">stopEvent</span><span class="p">(</span><span class="nx">ev</span><span class="p">);</span>
     <span class="p">},</span>
     
     
     <span class="cm">/**</span>
<span class="cm">      * @description Called at the end of selector - creating a new item by drag-drop</span>
<span class="cm">      * @method _endSelector</span>
<span class="cm">      * @protected</span>
<span class="cm">      * @param ev {Event}</span>
<span class="cm">      */</span>
     <span class="nx">_endSelector</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">){</span>

        
        <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Diary._endSelector &quot;</span> <span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">);</span>
        
            <span class="c1">// start day of new item</span>
        <span class="kd">var</span> <span class="nx">itemDay</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_colToDayMap</span><span class="p">[</span> <span class="k">this</span><span class="p">.</span><span class="nx">_selector</span><span class="p">.</span><span class="nx">dayNumber</span> <span class="p">],</span> 
            <span class="c1">// date object of new item</span>
            <span class="nx">itemStartDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span> <span class="nx">itemDay</span> <span class="p">),</span> 
            <span class="c1">// final day of new item</span>
            <span class="nx">finalDayEl</span> <span class="o">=</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">getAncestorByClassName</span><span class="p">(</span> <span class="nx">Ev</span><span class="p">.</span><span class="nx">getTarget</span><span class="p">(</span><span class="nx">ev</span><span class="p">),</span> <span class="nx">CLASS_DIARY_DAY</span><span class="p">),</span>
            <span class="c1">// final day id and date</span>
            <span class="nx">finalDayNumber</span> <span class="o">=</span> <span class="p">(</span> <span class="nx">finalDayEl</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">finalDayEl</span><span class="p">.</span><span class="nx">id</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">finalItemDay</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_colToDayMap</span><span class="p">[</span> <span class="nx">finalDayNumber</span> <span class="p">],</span>
            <span class="c1">// end date is either same day or where the mouse-upped</span>
            <span class="nx">itemEndDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;allowCreateMultiDayItems&quot;</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">finalItemDay</span> <span class="o">:</span> <span class="nx">itemDay</span> <span class="p">)</span> <span class="p">),</span>
            <span class="c1">// work out times from mouse positions</span>
            <span class="nx">regionT</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">getRegion</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_diaryData</span><span class="p">[</span> <span class="nx">itemDay</span> <span class="p">].</span><span class="nx">_backgroundEl</span> <span class="p">).</span><span class="nx">top</span> <span class="p">,</span> <span class="mi">10</span> <span class="p">),</span>
            <span class="nx">t</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_selector</span><span class="p">.</span><span class="nx">selectorDiv</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span> <span class="p">)</span> <span class="p">,</span> <span class="mi">10</span> <span class="p">)</span> <span class="o">-</span> 
                          <span class="nx">regionT</span> <span class="o">+</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">getDocumentScrollTop</span><span class="p">()),</span>
            <span class="nx">h</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">getStyle</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_selector</span><span class="p">.</span><span class="nx">selectorDiv</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span> <span class="p">),</span> <span class="mi">10</span> <span class="p">),</span>
            <span class="c1">// the new DiaryItem</span>
            <span class="nx">newItem</span><span class="p">,</span>
            <span class="c1">// tidies up after the item&#39;s been created</span>
            <span class="nx">cleanUp</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">ob</span> <span class="p">){</span>
                <span class="nx">Ev</span><span class="p">.</span><span class="nx">purgeElement</span><span class="p">(</span> <span class="nx">ob</span><span class="p">.</span><span class="nx">_calHolder</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="s1">&#39;mousemove&#39;</span> <span class="p">);</span>
                <span class="nx">Ev</span><span class="p">.</span><span class="nx">purgeElement</span><span class="p">(</span> <span class="nx">ob</span><span class="p">.</span><span class="nx">_calHolder</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="s1">&#39;mouseup&#39;</span> <span class="p">);</span>
                <span class="kd">var</span> <span class="nx">div</span> <span class="o">=</span> <span class="nx">ob</span><span class="p">.</span><span class="nx">_selector</span><span class="p">.</span><span class="nx">selectorDiv</span><span class="p">;</span>
                <span class="nx">div</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span> <span class="nx">div</span> <span class="p">);</span>
                <span class="nx">ob</span><span class="p">.</span><span class="nx">_selector</span><span class="p">.</span><span class="nx">selectorDiv</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                <span class="nx">ob</span><span class="p">.</span><span class="nx">_selector</span><span class="p">.</span><span class="nx">startX</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                <span class="nx">ob</span><span class="p">.</span><span class="nx">_selector</span><span class="p">.</span><span class="nx">startY</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>            
            <span class="p">};</span>


         <span class="cm">/**</span>
<span class="cm">          * @event itemBeforeEndCreate</span>
<span class="cm">          * @description Fired on the mouseup after drag-selecting to create a new Item.</span>
<span class="cm">          * This is fired before the actual item is created and rendered.</span>
<span class="cm">          * If subscribers return false the start is cancelled.</span>
<span class="cm">          */</span>
         <span class="k">if</span><span class="p">(</span> <span class="kc">false</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span> <span class="s2">&quot;itemBeforeEndCreate&quot;</span><span class="p">,</span> <span class="p">{</span>
             <span class="nx">DTSTART</span><span class="o">:</span> <span class="nx">itemStartDate</span><span class="p">,</span>
             <span class="nx">DTEND</span><span class="o">:</span> <span class="nx">itemEndDate</span><span class="p">,</span>
             <span class="nx">originEvent</span><span class="o">:</span> <span class="nx">ev</span> <span class="p">}</span> <span class="p">)</span> <span class="p">){</span>
           
           <span class="nx">cleanUp</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>
           <span class="k">return</span><span class="p">;</span>
         <span class="p">}</span>

            
        <span class="k">if</span><span class="p">(</span> <span class="nx">h</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">){</span>
            
            <span class="c1">// get start times</span>
            <span class="kd">var</span> <span class="nx">tSecs</span> <span class="o">=</span> <span class="nx">DiaryItem</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calcStartFromPosition</span><span class="p">(</span> <span class="nx">t</span> <span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;pxPerHour&quot;</span><span class="p">)),</span>
            <span class="nx">hSecs</span> <span class="o">=</span> <span class="nx">DiaryItem</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calcEndFromPosition</span><span class="p">(</span><span class="nx">h</span><span class="p">,</span> <span class="nx">t</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;pxPerHour&quot;</span><span class="p">)),</span>
            <span class="nx">itemCfg</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">DTSTART</span><span class="o">:</span> <span class="mi">0</span> <span class="p">,</span> <span class="nx">DTEND</span><span class="o">:</span> <span class="mi">0</span> <span class="p">,</span> <span class="nx">SUMMARY</span><span class="o">:</span> <span class="s1">&#39;&#39;</span> <span class="p">},</span>
            <span class="nx">startHours</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span> <span class="nx">tSecs</span> <span class="o">/</span> <span class="mi">3600</span> <span class="p">),</span>
            <span class="nx">startMins</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span> <span class="p">(</span><span class="nx">tSecs</span> <span class="o">-</span> <span class="p">(</span> <span class="nx">startHours</span> <span class="o">*</span> <span class="mi">3600</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">60</span> <span class="p">),</span>
            <span class="nx">endHours</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span>  <span class="nx">hSecs</span> <span class="o">/</span> <span class="mi">3600</span> <span class="p">),</span>
            <span class="nx">endMins</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span>  <span class="nx">hSecs</span> <span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="nx">endHours</span> <span class="o">*</span> <span class="mi">3600</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">60</span> <span class="p">);</span>
            <span class="c1">// to nearest 15 minutes</span>
            <span class="nx">startMins</span> <span class="o">=</span> <span class="nx">startMins</span> <span class="o">-</span> <span class="p">(</span> <span class="nx">startMins</span> <span class="o">%</span> <span class="mi">15</span> <span class="p">);</span>
            <span class="nx">endMins</span> <span class="o">=</span> <span class="nx">endMins</span> <span class="o">-</span> <span class="p">(</span> <span class="nx">endMins</span> <span class="o">%</span> <span class="mi">15</span> <span class="p">);</span>
            
            <span class="c1">// set the times</span>
            <span class="nx">itemStartDate</span><span class="p">.</span><span class="nx">setHours</span><span class="p">(</span> <span class="nx">startHours</span> <span class="p">,</span> <span class="nx">startMins</span> <span class="p">);</span>
            <span class="nx">itemEndDate</span><span class="p">.</span><span class="nx">setHours</span><span class="p">(</span> <span class="nx">endHours</span> <span class="p">,</span> <span class="nx">endMins</span> <span class="p">);</span>
            <span class="nx">itemCfg</span><span class="p">.</span><span class="nx">DTSTART</span> <span class="o">=</span> <span class="nx">itemStartDate</span><span class="p">;</span>
            <span class="nx">itemCfg</span><span class="p">.</span><span class="nx">DTEND</span> <span class="o">=</span> <span class="nx">itemEndDate</span><span class="p">;</span>
  
            <span class="c1">// the new DiaryItem</span>
            <span class="nx">newItem</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">addItem</span><span class="p">(</span> <span class="nx">itemCfg</span><span class="p">,</span> <span class="kc">true</span> <span class="p">);</span>
        
            <span class="nx">cleanUp</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>

         <span class="cm">/**</span>
<span class="cm">          * @event itemEndCreate</span>
<span class="cm">          * @description Fired at the end of thee mouseup after drag-selecting to create a new Item.</span>
<span class="cm">          * This is fired after the actual item is created and rendered.</span>
<span class="cm">          */</span>        
        <span class="k">this</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span> <span class="s2">&quot;itemEndCreate&quot;</span> <span class="p">,</span> <span class="p">{</span> <span class="nx">item</span><span class="o">:</span> <span class="nx">newItem</span> <span class="p">}</span> <span class="p">);</span>
        
        <span class="p">}</span>
        


        
     <span class="p">},</span>
     
     
     
     <span class="cm">/**</span>
<span class="cm">      * @description Add an item to the Diary</span>
<span class="cm">      * @method addItem</span>
<span class="cm">      * @param oCfg   {Object}      Data for the new item, minimally- DTSTART: oDate, DTEND: oDate </span>
<span class="cm">      * @param redraw {Boolean}     Whether to redraw once it&#39;s added</span>
<span class="cm">      * @return {DiaryItem}  The new item created</span>
<span class="cm">      */</span>
     <span class="nx">addItem</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">oCfg</span> <span class="p">,</span> <span class="nx">render</span> <span class="p">){</span>
   
        <span class="kd">var</span> <span class="nx">itemDay</span><span class="p">,</span> <span class="nx">newItem</span><span class="p">,</span> <span class="nx">firstItem</span><span class="p">,</span> <span class="nx">itemDayDate</span><span class="p">,</span> <span class="nx">nextColumn</span><span class="p">,</span> <span class="nx">newConfig</span><span class="p">;</span>
     
        <span class="k">if</span><span class="p">(</span> <span class="nx">render</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">render</span> <span class="o">===</span> <span class="kc">null</span> <span class="p">){</span>
          <span class="nx">render</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="cm">/**</span>
<span class="cm">         * @event beforeAddItem</span>
<span class="cm">         * @description Before an item is added to the Diary</span>
<span class="cm">         * @param Object  Object literal containing data</span>
<span class="cm">         */</span>
         
        <span class="k">this</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span> <span class="s2">&quot;beforeAddItem&quot;</span> <span class="p">,</span> <span class="p">{</span> <span class="nx">data</span><span class="o">:</span> <span class="nx">oCfg</span> <span class="p">}</span> <span class="p">);</span>


        
        <span class="c1">// which column are we adding this to?</span>
        <span class="nx">itemDay</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_findFirstItemDay</span><span class="p">(</span> <span class="nx">oCfg</span><span class="p">.</span><span class="nx">DTSTART</span><span class="p">,</span> <span class="nx">oCfg</span><span class="p">.</span><span class="nx">DTEND</span> <span class="p">);</span>

        
        <span class="k">if</span><span class="p">(</span> <span class="nx">itemDay</span> <span class="o">===</span> <span class="kc">false</span> <span class="p">){</span>
          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        
 
         <span class="c1">// useful internal function to save and render a newly added item</span>
         <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
         <span class="kd">var</span> <span class="nx">saveAndRender</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">item</span> <span class="p">){</span>

            <span class="nx">that</span><span class="p">.</span><span class="nx">_itemHash</span><span class="p">[</span> <span class="nx">item</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">).</span><span class="nx">id</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">item</span><span class="p">;</span>
      
            <span class="k">if</span><span class="p">(</span> <span class="nx">render</span> <span class="p">){</span>
               <span class="nx">that</span><span class="p">.</span><span class="nx">_diaryData</span><span class="p">[</span> <span class="nx">item</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;column&quot;</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;coldate&quot;</span><span class="p">).</span><span class="nx">getTime</span><span class="p">()</span> <span class="p">].</span><span class="nx">_rebuildBlocks</span><span class="p">();</span>
               <span class="nx">that</span><span class="p">.</span><span class="nx">_diaryData</span><span class="p">[</span> <span class="nx">item</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;column&quot;</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;coldate&quot;</span><span class="p">).</span><span class="nx">getTime</span><span class="p">()</span> <span class="p">].</span><span class="nx">_renderBlocks</span><span class="p">();</span>
            <span class="p">}</span>
            
            <span class="nx">that</span><span class="p">.</span><span class="nx">_applyFiltersToElement</span><span class="p">(</span> <span class="nx">item</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">)</span> <span class="p">);</span>
            
         <span class="p">};</span>
 
 
        
        <span class="c1">// Create a date object for the column date</span>
        <span class="nx">itemDayDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span> <span class="nx">itemDay</span> <span class="p">);</span>
        
        
        <span class="c1">// Alter the config passed to DiaryItem:</span>
        <span class="nx">newConfig</span> <span class="o">=</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span> <span class="nx">oCfg</span><span class="p">,</span> <span class="p">{</span> 
                <span class="nx">resizeTop</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> 
                <span class="nx">resizeBottom</span><span class="o">:</span> <span class="kc">true</span> <span class="p">,</span>
                <span class="nx">enableDragDrop</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="nx">useAnimation</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;useAnimation&quot;</span><span class="p">),</span>
                <span class="nx">pxPerHour</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;pxPerHour&quot;</span><span class="p">),</span>
                <span class="nx">useCssCategories</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;useCssCategories&quot;</span><span class="p">)</span>
        <span class="p">});</span>
        
        
        
        <span class="c1">// if it&#39;s a one-day item, just add it:</span>
        
        <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_sameDay</span><span class="p">(</span> <span class="nx">oCfg</span><span class="p">.</span><span class="nx">DTSTART</span> <span class="p">,</span> <span class="nx">oCfg</span><span class="p">.</span><span class="nx">DTEND</span> <span class="p">)</span> <span class="p">){</span>
        
           <span class="nx">firstItem</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_diaryData</span><span class="p">[</span> <span class="nx">itemDay</span> <span class="p">].</span><span class="nx">addItem</span><span class="p">(</span> <span class="nx">newConfig</span> <span class="p">);</span>
           <span class="nx">saveAndRender</span><span class="p">(</span> <span class="nx">firstItem</span> <span class="p">);</span>
          
        <span class="p">}</span>
        
        
        <span class="c1">// otherwise it extends over several days:</span>
        
        <span class="k">else</span> <span class="p">{</span>
        

              <span class="nx">nextColumn</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_diaryData</span><span class="p">[</span> <span class="nx">itemDay</span> <span class="p">];</span>

              <span class="c1">// loop through until we reach the end of the Diary view, or the end of the event</span>
              <span class="k">while</span><span class="p">(</span> <span class="nx">nextColumn</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">DM</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span> <span class="nx">nextColumn</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;coldate&quot;</span><span class="p">)</span> <span class="p">,</span> <span class="nx">oCfg</span><span class="p">.</span><span class="nx">DTEND</span> <span class="p">)</span> <span class="p">){</span>


                  <span class="c1">// Alter the config passed to DiaryItem:                                                            </span>
                  <span class="nx">newConfig</span> <span class="o">=</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span> <span class="nx">oCfg</span><span class="p">,</span> <span class="p">{</span> <span class="nx">resizeTop</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">resizeBottom</span><span class="o">:</span> <span class="kc">true</span> <span class="p">,</span><span class="nx">enableDragDrop</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}</span> <span class="p">);</span>  
                  
                  
                                 
                 <span class="c1">// Is the real start date of the item the same as the column</span>
                 <span class="c1">// we&#39;re adding it to?</span>
                 
                 <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_sameDay</span><span class="p">(</span> <span class="nx">oCfg</span><span class="p">.</span><span class="nx">DTSTART</span> <span class="p">,</span> <span class="nx">nextColumn</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;coldate&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">){</span>
                 
                   <span class="c1">// this is the first of a multi-day event: </span>
                   <span class="c1">//   displayed start time == DTSTART</span>
                   <span class="c1">//   top handle for resize</span>
                   <span class="c1">//   no drag-drop</span>
                   <span class="c1">//   no bottom handle for resize</span>
                   <span class="nx">newConfig</span> <span class="o">=</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span> <span class="nx">newConfig</span><span class="p">,</span> <span class="p">{</span> 
                           <span class="nx">resizeBottom</span><span class="o">:</span> <span class="kc">false</span> <span class="p">,</span>
                           <span class="nx">enableDragDrop</span><span class="o">:</span> <span class="kc">false</span> <span class="p">,</span>
                           <span class="nx">_displayDTSTART</span><span class="o">:</span> <span class="nx">oCfg</span><span class="p">.</span><span class="nx">DTSTART</span><span class="p">,</span>
                           <span class="nx">_displayDTEND</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getEndOfDay</span><span class="p">(</span> <span class="nx">nextColumn</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;coldate&quot;</span><span class="p">)</span> <span class="p">),</span>
                           <span class="nx">multiDayPosition</span><span class="o">:</span> <span class="s2">&quot;first&quot;</span>
                      <span class="p">}</span> 
                   <span class="p">);</span>

            
                 <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                 
                   <span class="c1">// is this the last day of the item?</span>
                   <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_sameDay</span><span class="p">(</span> <span class="nx">oCfg</span><span class="p">.</span><span class="nx">DTEND</span> <span class="p">,</span> <span class="nx">nextColumn</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;coldate&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">){</span>
                   
                       <span class="c1">//   displayed end time == DTEND</span>
                       <span class="c1">//   display start tiem = midnight</span>
                       <span class="c1">//   no top handle for resize</span>
                       <span class="c1">//   no drag-drop</span>
                       <span class="c1">//   bottom handle for resize</span>
                       <span class="nx">newConfig</span> <span class="o">=</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span> <span class="nx">newConfig</span><span class="p">,</span> <span class="p">{</span> 
                               <span class="nx">resizeTop</span><span class="o">:</span> <span class="kc">false</span> <span class="p">,</span>
                               <span class="nx">enableDragDrop</span><span class="o">:</span> <span class="kc">false</span> <span class="p">,</span>
                               <span class="nx">_displayDTSTART</span><span class="o">:</span> <span class="nx">nextColumn</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;coldate&quot;</span><span class="p">),</span>
                               <span class="nx">_displayDTEND</span><span class="o">:</span> <span class="nx">oCfg</span><span class="p">.</span><span class="nx">DTEND</span> <span class="p">,</span>
                               <span class="nx">multiDayPosition</span><span class="o">:</span> <span class="s2">&quot;last&quot;</span>
                          <span class="p">}</span> 
                       <span class="p">);</span>

                       
                   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                   
                     <span class="c1">// this is an intermediate item </span>
                     <span class="c1">// no dragdrop</span>
                     <span class="c1">// no resize</span>
                     <span class="c1">// runs from midnight to midnight</span>
                     <span class="nx">newConfig</span> <span class="o">=</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span> <span class="nx">newConfig</span><span class="p">,</span>  <span class="p">{</span> 
                           <span class="nx">resizeBottom</span><span class="o">:</span> <span class="kc">false</span> <span class="p">,</span>
                           <span class="nx">resizeTop</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
                           <span class="nx">enableDragDrop</span><span class="o">:</span> <span class="kc">false</span> <span class="p">,</span>
                           <span class="nx">_displayDTSTART</span><span class="o">:</span>  <span class="nx">nextColumn</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;coldate&quot;</span><span class="p">),</span>
                           <span class="nx">_displayDTEND</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_getEndOfDay</span><span class="p">(</span> <span class="nx">nextColumn</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;coldate&quot;</span><span class="p">)</span> <span class="p">),</span>
                           <span class="nx">multiDayPosition</span><span class="o">:</span> <span class="s2">&quot;mid&quot;</span>
                       <span class="p">}</span> 
                     <span class="p">);</span>

                   <span class="p">}</span>
                   
                 
                 <span class="p">}</span> <span class="c1">// end of setting up the config objects</span>


                 <span class="c1">// create and add the new Item:</span>
                 <span class="nx">newItem</span> <span class="o">=</span> <span class="nx">nextColumn</span><span class="p">.</span><span class="nx">addItem</span><span class="p">(</span> <span class="nx">newConfig</span> <span class="p">);</span>
           
                 <span class="k">if</span><span class="p">(</span> <span class="nx">firstItem</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">firstItem</span> <span class="o">===</span> <span class="kc">null</span> <span class="p">){</span>
                 
                   <span class="nx">firstItem</span> <span class="o">=</span> <span class="nx">newItem</span><span class="p">;</span>
                 
                 <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                 
                   <span class="c1">// add parent/child references:</span>
                   <span class="nx">firstItem</span><span class="p">.</span><span class="nx">addMultiDayChild</span><span class="p">(</span> <span class="nx">newItem</span> <span class="p">);</span>
                   <span class="nx">newItem</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span> <span class="s2">&quot;multiDayParent&quot;</span> <span class="p">,</span> <span class="nx">firstItem</span> <span class="p">);</span>
                   
                 <span class="p">}</span>
                 
                 <span class="nx">saveAndRender</span><span class="p">(</span> <span class="nx">newItem</span> <span class="p">);</span>
              
                 <span class="c1">// go on to the next column:</span>
                 <span class="nx">nextColumn</span> <span class="o">=</span> <span class="nx">nextColumn</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
           
              
              <span class="p">}</span><span class="c1">// end of while loop</span>
           

        
        
        <span class="p">}</span> <span class="c1">// end of adding multi-day events</span>
               
        


        
        <span class="k">return</span> <span class="nx">firstItem</span><span class="p">;</span>
     <span class="p">},</span>





 
 
 
     
     <span class="cm">/**</span>
<span class="cm">      * @method getItem</span>
<span class="cm">      * @description Returns the DiaryItem with id elId</span>
<span class="cm">      * @param elId {String}</span>
<span class="cm">      * @return {DiaryItem}</span>
<span class="cm">      *</span>
<span class="cm">      */</span>
     <span class="nx">getItem</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">elId</span> <span class="p">){</span>
       <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_itemHash</span><span class="p">[</span> <span class="nx">elId</span> <span class="p">];</span>
       <span class="k">if</span><span class="p">(</span> <span class="nx">el</span> <span class="p">){</span>
         <span class="k">return</span> <span class="nx">el</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
     <span class="p">},</span>     
     
     
     
     <span class="cm">/**</span>
<span class="cm">      *</span>
<span class="cm">      * Event handlers</span>
<span class="cm">      *</span>
<span class="cm">      *</span>
<span class="cm">      */</span>
      
      <span class="cm">/**</span>
<span class="cm">       * @description When a DiaryItem is clicked</span>
<span class="cm">       * @method handleItemClick</span>
<span class="cm">       * @param ev {Event}</span>
<span class="cm">       * @param el {HTMLElement}</span>
<span class="cm">       * @param el {HTMLElement}</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>
     <span class="nx">handleItemClick</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">ev</span> <span class="p">,</span> <span class="nx">el</span><span class="p">,</span> <span class="nx">container</span> <span class="p">){</span>
         <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s1">&#39;Diary.handleItemClick&#39;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">);</span>
         
         <span class="cm">/**</span>
<span class="cm">          * @event itemClick</span>
<span class="cm">          * @param oArgs.item  The DiaryItem clicked on</span>
<span class="cm">          * @param oArgs.ev    The click event</span>
<span class="cm">          * @param oArgs.el    The element clicked on</span>
<span class="cm">          * @param oArgs.container  The container element (from delegate)</span>
<span class="cm">          */</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span> <span class="s2">&quot;itemClick&quot;</span> <span class="p">,</span> 
                         <span class="p">{</span> <span class="nx">item</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span> <span class="nx">el</span><span class="p">.</span><span class="nx">id</span> <span class="p">),</span>
                           <span class="nx">ev</span><span class="o">:</span>   <span class="nx">ev</span><span class="p">,</span>
                           <span class="nx">el</span><span class="o">:</span>   <span class="nx">el</span><span class="p">,</span>
                           <span class="nx">container</span><span class="o">:</span> <span class="nx">container</span> <span class="p">}</span> <span class="p">);</span>
                     
     <span class="p">},</span>

     
     <span class="cm">/**</span>
<span class="cm">      * @method handleItemMouseEnter</span>
<span class="cm">      * @description When a DiaryItem is mouseenter-ed.  Default behaviour</span>
<span class="cm">      * is to show a tooltip (if this was enabled in the config).  The</span>
<span class="cm">      * itemMouseEnter event is fired first; return false to this to stop </span>
<span class="cm">      * the default behaviour.</span>
<span class="cm">      * @param ev {Event}</span>
<span class="cm">      * @param el {HTMLElement}</span>
<span class="cm">      * @param el {HTMLElement}</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>
     <span class="nx">handleItemMouseEnter</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">ev</span><span class="p">,</span> <span class="nx">el</span><span class="p">,</span> <span class="nx">container</span> <span class="p">){</span>

         <span class="cm">/**</span>
<span class="cm">          * @event itemMouseEnter</span>
<span class="cm">          * @description When a mouse enters a DiaryItem.  Return false</span>
<span class="cm">          * to cancel default behaviour (tooltip at the moment).</span>
<span class="cm">          * @param oArgs.item  The DiaryItem mouseentered</span>
<span class="cm">          * @param oArgs.ev    The mouseenter event</span>
<span class="cm">          * @param oArgs.el    The element </span>
<span class="cm">          * @param oArgs.container  The container element (from delegate)</span>
<span class="cm">          */</span>
         <span class="k">if</span><span class="p">(</span> <span class="kc">false</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span> <span class="s2">&quot;itemMouseEnter&quot;</span> <span class="p">,</span> 
                         <span class="p">{</span> <span class="nx">item</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span> <span class="nx">el</span><span class="p">.</span><span class="nx">id</span> <span class="p">),</span>
                           <span class="nx">ev</span><span class="o">:</span>   <span class="nx">ev</span><span class="p">,</span>
                           <span class="nx">el</span><span class="o">:</span>   <span class="nx">el</span><span class="p">,</span>
                           <span class="nx">container</span><span class="o">:</span> <span class="nx">container</span> <span class="p">}</span> <span class="p">)</span> <span class="p">){</span>
                           
            <span class="c1">// Default behaviour: show tooltip with full details:</span>
            <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_tooltip</span> <span class="p">){</span>
             
              <span class="k">this</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span><span class="p">).</span><span class="nx">_detailsEl</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">_tooltip</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span>  <span class="nx">el</span><span class="p">.</span><span class="nx">id</span> <span class="p">).</span><span class="nx">renderFullDetails</span><span class="p">()</span> <span class="p">);</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">_tooltip</span><span class="p">.</span><span class="nx">cfg</span><span class="p">.</span><span class="nx">setProperty</span><span class="p">(</span> <span class="s2">&quot;context&quot;</span> <span class="p">,</span> <span class="nx">el</span> <span class="p">);</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">_tooltip</span><span class="p">.</span><span class="nx">cfg</span><span class="p">.</span><span class="nx">setProperty</span><span class="p">(</span> <span class="s2">&quot;disabled&quot;</span> <span class="p">,</span> <span class="kc">false</span> <span class="p">);</span>
              <span class="k">this</span><span class="p">.</span><span class="nx">_tooltip</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
            <span class="p">}</span>
                              
         <span class="p">}</span>
     <span class="p">},</span>

     
     
     
     
     
     <span class="cm">/**</span>
<span class="cm">      *</span>
<span class="cm">      *</span>
<span class="cm">      *</span>
<span class="cm">      * Navigation</span>
<span class="cm">      *</span>
<span class="cm">      *</span>
<span class="cm">      *</span>
<span class="cm">      *</span>
<span class="cm">      */</span>
     
     <span class="cm">/**</span>
<span class="cm">      * @method _doPrevious</span>
<span class="cm">      * @description Go to the previous day/week</span>
<span class="cm">      * @protected</span>
<span class="cm">      * </span>
<span class="cm">      */</span>
      <span class="nx">_doPrevious</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

          <span class="kd">var</span> <span class="nx">newStartDate</span> <span class="o">=</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">subtract</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;startDate&quot;</span><span class="p">),</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">WEEK</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span> <span class="s2">&quot;startDate&quot;</span> <span class="p">,</span><span class="nx">newStartDate</span> <span class="p">);</span>

      <span class="p">},</span>

     <span class="cm">/**</span>
<span class="cm">      * @method _doNext</span>
<span class="cm">      * @description Go to the next day/week</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>      
      <span class="nx">_doNext</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

          <span class="kd">var</span> <span class="nx">newStartDate</span> <span class="o">=</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;startDate&quot;</span><span class="p">),</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">WEEK</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span> <span class="s2">&quot;startDate&quot;</span> <span class="p">,</span><span class="nx">newStartDate</span> <span class="p">);</span>
      <span class="p">},</span>
      
     <span class="cm">/**</span>
<span class="cm">      * @method _doCalNav</span>
<span class="cm">      * @description Go to any start date (set by calendar)</span>
<span class="cm">      * @param ev {Event}</span>
<span class="cm">      * @param selDate {Array} Selected date, as returned by YAHOO.util.Calendar</span>
<span class="cm">      *   (ie array [[[ yyyy, mm, dd]]])</span>
<span class="cm">      * @protected</span>
<span class="cm">      */</span>      
      <span class="nx">_doCalNav</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">,</span> <span class="nx">selDate</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">_navCalendar</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span> <span class="s2">&quot;startDate&quot;</span> <span class="p">,</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span> <span class="nx">selDate</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">selDate</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">,</span> <span class="nx">selDate</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span> <span class="p">);</span>
      <span class="p">},</span>
      
      <span class="cm">/**</span>
<span class="cm">       * @method _doFirstDayOfTodaysWeek</span>
<span class="cm">       * @description Goes to the start of this week</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>
      <span class="nx">_doFirstDayOfTodaysWeek</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

         <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Diary._doFirstDayOfWeek &quot;</span>  <span class="p">,</span> <span class="s2">&quot;info&quot;</span> <span class="p">);</span>
         
         <span class="kd">var</span> <span class="nx">startOfWeek</span> <span class="o">=</span>  <span class="nx">DM</span><span class="p">.</span><span class="nx">getFirstDayOfWeek</span><span class="p">(</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="mi">1</span> <span class="p">),</span>
             <span class="nx">currentStart</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;startDate&quot;</span> <span class="p">);</span>

         <span class="c1">// do we need to change?</span>
         <span class="k">if</span><span class="p">(</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span> <span class="nx">startOfWeek</span> <span class="p">,</span> <span class="nx">currentStart</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span> <span class="nx">startOfWeek</span><span class="p">,</span><span class="nx">currentStart</span> <span class="p">)</span> <span class="p">){</span>
           <span class="k">return</span><span class="p">;</span>
         <span class="p">}</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span> <span class="s2">&quot;startDate&quot;</span><span class="p">,</span> <span class="nx">startOfWeek</span><span class="p">);</span>
      <span class="p">},</span>
      
      <span class="cm">/**</span>
<span class="cm">       * @method _reDo</span>
<span class="cm">       * @description Redraws calendar, deleting DiaryItems and data currently held first</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>
      <span class="nx">_reDo</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
      
          <span class="cm">/**</span>
<span class="cm">           * @event beforeReDo</span>
<span class="cm">           * @description Fired before the Diary is redrawn, which happens</span>
<span class="cm">           *  on navigation (onStartDateChange)</span>
<span class="cm">           * </span>
<span class="cm">           */</span>
          
          <span class="k">this</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span> <span class="s2">&quot;beforeReDo&quot;</span> <span class="p">);</span>
          
          <span class="k">this</span><span class="p">.</span><span class="nx">_destroyDays</span><span class="p">();</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">_destroyData</span><span class="p">();</span>
          
          <span class="k">this</span><span class="p">.</span><span class="nx">setupDays</span><span class="p">();</span>
          
          <span class="k">this</span><span class="p">.</span><span class="nx">initData</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="p">{},</span> <span class="k">this</span><span class="p">.</span><span class="nx">_ds</span> <span class="p">);</span>
          
          <span class="k">this</span><span class="p">.</span><span class="nx">_renderTitle</span><span class="p">();</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">_renderColumnLabels</span><span class="p">();</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">_applyFilters</span><span class="p">();</span>
      <span class="p">},</span>





       <span class="cm">/**</span>
<span class="cm">        *</span>
<span class="cm">        * Data methods</span>
<span class="cm">        *</span>
<span class="cm">        *</span>
<span class="cm">        */</span>
        
        <span class="cm">/**</span>
<span class="cm">         * @method initData</span>
<span class="cm">         * @description Store a reference to the data and get it</span>
<span class="cm">         * @param el {HTMLElement}</span>
<span class="cm">         * @param oCfg {Object}</span>
<span class="cm">         * @param oDS {YAHOO.util.DataSource}</span>
<span class="cm">         * @protected</span>
<span class="cm">         */</span>
       <span class="nx">initData</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">el</span><span class="p">,</span> <span class="nx">oCfg</span><span class="p">,</span> <span class="nx">oDS</span> <span class="p">){</span>
         
         <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Diary.initData&quot;</span> <span class="p">,</span><span class="s2">&quot;info&quot;</span><span class="p">);</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">_ds</span> <span class="o">=</span> <span class="nx">oDS</span><span class="p">;</span>
         <span class="k">this</span><span class="p">.</span><span class="nx">_getData</span><span class="p">(</span> <span class="nx">oDS</span> <span class="p">);</span>
       
       <span class="p">},</span>




  
  	  <span class="cm">/**</span>
<span class="cm">	     * @method _getData</span>
<span class="cm">       * @description Gets data from the data source</span>
<span class="cm">	     * @param oDS {YAHOO.util.DataSource}</span>
<span class="cm">	     * @protected</span>
<span class="cm">	     */</span>
	    <span class="nx">_getData</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">oDS</span> <span class="p">){</span>
         
         <span class="nx">oDS</span><span class="p">.</span><span class="nx">sendRequest</span><span class="p">(</span> <span class="nx">oDS</span> <span class="p">,</span> <span class="p">{</span> <span class="nx">success</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_parseData</span><span class="p">,</span>            
											            <span class="nx">failure</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_dataFailed</span><span class="p">,</span>
											            <span class="nx">scope</span><span class="o">:</span> <span class="k">this</span> 
         <span class="p">});</span>

	    <span class="p">},</span>
	    
	    
	    <span class="cm">/**</span>
<span class="cm">	     * Parses the data when it comes</span>
<span class="cm">	     * @param req  {Object}		Request object</span>
<span class="cm">	     * @param data {Object}		Data returned by DataSource</span>
<span class="cm">	     * @protected</span>
<span class="cm">	     */</span>
	    <span class="nx">_parseData</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">req</span><span class="p">,</span> <span class="nx">data</span> <span class="p">){</span>

         <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Diary._parseData starting&quot;</span> <span class="p">,</span> <span class="s2">&quot;info&quot;</span> <span class="p">);</span>

         <span class="c1">// sort the raw data:</span>
         <span class="c1">//data.results.sort( this._rawItemSorter );</span>
         
         <span class="kd">var</span> <span class="nx">num</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> 
                   <span class="nx">itemDate</span><span class="p">,</span> 
                   <span class="nx">itemDay</span><span class="p">,</span> 
                   <span class="nx">i</span><span class="p">,</span>
                   <span class="nx">startDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;startDate&quot;</span><span class="p">),</span>
                   <span class="nx">endDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;endDate&quot;</span> <span class="p">),</span>
                   <span class="nx">tempVal</span><span class="p">,</span>
                   <span class="nx">newData</span> <span class="o">=</span> <span class="p">{},</span>
                   <span class="nx">currentData</span> <span class="o">=</span> <span class="p">{},</span>
                   <span class="nx">fieldMap</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;fieldMap&quot;</span><span class="p">);</span>
      
        
        
         <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">num</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>
        
         
           <span class="nx">currentData</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">results</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

           <span class="k">if</span> <span class="p">(</span><span class="nx">currentData</span><span class="p">[</span><span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTSTART</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
              
           <span class="c1">// make sure it ends after it starts: swap if not</span>
           <span class="k">if</span><span class="p">(</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span> <span class="nx">currentData</span><span class="p">[</span> <span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTEND</span> <span class="p">],</span> <span class="nx">currentData</span><span class="p">[</span><span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTSTART</span><span class="p">]</span> <span class="p">)</span> <span class="p">){</span>   
              <span class="nx">tempVal</span> <span class="o">=</span> <span class="nx">currentData</span><span class="p">[</span><span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTSTART</span><span class="p">];</span>
              <span class="nx">currentData</span><span class="p">[</span><span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTSTART</span><span class="p">]</span> <span class="o">=</span> <span class="nx">currentData</span><span class="p">[</span> <span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTEND</span> <span class="p">];</span>
              <span class="nx">currentData</span><span class="p">[</span> <span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTEND</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">tempVal</span><span class="p">;</span>
           <span class="p">}</span>


           <span class="c1">// Get a &#39;zero&#39; start date to group by day</span>
           <span class="nx">itemDate</span> <span class="o">=</span> <span class="nx">currentData</span><span class="p">[</span><span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTSTART</span><span class="p">];</span>

           <span class="c1">// check item is in current date range:</span>
           <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="p">(</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span> <span class="nx">itemDate</span><span class="p">,</span> <span class="nx">endDate</span> <span class="p">)</span> <span class="o">||</span> 
                  <span class="nx">DM</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span> <span class="nx">currentData</span><span class="p">[</span> <span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTEND</span> <span class="p">]</span> <span class="p">,</span> <span class="nx">startDate</span> <span class="p">)</span> <span class="p">)</span> <span class="p">){</span>

               <span class="nx">itemDay</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_findFirstItemDay</span><span class="p">(</span> <span class="nx">itemDate</span><span class="p">,</span> <span class="nx">currentData</span><span class="p">[</span> <span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTEND</span> <span class="p">]</span> <span class="p">);</span>
               


               <span class="k">if</span><span class="p">(</span> <span class="nx">itemDay</span> <span class="o">===</span> <span class="kc">false</span> <span class="p">){</span>
                  <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;ERROR Data parsed not in range&quot;</span><span class="p">,</span> <span class="s2">&quot;warn&quot;</span> <span class="p">);</span>
    					 <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    					   <span class="c1">// Add the diary item for relevant day</span>
                 
                 <span class="nx">newData</span> <span class="o">=</span> <span class="c1">//Lang.merge( currentData, </span>
                 <span class="p">{</span>  
                     <span class="nx">UID</span><span class="o">:</span> <span class="nx">currentData</span><span class="p">[</span><span class="nx">fieldMap</span><span class="p">.</span><span class="nx">UID</span><span class="p">],</span>
                     <span class="nx">DTSTART</span><span class="o">:</span> <span class="nx">currentData</span><span class="p">[</span><span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTSTART</span><span class="p">],</span>
                     <span class="nx">DTEND</span><span class="o">:</span>   <span class="nx">currentData</span><span class="p">[</span><span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTEND</span><span class="p">],</span>
                     <span class="nx">SUMMARY</span><span class="o">:</span> <span class="nx">currentData</span><span class="p">[</span> <span class="nx">fieldMap</span><span class="p">.</span><span class="nx">SUMMARY</span> <span class="p">],</span>
                     <span class="nx">DESCRIPTION</span><span class="o">:</span> <span class="nx">currentData</span><span class="p">[</span> <span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DESCRIPTION</span> <span class="p">],</span>
                     <span class="nx">URL</span> <span class="o">:</span> <span class="nx">currentData</span><span class="p">[</span> <span class="nx">fieldMap</span><span class="p">.</span><span class="nx">URL</span> <span class="p">],</span>
                     <span class="nx">CATEGORIES</span><span class="o">:</span> <span class="nx">currentData</span><span class="p">[</span><span class="nx">fieldMap</span><span class="p">.</span><span class="nx">CATEGORIES</span><span class="p">],</span>
                     <span class="nx">LOCATION</span><span class="o">:</span> <span class="nx">currentData</span><span class="p">[</span><span class="nx">fieldMap</span><span class="p">.</span><span class="nx">LOCATION</span><span class="p">],</span>
                     <span class="nx">backClass</span><span class="o">:</span> <span class="nx">currentData</span><span class="p">[</span> <span class="nx">fieldMap</span><span class="p">.</span><span class="nx">backClass</span> <span class="p">],</span>
                     <span class="nx">detailClass</span><span class="o">:</span> <span class="nx">currentData</span><span class="p">[</span> <span class="nx">fieldMap</span><span class="p">.</span><span class="nx">detailClass</span> <span class="p">]</span>                   
                 <span class="p">}</span><span class="c1">// );</span>
                 <span class="k">this</span><span class="p">.</span><span class="nx">addItem</span><span class="p">(</span> <span class="nx">newData</span> <span class="p">);</span>

               <span class="p">}</span>
           <span class="p">}</span>
          
          <span class="p">}</span>
           
         <span class="p">}</span>
      
       <span class="cm">/**</span>
<span class="cm">        * Fired when data parsed and ready</span>
<span class="cm">        * @event parseData</span>
<span class="cm">        * @description Fired when data&#39;s been parsed</span>
<span class="cm">        * @param oArgs.data     Parsed data</span>
<span class="cm">        * @param oArgs.type     &quot;parseData&quot;</span>
<span class="cm">        * @param oArgs.target   Diary</span>
<span class="cm">        */</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span> <span class="s2">&quot;parseData&quot;</span> <span class="p">,</span> <span class="p">{</span> 
               <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;parseData&quot;</span> <span class="p">,</span> 
               <span class="nx">data</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">_diaryData</span><span class="p">,</span> 
               <span class="nx">target</span><span class="o">:</span> <span class="nx">parent</span> 
        <span class="p">});</span>

        <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;end of parse&quot;</span> <span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">);</span>    
	    <span class="p">},</span>
	    
	    
	    <span class="cm">/**</span>
<span class="cm">	     * @description Looks for the first day between startDate and endDate that has a column</span>
<span class="cm">	     * in the diary; multi-day items may not start in range but may go into it.</span>
<span class="cm">	     * @param  startDate {Date}</span>
<span class="cm">	     * @param  endDate {Date}</span>
<span class="cm">	     * @return {Date|false}  Date or first if it doesn&#39;t fall in range.</span>
<span class="cm">	     * @private</span>
<span class="cm">	     */</span>
	    <span class="nx">_findFirstItemDay</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">startDate</span><span class="p">,</span> <span class="nx">endDate</span> <span class="p">){</span>
	    
	      <span class="kd">var</span> <span class="nx">testDate</span> <span class="o">=</span> <span class="nx">startDate</span><span class="p">,</span>
            <span class="nx">testZeroDay</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span> <span class="nx">testDate</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">testDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">(),</span> <span class="nx">testDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">).</span><span class="nx">setHours</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
	      
	      <span class="k">while</span><span class="p">(</span> <span class="o">!</span><span class="nx">DM</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span> <span class="nx">testDate</span><span class="p">,</span> <span class="nx">endDate</span> <span class="p">)</span> <span class="p">){</span>
	        
          <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_diaryData</span><span class="p">[</span> <span class="nx">testZeroDay</span> <span class="p">]</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="p">){</span>
	          <span class="k">return</span> <span class="nx">testZeroDay</span><span class="p">;</span>
	        <span class="p">}</span>
	        <span class="nx">testDate</span> <span class="o">=</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span> <span class="nx">testDate</span><span class="p">,</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">DAY</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
	        <span class="nx">testZeroDay</span> <span class="o">=</span> <span class="nx">testDate</span><span class="p">.</span><span class="nx">setHours</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
	      <span class="p">}</span>
	      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
	    
	    <span class="p">},</span>
	    
	    
	    <span class="cm">/**</span>
<span class="cm">	     * @method _getDay</span>
<span class="cm">	     * @description Returns a Date object with times set to 0</span>
<span class="cm">	     * @param  date {Date}</span>
<span class="cm">	     * @return {Date}</span>
<span class="cm">	     * @private</span>
<span class="cm">	     */</span>
	    <span class="nx">_getDay</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">date</span> <span class="p">){</span>
	    
	      <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">(),</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
	    
	    <span class="p">},</span>
	    
	    
	    <span class="cm">/**</span>
<span class="cm">	     * @method _getEndOfDay</span>
<span class="cm">	     * @description Returns a Date object with times set to 23:59:59</span>
<span class="cm">	     * @param date {Date}</span>
<span class="cm">	     * @return {Date}</span>
<span class="cm">	     * @private</span>
<span class="cm">	     */</span>	    
	    <span class="nx">_getEndOfDay</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">date</span> <span class="p">){</span>
	      <span class="k">if</span><span class="p">(</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span> <span class="nx">date</span> <span class="p">)</span> <span class="p">){</span>
	        <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span> <span class="nx">date</span> <span class="p">).</span><span class="nx">setHours</span><span class="p">(</span> <span class="mi">23</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">0</span> <span class="p">);</span>
	      <span class="p">}</span>
	      <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">(),</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="p">,</span> <span class="mi">23</span> <span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>	    
	    <span class="p">},</span>
	    
	    <span class="cm">/**</span>
<span class="cm">	     * @method _sameDay</span>
<span class="cm">	     * @description Are date1 and date2 the same day?</span>
<span class="cm">	     * @param date1 {Date}</span>
<span class="cm">	     * @param date2 {Date}</span>
<span class="cm">	     * @return {Boolean}</span>
<span class="cm">	     * @private</span>
<span class="cm">	     */</span>
	    <span class="nx">_sameDay</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">date1</span><span class="p">,</span> <span class="nx">date2</span> <span class="p">){</span>
	      <span class="k">return</span> <span class="p">(</span> <span class="nx">date1</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">==</span> <span class="nx">date2</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">date1</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">==</span> <span class="nx">date2</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">date1</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">==</span> <span class="nx">date2</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="p">);</span>
	    
	    <span class="p">},</span>
	    
	    <span class="cm">/**</span>
<span class="cm">	     * @method _dataFailed</span>
<span class="cm">	     * @description Called if sendRequest fails on the data</span>
<span class="cm">	     * @method _dataFailed</span>
<span class="cm">	     * @param req {object}   Request object that failed</span>
<span class="cm">	     * @private</span>
<span class="cm">	     */</span>
	    <span class="nx">_dataFailed</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">req</span> <span class="p">){</span>

          <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Failed to get data&quot;</span> <span class="p">);</span>
          <span class="cm">/**</span>
<span class="cm">          * @event dataFailure</span>
<span class="cm">          * @description Fired when data has failed</span>
<span class="cm">          * @param oArgs.request  Request object from DataSource</span>
<span class="cm">          */</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span> <span class="s2">&quot;dataFailure&quot;</span> <span class="p">,</span> <span class="p">{</span> <span class="nx">request</span><span class="o">:</span> <span class="nx">req</span> <span class="p">}</span> <span class="p">);</span>

	    <span class="p">},</span>



	    
	    <span class="cm">/**</span>
<span class="cm">	     * @method _itemSorter</span>
<span class="cm">	     * @description Sorting function for arranging items in ascending date/time order</span>
<span class="cm">	     * @param oItem1 {DiaryItem}</span>
<span class="cm">	     * @param oItem2 {DiaryItem}</span>
<span class="cm">	     * @return {Boolean}        True if oItem2 is before oItem1</span>
<span class="cm">	     * @private</span>
<span class="cm">	     */</span>
	    <span class="nx">_itemSorter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">oItem1</span> <span class="p">,</span> <span class="nx">oItem2</span> <span class="p">){</span> 
	      <span class="k">return</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span> <span class="nx">oItem2</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTSTART&quot;</span> <span class="p">)</span> <span class="p">,</span> <span class="nx">oItem1</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;DTSTART&quot;</span> <span class="p">)</span> <span class="p">);</span>
	    <span class="p">},</span>
	    
	    <span class="cm">/**</span>
<span class="cm">	     * @method _rawItemSorter</span>
<span class="cm">	     * @description Sorting function for arranging items in ascending date/time order, using raw data objects</span>
<span class="cm">	     * @param oItem1 {Date}    Property DTSTART used for sorting</span>
<span class="cm">	     * @param oItem2 {Date}    Property DTSTART of comparison item for sort</span>
<span class="cm">	     * @return {Boolean}       True if oItem2 is before oItem1</span>
<span class="cm">	     * @private</span>
<span class="cm">	     */</span>	    
	    <span class="nx">_rawItemSorter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">oItem1</span><span class="p">,</span> <span class="nx">oItem2</span><span class="p">)</span> <span class="p">{</span> 
	      <span class="k">if</span> <span class="p">(</span><span class="nx">oItem1</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">oItem1</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
	        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
	      <span class="p">}</span>
	      <span class="k">if</span> <span class="p">(</span><span class="nx">oItem2</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">oItem2</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
	        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
	      <span class="p">}</span>
	      <span class="kd">var</span> <span class="nx">fieldMap</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;fieldMap&quot;</span><span class="p">);</span>
	      <span class="k">return</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span> <span class="nx">oItem2</span><span class="p">[</span><span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTSTART</span><span class="p">]</span> <span class="p">,</span> <span class="nx">oItem1</span><span class="p">[</span><span class="nx">fieldMap</span><span class="p">.</span><span class="nx">DTSTART</span><span class="p">]</span> <span class="p">);</span>
	    <span class="p">},</span>










      <span class="cm">/**</span>
<span class="cm">       *</span>
<span class="cm">       *</span>
<span class="cm">       *</span>
<span class="cm">       * render methods</span>
<span class="cm">       *</span>
<span class="cm">       *</span>
<span class="cm">       *</span>
<span class="cm">       *</span>
<span class="cm">       */</span>



      <span class="cm">/**</span>
<span class="cm">       * @method render</span>
<span class="cm">       * @description Renders the Diary.  Called after data is parsed - shouldn&#39;t</span>
<span class="cm">       * need to be called otherwise.</span>
<span class="cm">       * </span>
<span class="cm">       */</span>
      <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>

         <span class="k">this</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">CLASS_DIARY_CONTAINER</span><span class="p">);</span>
         
         <span class="k">this</span><span class="p">.</span><span class="nx">_renderDays</span><span class="p">();</span>
         
         <span class="k">this</span><span class="p">.</span><span class="nx">_renderNav</span><span class="p">();</span>
         
         <span class="k">this</span><span class="p">.</span><span class="nx">_renderTooltip</span><span class="p">();</span>
         
         <span class="cm">/**</span>
<span class="cm">          * @event render</span>
<span class="cm">          * @description When the rendering of the Diary is complete</span>
<span class="cm">          * @param oArgs.target  Diary</span>
<span class="cm">          */</span> 
         <span class="k">this</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span> <span class="s2">&quot;render&quot;</span> <span class="p">,</span> <span class="p">{</span> <span class="nx">target</span><span class="o">:</span> <span class="k">this</span> <span class="p">});</span>

      <span class="p">},</span>
      
      

      <span class="cm">/**</span>
<span class="cm">       * @method _renderNav</span>
<span class="cm">       * @description Renders the navigation. </span>
<span class="cm">       * Provides left, today, calendar and right buttons, and adds listeners.</span>
<span class="cm">       * @protected</span>
<span class="cm">       * </span>
<span class="cm">       */</span>      
      <span class="nx">_renderNav</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      
        <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">getNavContainer</span><span class="p">()</span> <span class="o">!==</span> <span class="kc">false</span> <span class="p">){</span>
          <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
      
        <span class="kd">var</span> <span class="nx">navContainer</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span>
            <span class="nx">titleContainer</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span>
            <span class="nx">calContainer</span><span class="p">,</span> <span class="nx">cal</span><span class="p">,</span> <span class="nx">calId</span><span class="p">,</span> <span class="nx">calShowButton</span><span class="p">,</span>
            <span class="nx">left</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s2">&quot;a&quot;</span> <span class="p">),</span>
            <span class="nx">right</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s2">&quot;a&quot;</span> <span class="p">),</span>
            <span class="nx">today</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s2">&quot;a&quot;</span> <span class="p">),</span>
            <span class="nx">dayLabels</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span>
            <span class="nx">labelEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">),</span>
            <span class="nx">thisLabel</span><span class="p">,</span>
            <span class="nx">dayCounter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">labelsAdded</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        
        
  
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span> <span class="nx">labelEl</span><span class="p">,</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">firstChild</span> <span class="p">);</span>
            
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">navContainer</span> <span class="p">,</span> <span class="nx">CLASS_DIARY_NAV</span> <span class="p">);</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">titleContainer</span> <span class="p">,</span> <span class="nx">CLASS_DIARY_TITLE</span><span class="p">);</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">left</span> <span class="p">,</span> <span class="nx">CLASS_DIARY_NAV_LEFT</span><span class="p">);</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">right</span> <span class="p">,</span> <span class="nx">CLASS_DIARY_NAV_RIGHT</span><span class="p">);</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">today</span> <span class="p">,</span> <span class="nx">CLASS_DIARY_NAV_TODAY</span><span class="p">);</span>
        
        <span class="nx">left</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;previous&quot;</span><span class="p">;</span>
        <span class="nx">right</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;next&quot;</span><span class="p">;</span>
        <span class="nx">today</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;today&quot;</span><span class="p">;</span>
        
        
        <span class="nx">navContainer</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">titleContainer</span> <span class="p">);</span>
        
        <span class="nx">navContainer</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">left</span> <span class="p">);</span>
        
        <span class="k">if</span><span class="p">(</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">Calendar</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;calenderNav&quot;</span><span class="p">)</span> <span class="p">){</span>
          <span class="nx">calContainer</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
          <span class="nx">calShowButton</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
          
          <span class="nx">calId</span> <span class="o">=</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">generateId</span><span class="p">();</span>
          <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">calContainer</span><span class="p">,</span> <span class="nx">CLASS_DIARY_NAV_CAL</span> <span class="p">);</span>
          <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">calShowButton</span><span class="p">,</span> <span class="nx">CLASS_DIARY_NAV_CALBUTTON</span><span class="p">);</span>
          <span class="nx">calShowButton</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span> <span class="s2">&quot;show calendar&quot;</span> <span class="p">)</span> <span class="p">);</span>
          <span class="nx">Ev</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span> <span class="nx">calShowButton</span> <span class="p">,</span> <span class="s2">&quot;click&quot;</span> <span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">showNavCalendar</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span> <span class="p">);</span>
          
          <span class="nx">calContainer</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">calId</span><span class="p">;</span>
          <span class="nx">navContainer</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">calShowButton</span> <span class="p">);</span>
          <span class="nx">navContainer</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">calContainer</span> <span class="p">);</span>

        <span class="p">}</span>
        
        <span class="nx">navContainer</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">today</span> <span class="p">);</span>
        <span class="nx">navContainer</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">right</span> <span class="p">);</span>
        
        
        
        <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">).</span><span class="nx">insertBefore</span><span class="p">(</span> <span class="nx">navContainer</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">).</span><span class="nx">firstChild</span> <span class="p">);</span>
      
      
        <span class="k">if</span><span class="p">(</span> <span class="nx">calId</span> <span class="o">!==</span> <span class="kc">null</span> <span class="p">){</span>
                    
          <span class="nx">cal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">Calendar</span><span class="p">(</span> <span class="s2">&quot;navcal&quot;</span> <span class="p">,</span> <span class="nx">calId</span><span class="p">,</span> <span class="p">{</span> <span class="nx">close</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">navigator</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}</span> <span class="p">);</span>
          
          <span class="nx">cal</span><span class="p">.</span><span class="nx">selectEvent</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_doCalNav</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span> <span class="p">);</span>
          <span class="nx">cal</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
          <span class="nx">cal</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>

          <span class="k">this</span><span class="p">.</span><span class="nx">_navCalendar</span> <span class="o">=</span> <span class="nx">cal</span><span class="p">;</span>
        <span class="p">}</span>
        
                    
            
        <span class="c1">// label for the date</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">dayLabels</span><span class="p">,</span> <span class="nx">CLASS_DIARY_COLLABEL_CONTAINER</span><span class="p">);</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">labelEl</span><span class="p">,</span> <span class="nx">CLASS_DIARY_COLLABEL</span><span class="p">);</span>
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="nx">labelEl</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span> <span class="p">,</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_colWidth</span> <span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span><span class="p">);</span>
        
        <span class="c1">// go through the days adding labels:</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">dayCounter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">dayCounter</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">;</span> <span class="nx">dayCounter</span> <span class="o">+=</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nx">thisLabel</span> <span class="o">=</span> <span class="nx">labelEl</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
            <span class="nx">dayLabels</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">thisLabel</span><span class="p">);</span>
        <span class="p">}</span>
        
        
        <span class="nx">navContainer</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">dayLabels</span><span class="p">);</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">_renderColumnLabels</span><span class="p">();</span>
      
        <span class="nx">Ev</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span> <span class="nx">left</span><span class="p">,</span> <span class="s2">&quot;click&quot;</span> <span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_doPrevious</span> <span class="p">,</span> <span class="k">this</span> <span class="p">,</span> <span class="kc">true</span> <span class="p">);</span>
        <span class="nx">Ev</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span> <span class="nx">right</span> <span class="p">,</span> <span class="s2">&quot;click&quot;</span> <span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_doNext</span> <span class="p">,</span> <span class="k">this</span> <span class="p">,</span> <span class="kc">true</span> <span class="p">);</span>
        <span class="nx">Ev</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span> <span class="nx">today</span><span class="p">,</span> <span class="s2">&quot;click&quot;</span> <span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_doFirstDayOfTodaysWeek</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kc">true</span> <span class="p">);</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">_renderTitle</span><span class="p">();</span>
      
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method _renderColumnLabels</span>
<span class="cm">       * @protected</span>
<span class="cm">       * @description Adds date labels to column headers</span>
<span class="cm">       */</span>
      <span class="nx">_renderColumnLabels</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      
        <span class="kd">var</span> <span class="nx">startDate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;startDate&quot;</span><span class="p">);</span>
        
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span>
            <span class="nx">CLASS_DIARY_COLLABEL</span><span class="p">,</span> 
            <span class="s2">&quot;span&quot;</span><span class="p">,</span> 
            <span class="k">this</span><span class="p">.</span><span class="nx">getNavContainer</span><span class="p">(),</span>
            <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">n</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">renderDateLabel</span><span class="p">(</span> <span class="nx">startDate</span> <span class="p">);</span>
              <span class="nx">startDate</span> <span class="o">=</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">startDate</span><span class="p">,</span> <span class="nx">DM</span><span class="p">.</span><span class="nx">DAY</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="k">this</span><span class="p">,</span> 
            <span class="kc">true</span>
        <span class="p">);</span>
                                   
      
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method getNavContainer</span>
<span class="cm">       * @description Returns the container for the navigation els</span>
<span class="cm">       * @return {HTMLElement}</span>
<span class="cm">       */</span>
      
      <span class="nx">getNavContainer</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">con</span> <span class="o">=</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span> <span class="nx">CLASS_DIARY_NAV</span><span class="p">,</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span> <span class="p">)</span> <span class="p">);</span>
        
        <span class="k">if</span><span class="p">(</span> <span class="nx">con</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">con</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">con</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span> <span class="p">){</span>
          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">con</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method showNavCalendar</span>
<span class="cm">       * @description Shows the calendar navigator</span>
<span class="cm">       * @param ev {Event}  Event object; used to position.  Pass an object</span>
<span class="cm">       * with ev.clientX and ev.clientY to position the Calendar manually.</span>
<span class="cm">       */</span>
      <span class="nx">showNavCalendar</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">cal</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_navCalendar</span><span class="p">;</span>
        
        <span class="nx">cal</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">ev</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">clientX</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">clientY</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">Dom</span><span class="p">.</span><span class="nx">setXY</span><span class="p">(</span> <span class="nx">cal</span><span class="p">.</span><span class="nx">oDomContainer</span><span class="p">,</span> <span class="p">[</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">clientX</span> <span class="o">-</span> <span class="mi">200</span><span class="p">,</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">clientY</span> <span class="p">]</span> <span class="p">);</span>
        <span class="p">}</span>
      <span class="p">},</span>
      
      <span class="cm">/**</span>
<span class="cm">       * @method _renderDays</span>
<span class="cm">       * @description Loops through starting at startdate to render days</span>
<span class="cm">       * @private</span>
<span class="cm">       */</span>
      <span class="nx">_renderDays</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">dayHeight</span><span class="p">,</span> <span class="nx">scrollTop</span><span class="p">;</span>
      

        <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;startDate&quot;</span><span class="p">).</span><span class="nx">getTime</span><span class="p">()</span> <span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;startDate&quot;</span><span class="p">).</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="mi">604800000</span> <span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">86400000</span> <span class="p">)</span> <span class="p">{</span>
        
          <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_diaryData</span><span class="p">[</span> <span class="nx">i</span> <span class="p">]</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span>
          
             <span class="k">this</span><span class="p">.</span><span class="nx">_diaryData</span><span class="p">[</span> <span class="nx">i</span> <span class="p">].</span><span class="nx">render</span><span class="p">();</span>
          
          <span class="p">}</span>
        
        <span class="p">}</span>
 
        <span class="c1">// set the style of the containers to get the height:</span>
        <span class="nx">dayHeight</span> <span class="o">=</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">).</span><span class="nx">endTime</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">).</span><span class="nx">startTime</span> <span class="p">)</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;pxPerHour&quot;</span><span class="p">);</span> 
        <span class="nx">Dom</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span> <span class="nx">CLASS_DIARYDAY_CONTAINER</span><span class="p">,</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_calHolder</span><span class="p">,</span> 
                                    <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">){</span><span class="nx">Dom</span><span class="p">.</span><span class="nx">setStyle</span><span class="p">(</span> <span class="nx">n</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span> <span class="p">,</span> <span class="nx">dayHeight</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span> <span class="p">);</span> <span class="p">}</span> <span class="p">);</span>

        <span class="nx">scrollTop</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">).</span><span class="nx">startTime</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;pxPerHour&quot;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_calHolder</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">scrollTop</span><span class="p">;</span> 
                       
      <span class="p">},</span>
      
      <span class="cm">/**</span>
<span class="cm">       * @method renderDateLabel</span>
<span class="cm">       * @description  Overwritable to render date labels at the top of each column.</span>
<span class="cm">       * Default is oDate.toString().substring(0, 10);</span>
<span class="cm">       * @param oDate {Date} Date object</span>
<span class="cm">       * @return {String}</span>
<span class="cm">       */</span>
      <span class="nx">renderDateLabel</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">oDate</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">oDate</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">substring</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span> <span class="p">);</span>
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method _renderTitle</span>
<span class="cm">       * @description  Puts the title text in the title container box</span>
<span class="cm">       * Doesn&#39;t actually produce the title string though.</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>
      <span class="nx">_renderTitle</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
         <span class="kd">var</span> <span class="nx">titleBox</span> <span class="o">=</span> <span class="nx">Dom</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="nx">CLASS_DIARY_TITLE</span><span class="p">,</span> <span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">getNavContainer</span><span class="p">()</span> <span class="p">);</span>
         <span class="nx">titleBox</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">renderTitle</span><span class="p">();</span>
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method renderTitle</span>
<span class="cm">       * @description  Overwriteable to render title string</span>
<span class="cm">       * Can use strftime identifiers in the format string</span>
<span class="cm">       * @param titleString {String}  Title string with strftime placeholders.</span>
<span class="cm">       * @return {String}</span>
<span class="cm">       */</span>
      <span class="nx">renderTitle</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">titleString</span> <span class="p">){</span>
      
         <span class="k">if</span><span class="p">(</span> <span class="nx">titleString</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span>
           <span class="nx">titleString</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span> <span class="s2">&quot;titleString&quot;</span> <span class="p">);</span>
         <span class="p">}</span>
         
         <span class="k">return</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nb">Date</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;startDate&quot;</span><span class="p">),</span> <span class="p">{</span> <span class="nx">format</span><span class="o">:</span> <span class="nx">titleString</span> <span class="p">}</span> <span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;locale&quot;</span><span class="p">)</span> <span class="p">);</span>
      
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method _renderTooltip</span>
<span class="cm">       * @description Renders tooltip for showing full info</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>
      <span class="nx">_renderTooltip</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
      
         <span class="k">if</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;tooltip&quot;</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">Tooltip</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="p">){</span>
         
           <span class="k">this</span><span class="p">.</span><span class="nx">_tooltip</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">Tooltip</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">)</span> <span class="p">),</span> <span class="p">{</span>
             <span class="nx">showDelay</span><span class="o">:</span> <span class="mi">300</span><span class="p">,</span>
             <span class="nx">hidedelay</span>  <span class="o">:</span> <span class="mi">500</span><span class="p">,</span>
             <span class="nx">disabled</span><span class="o">:</span> <span class="kc">true</span>
           <span class="p">});</span>
         
         <span class="p">}</span>
      
      <span class="p">},</span>
      

      
      <span class="cm">/**</span>
<span class="cm">       * @method addItemFilter</span>
<span class="cm">       * @description Filters DiaryItems based on css selector.</span>
<span class="cm">       * selector passed will be appended directly to &quot;.lplt-diary-item&quot;</span>
<span class="cm">       * If nothing is passed, it will filter for all (ie hide everything)</span>
<span class="cm">       * @param selector {String}</span>
<span class="cm">       * @return {Int}  Number of items hidden</span>
<span class="cm">       */</span>
      <span class="nx">addItemFilter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">){</span>
      
        <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="s2">&quot;Diary.addItemFilter&quot;</span> <span class="p">,</span> <span class="s2">&quot;info&quot;</span> <span class="p">);</span>        
       
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> 
        <span class="nx">items</span> <span class="o">=</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nx">CLASS_DIARY_ITEM</span> <span class="o">+</span> <span class="nx">selector</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">)</span> <span class="p">);</span>

        <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>
          <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">CLASS_DIARY_ITEM_HIDDEN</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_filters</span><span class="p">[</span> <span class="nx">selector</span> <span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        
        <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
      
      <span class="p">},</span>
      <span class="cm">/**</span>
<span class="cm">       * @method removeItemFilter</span>
<span class="cm">       * @description Removes filter on DiaryItems based on css selector.</span>
<span class="cm">       * selector passed will be appended directly to &quot;.lplt-diary-item&quot;</span>
<span class="cm">       * If nothing is passed, it will filter for all (ie show everything)</span>
<span class="cm">       * @param selector {String}</span>
<span class="cm">       * @return {Int} Number of items shown</span>
<span class="cm">       */</span>      
      <span class="nx">removeItemFilter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">){</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> 
        <span class="nx">items</span> <span class="o">=</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nx">CLASS_DIARY_ITEM</span> <span class="o">+</span> <span class="nx">selector</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">)</span> <span class="p">);</span>
        
        <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>
          <span class="nx">Dom</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span> <span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">CLASS_DIARY_ITEM_HIDDEN</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="c1">// remove this filter from memory.</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_filters</span><span class="p">[</span> <span class="nx">selector</span> <span class="p">]</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
        
        <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>      
      <span class="p">},</span>
      
      <span class="cm">/**</span>
<span class="cm">       * @method _applyFilters</span>
<span class="cm">       * @description  Re-applies all filters currently in place.</span>
<span class="cm">       * Called internally when navigating to keep existing filters in place</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>
      <span class="nx">_applyFilters</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span><span class="nx">filters</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_filters</span><span class="p">;</span>
        
        <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">filters</span> <span class="p">){</span>
          <span class="k">if</span><span class="p">(</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span> <span class="nx">i</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">filters</span><span class="p">[</span> <span class="nx">i</span> <span class="p">]</span> <span class="o">===</span> <span class="kc">true</span> <span class="p">){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">addItemFilter</span><span class="p">(</span> <span class="nx">i</span> <span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>
        
      <span class="p">},</span>

      <span class="cm">/**</span>
<span class="cm">       * @method _applyFiltersToElement</span>
<span class="cm">       * @description  Re-applies all filters to the element passed.</span>
<span class="cm">       * Called internally when navigating to keep existing filters in place.</span>
<span class="cm">       * @param HTMLElement</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>      
      <span class="nx">_applyFiltersToElement</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span>
            <span class="nx">filters</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_filters</span><span class="p">;</span>
        
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">filters</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span><span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">filters</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="kc">true</span> <span class="o">&amp;&amp;</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Selector</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">Dom</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">CLASS_DIARY_ITEM_HIDDEN</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>      
      <span class="p">},</span>




      <span class="cm">/**</span>
<span class="cm">       * @method destroy</span>
<span class="cm">       * @description destroys the Diary</span>
<span class="cm">       */</span>
      <span class="nx">destroy</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      
        <span class="k">this</span><span class="p">.</span><span class="nx">_destroyData</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_destroyDays</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_removeListeners</span><span class="p">();</span>
        
        <span class="c1">// other widgets:</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_tooltip</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">_tooltip</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">_tooltip</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_navCalendar</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">_navCalendar</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">_navCalendar</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span> <span class="nx">CLASS_DIARY_CONTAINER</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        
        <span class="cm">/**</span>
<span class="cm">         * @event destroy</span>
<span class="cm">         * @description When the Diary has finished destorying</span>
<span class="cm">         */</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span><span class="s2">&quot;destroy&quot;</span><span class="p">);</span>
      
      <span class="p">},</span>


      <span class="cm">/**</span>
<span class="cm">       * @method _destroyData</span>
<span class="cm">       * @description  Clears out existing data</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>
      <span class="nx">_destroyData</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
      
        <span class="kd">var</span> <span class="nx">i</span><span class="p">;</span>
        
        <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_diaryData</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">_diaryData</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">destroy</span><span class="p">();</span>
        <span class="p">}</span>
        
        <span class="k">for</span><span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_itemHash</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">){</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">_itemHash</span><span class="p">[</span> <span class="nx">i</span> <span class="p">].</span><span class="nx">destroy</span><span class="p">();</span>
        <span class="p">}</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">_itemHash</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_diaryData</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_colToDayMap</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="cm">/**</span>
<span class="cm">         * @event destroyData</span>
<span class="cm">         * @description After all the data has been destroyed.</span>
<span class="cm">         */</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fireEvent</span><span class="p">(</span> <span class="s2">&quot;destroyData&quot;</span> <span class="p">);</span>

      
      <span class="p">},</span>
      
      <span class="cm">/**</span>
<span class="cm">       * @method _destroyDays</span>
<span class="cm">       * @description  Destroys the days rendered in the diary</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>
      <span class="nx">_destroyDays</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="c1">//Ev.purgeListeners( this._calHolder );</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">).</span><span class="nx">removeChild</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">_calHolder</span> <span class="p">);</span>
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">       * @method _removeListeners</span>
<span class="cm">       * @description Removes event listeners</span>
<span class="cm">       * @protected</span>
<span class="cm">       */</span>
      <span class="nx">_removeListeners</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      
        <span class="c1">// listeners on the main element (delegated)</span>
        <span class="nx">Ev</span><span class="p">.</span><span class="nx">purgeElement</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">),</span> <span class="kc">false</span><span class="p">);</span>
        <span class="c1">// navigation event listeners (recurse: not too deep and need to pick up</span>
        <span class="c1">// all the nav buttons</span>
        <span class="nx">Ev</span><span class="p">.</span><span class="nx">purgeElement</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getNavContainer</span><span class="p">(),</span> <span class="kc">true</span><span class="p">);</span>
        
      
      <span class="p">},</span>
      
      
      <span class="cm">/**</span>
<span class="cm">      * Returns a string representation of the object.</span>
<span class="cm">      * @method toString</span>
<span class="cm">      * @return {String} The string representation of the Diary</span>
<span class="cm">      * @private</span>
<span class="cm">      */</span>      
      <span class="nx">toString</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">&quot;Diary &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">).</span><span class="nx">id</span><span class="p">;</span>
      <span class="p">}</span>
      
      




        <span class="cm">/**</span>
<span class="cm">         * @event itemBeforeStartMove</span>
<span class="cm">         * @description Fired before everything starts moving.  Return false to cancel move.</span>
<span class="cm">         * @param oArgs.item   DiaryItem that&#39;s about to be moved.</span>
<span class="cm">         */</span>  
        <span class="cm">/**</span>
<span class="cm">         * @event itemBeforeEndMove</span>
<span class="cm">         * @description fired when an item is moved or resized (ie the times change).</span>
<span class="cm">         * Return false to cancel the resize/move</span>
<span class="cm">         * @param oArgs.from   Object literal containing original DTSTART and DTEND</span>
<span class="cm">         * @param oArgs.to     Object literal containing final DTSTART and DTEND</span>
<span class="cm">         * @param oArgs.item   DiaryItem that&#39;s being moved</span>
<span class="cm">         * @param oArgs.originEvent    Original event from resize/dragdrop passed through.</span>
<span class="cm">         */</span>

        <span class="cm">/**</span>
<span class="cm">         * @event itemEndMove</span>
<span class="cm">         * @description fired when an item is moved or resized (ie the times change)</span>
<span class="cm">         * @param oArgs.from   Object literal containing original DTSTART and DTEND</span>
<span class="cm">         * @param oArgs.to     Object literal containing final DTSTART and DTEND</span>
<span class="cm">         * @param oArgs.item   DiaryItem that&#39;s being moved</span>
<span class="cm">         * @param oArgs.originEvent    Original event from resize/dragdrop passed through.</span>
<span class="cm">         */</span>
  <span class="p">});</span>
  
  
  <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">Diary</span> <span class="o">=</span> <span class="nx">Diary</span><span class="p">;</span>
      
      
<span class="p">})();</span>
<span class="nx">YAHOO</span><span class="p">.</span><span class="nx">namespace</span><span class="p">(</span> <span class="s2">&quot;widget&quot;</span> <span class="p">);</span>
<span class="nx">YAHOO</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;diary&quot;</span><span class="p">,</span> <span class="nx">YAHOO</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">Diary</span><span class="p">,</span> <span class="p">{</span><span class="nx">version</span><span class="o">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span> <span class="nx">build</span><span class="o">:</span> <span class="s2">&quot;008&quot;</span><span class="p">});</span>
</pre></div>
                    </div>
			</div>
		</div>
		<div class="yui-b">
            <div class="nav">

                    <div id="moduleList" class="module">
                        <h4>Modules</h4>
                        <ul class="content">
                                <li class="selected"><a href="module_diary.html" title="diary">diary</a></li>
                        </ul>
                    </div>

                    <div id="classList" class="module">
                        <h4>Classes</h4>
                        <ul class="content">
                                <li class=""><a href="DiaryBlock.html" title="DiaryBlock">DiaryBlock</a></li>
                                <li class=""><a href="DiaryDay.html" title="DiaryDay">DiaryDay</a></li>
                                <li class=""><a href="DiaryItem.html" title="DiaryItem">DiaryItem</a></li>
                                <li class=""><a href="YAHOO.widget.Diary.html" title="YAHOO.widget.Diary">YAHOO.widget.Diary</a></li>
                        </ul>
                    </div>

                    <div id="fileList" class="module">
                        <h4>Files</h4>
                        <ul class="content">        
                                <li class="selected"><a href="Diary.js.html" title="Diary.js">Diary.js</a></li>
                        </ul>
                    </div>





            </div>
		</div>
	</div>
	<div id="ft">
        <hr />
        Copyright &copy; 2010 Yahoo! Inc. All rights reserved.
	</div>
</div>
<script type="text/javascript">
    ALL_YUI_PROPS = [{"url": "DiaryBlock.html#method_addItem", "access": "", "host": "DiaryBlock", "type": "method", "name": "addItem"}, {"url": "DiaryDay.html#method_addItem", "access": "", "host": "DiaryDay", "type": "method", "name": "addItem"}, {"url": "YAHOO.widget.Diary.html#method_addItem", "access": "", "host": "YAHOO.widget.Diary", "type": "method", "name": "addItem"}, {"url": "YAHOO.widget.Diary.html#method_addItemFilter", "access": "", "host": "YAHOO.widget.Diary", "type": "method", "name": "addItemFilter"}, {"url": "DiaryDay.html#method__addItemToBlock", "access": "protected", "host": "DiaryDay", "type": "method", "name": "_addItemToBlock"}, {"url": "DiaryItem.html#method_addMultiDayChild", "access": "", "host": "DiaryItem", "type": "method", "name": "addMultiDayChild"}, {"url": "YAHOO.widget.Diary.html#config_allowCreateMultiDayItems", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "allowCreateMultiDayItems"}, {"url": "YAHOO.widget.Diary.html#event_allowCreateMultiDayItemsChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "allowCreateMultiDayItemsChange"}, {"url": "DiaryItem.html#property_anim", "access": "", "host": "DiaryItem", "type": "property", "name": "anim"}, {"url": "YAHOO.widget.Diary.html#config_animate", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "animate"}, {"url": "YAHOO.widget.Diary.html#event_animateChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "animateChange"}, {"url": "YAHOO.widget.Diary.html#method__applyFilters", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_applyFilters"}, {"url": "YAHOO.widget.Diary.html#method__applyFiltersToElement", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_applyFiltersToElement"}, {"url": "DiaryItem.html#config_backClass", "access": "", "host": "DiaryItem", "type": "config", "name": "backClass"}, {"url": "DiaryItem.html#event_backClassChange", "access": "", "host": "DiaryItem", "type": "event", "name": "backClassChange"}, {"url": "YAHOO.widget.Diary.html#event_beforeAddItem", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeAddItem"}, {"url": "YAHOO.widget.Diary.html#event_beforeAllowCreateMultiDayItemsChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeAllowCreateMultiDayItemsChange"}, {"url": "YAHOO.widget.Diary.html#event_beforeAnimateChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeAnimateChange"}, {"url": "DiaryItem.html#event_beforeBackClassChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeBackClassChange"}, {"url": "YAHOO.widget.Diary.html#event_beforeCalenderNavChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeCalenderNavChange"}, {"url": "DiaryItem.html#event_beforeCATEGORIESChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeCATEGORIESChange"}, {"url": "DiaryDay.html#event_beforeColdateChange", "access": "", "host": "DiaryDay", "type": "event", "name": "beforeColdateChange"}, {"url": "DiaryItem.html#event_beforeColumnChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeColumnChange"}, {"url": "DiaryItem.html#event_beforeDESCRIPTIONChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeDESCRIPTIONChange"}, {"url": "DiaryItem.html#event_beforeDetailClassChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeDetailClassChange"}, {"url": "DiaryDay.html#event_beforeDiaryChange", "access": "", "host": "DiaryDay", "type": "event", "name": "beforeDiaryChange"}, {"url": "YAHOO.widget.Diary.html#event_beforeDisplayChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeDisplayChange"}, {"url": "DiaryItem.html#event_before_displayDTENDChange", "access": "", "host": "DiaryItem", "type": "event", "name": "before_displayDTENDChange"}, {"url": "DiaryItem.html#event_before_displayDTSTARTChange", "access": "", "host": "DiaryItem", "type": "event", "name": "before_displayDTSTARTChange"}, {"url": "DiaryItem.html#event_beforeDTENDChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeDTENDChange"}, {"url": "DiaryItem.html#event_beforeDTSTARTChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeDTSTARTChange"}, {"url": "YAHOO.widget.Diary.html#event_beforeEndDateChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeEndDateChange"}, {"url": "YAHOO.widget.Diary.html#event_beforeFieldMapChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeFieldMapChange"}, {"url": "YAHOO.widget.Diary.html#event_beforeItemClickCreateNewChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeItemClickCreateNewChange"}, {"url": "DiaryItem.html#event_beforeLOCATIONChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeLOCATIONChange"}, {"url": "DiaryItem.html#event_beforeMultiDayParentChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeMultiDayParentChange"}, {"url": "DiaryItem.html#event_beforeMultiDayPositionChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeMultiDayPositionChange"}, {"url": "DiaryItem.html#event_beforePxPerHourChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforePxPerHourChange"}, {"url": "YAHOO.widget.Diary.html#event_beforePxPerHourChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforePxPerHourChange"}, {"url": "YAHOO.widget.Diary.html#event_beforeReDo", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeReDo"}, {"url": "YAHOO.widget.Diary.html#event_beforeScaleColumnsChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeScaleColumnsChange"}, {"url": "YAHOO.widget.Diary.html#event_beforeStartDateChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeStartDateChange"}, {"url": "DiaryItem.html#event_beforeSUMMARYChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeSUMMARYChange"}, {"url": "YAHOO.widget.Diary.html#event_beforeTitleStringChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeTitleStringChange"}, {"url": "YAHOO.widget.Diary.html#event_beforeTooltipChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeTooltipChange"}, {"url": "DiaryItem.html#event_beforeUIDChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeUIDChange"}, {"url": "DiaryItem.html#event_beforeURLChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeURLChange"}, {"url": "DiaryItem.html#event_beforeUseAnimationChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeUseAnimationChange"}, {"url": "DiaryItem.html#event_beforeUseCssCategoriesChange", "access": "", "host": "DiaryItem", "type": "event", "name": "beforeUseCssCategoriesChange"}, {"url": "YAHOO.widget.Diary.html#event_beforeUseCssCategoriesChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeUseCssCategoriesChange"}, {"url": "DiaryDay.html#event_beforeWidthChange", "access": "", "host": "DiaryDay", "type": "event", "name": "beforeWidthChange"}, {"url": "YAHOO.widget.Diary.html#event_beforeWidthChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "beforeWidthChange"}, {"url": "DiaryDay.html#property__blocks", "access": "protected", "host": "DiaryDay", "type": "property", "name": "_blocks"}, {"url": "DiaryItem.html#method_calcEndFromPosition", "access": "", "host": "DiaryItem", "type": "method", "name": "calcEndFromPosition"}, {"url": "DiaryItem.html#method_calcStartFromPosition", "access": "", "host": "DiaryItem", "type": "method", "name": "calcStartFromPosition"}, {"url": "DiaryItem.html#method_calculateHeight", "access": "", "host": "DiaryItem", "type": "method", "name": "calculateHeight"}, {"url": "DiaryItem.html#method_calculateTop", "access": "", "host": "DiaryItem", "type": "method", "name": "calculateTop"}, {"url": "YAHOO.widget.Diary.html#config_calenderNav", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "calenderNav"}, {"url": "YAHOO.widget.Diary.html#event_calenderNavChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "calenderNavChange"}, {"url": "DiaryItem.html#config_CATEGORIES", "access": "", "host": "DiaryItem", "type": "config", "name": "CATEGORIES"}, {"url": "DiaryItem.html#event_CATEGORIESChange", "access": "", "host": "DiaryItem", "type": "event", "name": "CATEGORIESChange"}, {"url": "DiaryDay.html#config_coldate", "access": "", "host": "DiaryDay", "type": "config", "name": "coldate"}, {"url": "DiaryDay.html#event_coldateChange", "access": "", "host": "DiaryDay", "type": "event", "name": "coldateChange"}, {"url": "YAHOO.widget.Diary.html#property__colToDayMap", "access": "protected", "host": "YAHOO.widget.Diary", "type": "property", "name": "_colToDayMap"}, {"url": "DiaryItem.html#config_column", "access": "", "host": "DiaryItem", "type": "config", "name": "column"}, {"url": "DiaryItem.html#event_columnChange", "access": "", "host": "DiaryItem", "type": "event", "name": "columnChange"}, {"url": "YAHOO.widget.Diary.html#property__colWidth", "access": "protected", "host": "YAHOO.widget.Diary", "type": "property", "name": "_colWidth"}, {"url": "DiaryBlock.html#method_contains", "access": "", "host": "DiaryBlock", "type": "method", "name": "contains"}, {"url": "DiaryDay.html#property__dataEl", "access": "protected", "host": "DiaryDay", "type": "property", "name": "_dataEl"}, {"url": "YAHOO.widget.Diary.html#event_dataFailure", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "dataFailure"}, {"url": "DiaryItem.html#config_DESCRIPTION", "access": "", "host": "DiaryItem", "type": "config", "name": "DESCRIPTION"}, {"url": "DiaryItem.html#event_DESCRIPTIONChange", "access": "", "host": "DiaryItem", "type": "event", "name": "DESCRIPTIONChange"}, {"url": "DiaryItem.html#method_destroy", "access": "", "host": "DiaryItem", "type": "method", "name": "destroy"}, {"url": "DiaryItem.html#event_destroy", "access": "", "host": "DiaryItem", "type": "event", "name": "destroy"}, {"url": "DiaryBlock.html#method_destroy", "access": "", "host": "DiaryBlock", "type": "method", "name": "destroy"}, {"url": "DiaryDay.html#method_destroy", "access": "", "host": "DiaryDay", "type": "method", "name": "destroy"}, {"url": "YAHOO.widget.Diary.html#method_destroy", "access": "", "host": "YAHOO.widget.Diary", "type": "method", "name": "destroy"}, {"url": "YAHOO.widget.Diary.html#event_destroy", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "destroy"}, {"url": "YAHOO.widget.Diary.html#method__destroyData", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_destroyData"}, {"url": "YAHOO.widget.Diary.html#event_destroyData", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "destroyData"}, {"url": "YAHOO.widget.Diary.html#method__destroyDays", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_destroyDays"}, {"url": "DiaryItem.html#config_detailClass", "access": "", "host": "DiaryItem", "type": "config", "name": "detailClass"}, {"url": "DiaryItem.html#event_detailClassChange", "access": "", "host": "DiaryItem", "type": "event", "name": "detailClassChange"}, {"url": "DiaryDay.html#config_diary", "access": "", "host": "DiaryDay", "type": "config", "name": "diary"}, {"url": "DiaryDay.html#event_diaryChange", "access": "", "host": "DiaryDay", "type": "event", "name": "diaryChange"}, {"url": "YAHOO.widget.Diary.html#property__diaryData", "access": "protected", "host": "YAHOO.widget.Diary", "type": "property", "name": "_diaryData"}, {"url": "YAHOO.widget.Diary.html#config_display", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "display"}, {"url": "YAHOO.widget.Diary.html#event_displayChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "displayChange"}, {"url": "DiaryItem.html#event__displayDTENDChange", "access": "", "host": "DiaryItem", "type": "event", "name": "_displayDTENDChange"}, {"url": "DiaryItem.html#event__displayDTSTARTChange", "access": "", "host": "DiaryItem", "type": "event", "name": "_displayDTSTARTChange"}, {"url": "YAHOO.widget.Diary.html#method__doCalNav", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_doCalNav"}, {"url": "YAHOO.widget.Diary.html#method__doFirstDayOfTodaysWeek", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_doFirstDayOfTodaysWeek"}, {"url": "YAHOO.widget.Diary.html#method__doNext", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_doNext"}, {"url": "YAHOO.widget.Diary.html#method__doPrevious", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_doPrevious"}, {"url": "DiaryItem.html#property_dragdrop", "access": "", "host": "DiaryItem", "type": "property", "name": "dragdrop"}, {"url": "YAHOO.widget.Diary.html#property__ds", "access": "protected", "host": "YAHOO.widget.Diary", "type": "property", "name": "_ds"}, {"url": "DiaryItem.html#config_DTEND", "access": "", "host": "DiaryItem", "type": "config", "name": "DTEND"}, {"url": "DiaryItem.html#event_DTENDChange", "access": "", "host": "DiaryItem", "type": "event", "name": "DTENDChange"}, {"url": "DiaryItem.html#config_DTSTART", "access": "", "host": "DiaryItem", "type": "config", "name": "DTSTART"}, {"url": "DiaryItem.html#event_DTSTARTChange", "access": "", "host": "DiaryItem", "type": "event", "name": "DTSTARTChange"}, {"url": "YAHOO.widget.Diary.html#config_endDate", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "endDate"}, {"url": "YAHOO.widget.Diary.html#event_endDateChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "endDateChange"}, {"url": "DiaryBlock.html#property__endSecs", "access": "protected", "host": "DiaryBlock", "type": "property", "name": "_endSecs"}, {"url": "YAHOO.widget.Diary.html#method__endSelector", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_endSelector"}, {"url": "YAHOO.widget.Diary.html#config_fieldMap", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "fieldMap"}, {"url": "YAHOO.widget.Diary.html#event_fieldMapChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "fieldMapChange"}, {"url": "YAHOO.widget.Diary.html#property__filters", "access": "protected", "host": "YAHOO.widget.Diary", "type": "property", "name": "_filters"}, {"url": "DiaryBlock.html#method__findLineForItem", "access": "protected", "host": "DiaryBlock", "type": "method", "name": "_findLineForItem"}, {"url": "YAHOO.widget.Diary.html#method__getData", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_getData"}, {"url": "DiaryItem.html#method_getDiary", "access": "", "host": "DiaryItem", "type": "method", "name": "getDiary"}, {"url": "YAHOO.widget.Diary.html#method_getDiaryDay", "access": "", "host": "YAHOO.widget.Diary", "type": "method", "name": "getDiaryDay"}, {"url": "DiaryItem.html#method_getDisplayEndTimeSecs", "access": "protected", "host": "DiaryItem", "type": "method", "name": "getDisplayEndTimeSecs"}, {"url": "DiaryItem.html#method_getDisplayStartTimeSecs", "access": "protected", "host": "DiaryItem", "type": "method", "name": "getDisplayStartTimeSecs"}, {"url": "DiaryItem.html#method_getEndTimeSecs", "access": "", "host": "DiaryItem", "type": "method", "name": "getEndTimeSecs"}, {"url": "YAHOO.widget.Diary.html#method_getItem", "access": "", "host": "YAHOO.widget.Diary", "type": "method", "name": "getItem"}, {"url": "YAHOO.widget.Diary.html#method_getNavContainer", "access": "", "host": "YAHOO.widget.Diary", "type": "method", "name": "getNavContainer"}, {"url": "DiaryItem.html#method_getParentItem", "access": "", "host": "DiaryItem", "type": "method", "name": "getParentItem"}, {"url": "DiaryItem.html#method_getStartTimeDay", "access": "", "host": "DiaryItem", "type": "method", "name": "getStartTimeDay"}, {"url": "DiaryItem.html#method_getStartTimeSecs", "access": "", "host": "DiaryItem", "type": "method", "name": "getStartTimeSecs"}, {"url": "DiaryItem.html#method__handleBeforeStartDrag", "access": "protected", "host": "DiaryItem", "type": "method", "name": "_handleBeforeStartDrag"}, {"url": "DiaryItem.html#method__handleDiaryDragEnter", "access": "protected", "host": "DiaryItem", "type": "method", "name": "_handleDiaryDragEnter"}, {"url": "DiaryItem.html#method__handleDiaryDragOver", "access": "protected", "host": "DiaryItem", "type": "method", "name": "_handleDiaryDragOver"}, {"url": "DiaryItem.html#method__handleDiaryEndDrag", "access": "protected", "host": "DiaryItem", "type": "method", "name": "_handleDiaryEndDrag"}, {"url": "DiaryItem.html#method__handleDiaryStartDrag", "access": "protected", "host": "DiaryItem", "type": "method", "name": "_handleDiaryStartDrag"}, {"url": "YAHOO.widget.Diary.html#method_handleItemClick", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "handleItemClick"}, {"url": "YAHOO.widget.Diary.html#method_handleItemMouseEnter", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "handleItemMouseEnter"}, {"url": "DiaryBlock.html#method_init", "access": "protected", "host": "DiaryBlock", "type": "method", "name": "init"}, {"url": "DiaryItem.html#method_initContent", "access": "protected", "host": "DiaryItem", "type": "method", "name": "initContent"}, {"url": "YAHOO.widget.Diary.html#method_initData", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "initData"}, {"url": "DiaryItem.html#method_initListeners", "access": "protected", "host": "DiaryItem", "type": "method", "name": "initListeners"}, {"url": "YAHOO.widget.Diary.html#method_initListeners", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "initListeners"}, {"url": "YAHOO.widget.Diary.html#event_itemBeforeEndCreate", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "itemBeforeEndCreate"}, {"url": "DiaryItem.html#event_itemBeforeEndMove", "access": "", "host": "DiaryItem", "type": "event", "name": "itemBeforeEndMove"}, {"url": "YAHOO.widget.Diary.html#event_itemBeforeEndMove", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "itemBeforeEndMove"}, {"url": "YAHOO.widget.Diary.html#event_itemBeforeStartCreate", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "itemBeforeStartCreate"}, {"url": "DiaryItem.html#event_itemBeforeStartMove", "access": "", "host": "DiaryItem", "type": "event", "name": "itemBeforeStartMove"}, {"url": "YAHOO.widget.Diary.html#event_itemBeforeStartMove", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "itemBeforeStartMove"}, {"url": "YAHOO.widget.Diary.html#event_itemClick", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "itemClick"}, {"url": "YAHOO.widget.Diary.html#config_itemClickCreateNew", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "itemClickCreateNew"}, {"url": "YAHOO.widget.Diary.html#event_itemClickCreateNewChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "itemClickCreateNewChange"}, {"url": "YAHOO.widget.Diary.html#event_itemEndCreate", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "itemEndCreate"}, {"url": "DiaryItem.html#event_itemEndMove", "access": "", "host": "DiaryItem", "type": "event", "name": "itemEndMove"}, {"url": "YAHOO.widget.Diary.html#event_itemEndMove", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "itemEndMove"}, {"url": "YAHOO.widget.Diary.html#property__itemHash", "access": "protected", "host": "YAHOO.widget.Diary", "type": "property", "name": "_itemHash"}, {"url": "YAHOO.widget.Diary.html#event_itemMouseEnter", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "itemMouseEnter"}, {"url": "DiaryBlock.html#property__items", "access": "protected", "host": "DiaryBlock", "type": "property", "name": "_items"}, {"url": "DiaryBlock.html#property__lines", "access": "protected", "host": "DiaryBlock", "type": "property", "name": "_lines"}, {"url": "DiaryItem.html#config_LOCATION", "access": "", "host": "DiaryItem", "type": "config", "name": "LOCATION"}, {"url": "DiaryItem.html#event_LOCATIONChange", "access": "", "host": "DiaryItem", "type": "event", "name": "LOCATIONChange"}, {"url": "DiaryItem.html#event_multiDayParentChange", "access": "", "host": "DiaryItem", "type": "event", "name": "multiDayParentChange"}, {"url": "DiaryItem.html#event_multiDayPositionChange", "access": "", "host": "DiaryItem", "type": "event", "name": "multiDayPositionChange"}, {"url": "YAHOO.widget.Diary.html#property__navCalendar", "access": "protected", "host": "YAHOO.widget.Diary", "type": "property", "name": "_navCalendar"}, {"url": "DiaryDay.html#method_next", "access": "", "host": "DiaryDay", "type": "method", "name": "next"}, {"url": "YAHOO.widget.Diary.html#method__parseData", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_parseData"}, {"url": "YAHOO.widget.Diary.html#event_parseData", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "parseData"}, {"url": "DiaryDay.html#method_previous", "access": "", "host": "DiaryDay", "type": "method", "name": "previous"}, {"url": "DiaryItem.html#config_pxPerHour", "access": "", "host": "DiaryItem", "type": "config", "name": "pxPerHour"}, {"url": "YAHOO.widget.Diary.html#config_pxPerHour", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "pxPerHour"}, {"url": "DiaryItem.html#event_pxPerHourChange", "access": "", "host": "DiaryItem", "type": "event", "name": "pxPerHourChange"}, {"url": "YAHOO.widget.Diary.html#event_pxPerHourChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "pxPerHourChange"}, {"url": "DiaryDay.html#method__rebuildBlocks", "access": "protected", "host": "DiaryDay", "type": "method", "name": "_rebuildBlocks"}, {"url": "YAHOO.widget.Diary.html#method__reDo", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_reDo"}, {"url": "DiaryBlock.html#method_removeItem", "access": "", "host": "DiaryBlock", "type": "method", "name": "removeItem"}, {"url": "YAHOO.widget.Diary.html#method_removeItemFilter", "access": "", "host": "YAHOO.widget.Diary", "type": "method", "name": "removeItemFilter"}, {"url": "DiaryDay.html#method_removeItemFromBlock", "access": "", "host": "DiaryDay", "type": "method", "name": "removeItemFromBlock"}, {"url": "YAHOO.widget.Diary.html#method__removeListeners", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_removeListeners"}, {"url": "DiaryItem.html#method_render", "access": "", "host": "DiaryItem", "type": "method", "name": "render"}, {"url": "DiaryBlock.html#method_render", "access": "", "host": "DiaryBlock", "type": "method", "name": "render"}, {"url": "DiaryDay.html#method_render", "access": "", "host": "DiaryDay", "type": "method", "name": "render"}, {"url": "YAHOO.widget.Diary.html#method_render", "access": "", "host": "YAHOO.widget.Diary", "type": "method", "name": "render"}, {"url": "YAHOO.widget.Diary.html#event_render", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "render"}, {"url": "DiaryDay.html#method__renderBlocks", "access": "protected", "host": "DiaryDay", "type": "method", "name": "_renderBlocks"}, {"url": "DiaryDay.html#method__renderColumn", "access": "protected", "host": "DiaryDay", "type": "method", "name": "_renderColumn"}, {"url": "YAHOO.widget.Diary.html#method__renderColumnLabels", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_renderColumnLabels"}, {"url": "YAHOO.widget.Diary.html#method_renderDateLabel", "access": "", "host": "YAHOO.widget.Diary", "type": "method", "name": "renderDateLabel"}, {"url": "DiaryItem.html#method_renderDetails", "access": "", "host": "DiaryItem", "type": "method", "name": "renderDetails"}, {"url": "DiaryItem.html#method_renderEndTime", "access": "", "host": "DiaryItem", "type": "method", "name": "renderEndTime"}, {"url": "DiaryItem.html#method_renderFullDetails", "access": "", "host": "DiaryItem", "type": "method", "name": "renderFullDetails"}, {"url": "YAHOO.widget.Diary.html#method__renderNav", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_renderNav"}, {"url": "DiaryItem.html#method_renderStartTime", "access": "", "host": "DiaryItem", "type": "method", "name": "renderStartTime"}, {"url": "YAHOO.widget.Diary.html#method__renderTitle", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_renderTitle"}, {"url": "YAHOO.widget.Diary.html#method_renderTitle", "access": "", "host": "YAHOO.widget.Diary", "type": "method", "name": "renderTitle"}, {"url": "YAHOO.widget.Diary.html#method__renderTooltip", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_renderTooltip"}, {"url": "YAHOO.widget.Diary.html#method__resizeSelectorDiv", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_resizeSelectorDiv"}, {"url": "YAHOO.widget.Diary.html#config_scaleColumns", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "scaleColumns"}, {"url": "YAHOO.widget.Diary.html#event_scaleColumnsChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "scaleColumnsChange"}, {"url": "YAHOO.widget.Diary.html#property__selector", "access": "protected", "host": "YAHOO.widget.Diary", "type": "property", "name": "_selector"}, {"url": "DiaryItem.html#method_setEndTimeDay", "access": "", "host": "DiaryItem", "type": "method", "name": "setEndTimeDay"}, {"url": "DiaryItem.html#method_setEndTimeSecs", "access": "", "host": "DiaryItem", "type": "method", "name": "setEndTimeSecs"}, {"url": "DiaryItem.html#method_setLine", "access": "", "host": "DiaryItem", "type": "method", "name": "setLine"}, {"url": "DiaryItem.html#method_setStartTimeDay", "access": "", "host": "DiaryItem", "type": "method", "name": "setStartTimeDay"}, {"url": "DiaryItem.html#method_setStartTimeSecs", "access": "", "host": "DiaryItem", "type": "method", "name": "setStartTimeSecs"}, {"url": "YAHOO.widget.Diary.html#method_setupDays", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "setupDays"}, {"url": "YAHOO.widget.Diary.html#method_showNavCalendar", "access": "", "host": "YAHOO.widget.Diary", "type": "method", "name": "showNavCalendar"}, {"url": "YAHOO.widget.Diary.html#config_startDate", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "startDate"}, {"url": "YAHOO.widget.Diary.html#event_startDateChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "startDateChange"}, {"url": "YAHOO.widget.Diary.html#method__startNewItem", "access": "protected", "host": "YAHOO.widget.Diary", "type": "method", "name": "_startNewItem"}, {"url": "DiaryBlock.html#property__startSecs", "access": "protected", "host": "DiaryBlock", "type": "property", "name": "_startSecs"}, {"url": "DiaryItem.html#config_SUMMARY", "access": "", "host": "DiaryItem", "type": "config", "name": "SUMMARY"}, {"url": "DiaryItem.html#event_SUMMARYChange", "access": "", "host": "DiaryItem", "type": "event", "name": "SUMMARYChange"}, {"url": "DiaryItem.html#property_TIME_SEPARATOR", "access": "", "host": "DiaryItem", "type": "property", "name": "TIME_SEPARATOR"}, {"url": "YAHOO.widget.Diary.html#config_titleString", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "titleString"}, {"url": "YAHOO.widget.Diary.html#event_titleStringChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "titleStringChange"}, {"url": "YAHOO.widget.Diary.html#property__tooltip", "access": "protected", "host": "YAHOO.widget.Diary", "type": "property", "name": "_tooltip"}, {"url": "YAHOO.widget.Diary.html#config_tooltip", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "tooltip"}, {"url": "YAHOO.widget.Diary.html#event_tooltipChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "tooltipChange"}, {"url": "DiaryBlock.html#method_toString", "access": "", "host": "DiaryBlock", "type": "method", "name": "toString"}, {"url": "DiaryItem.html#config_UID", "access": "", "host": "DiaryItem", "type": "config", "name": "UID"}, {"url": "DiaryItem.html#event_UIDChange", "access": "", "host": "DiaryItem", "type": "event", "name": "UIDChange"}, {"url": "DiaryItem.html#config_URL", "access": "", "host": "DiaryItem", "type": "config", "name": "URL"}, {"url": "DiaryItem.html#event_URLChange", "access": "", "host": "DiaryItem", "type": "event", "name": "URLChange"}, {"url": "DiaryItem.html#config_useAnimation", "access": "", "host": "DiaryItem", "type": "config", "name": "useAnimation"}, {"url": "DiaryItem.html#event_useAnimationChange", "access": "", "host": "DiaryItem", "type": "event", "name": "useAnimationChange"}, {"url": "DiaryItem.html#config_useCssCategories", "access": "", "host": "DiaryItem", "type": "config", "name": "useCssCategories"}, {"url": "YAHOO.widget.Diary.html#config_useCssCategories", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "useCssCategories"}, {"url": "DiaryItem.html#event_useCssCategoriesChange", "access": "", "host": "DiaryItem", "type": "event", "name": "useCssCategoriesChange"}, {"url": "YAHOO.widget.Diary.html#event_useCssCategoriesChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "useCssCategoriesChange"}, {"url": "DiaryDay.html#config_width", "access": "", "host": "DiaryDay", "type": "config", "name": "width"}, {"url": "YAHOO.widget.Diary.html#config_width", "access": "", "host": "YAHOO.widget.Diary", "type": "config", "name": "width"}, {"url": "DiaryDay.html#event_widthChange", "access": "", "host": "DiaryDay", "type": "event", "name": "widthChange"}, {"url": "YAHOO.widget.Diary.html#event_widthChange", "access": "", "host": "YAHOO.widget.Diary", "type": "event", "name": "widthChange"}];
</script>
</body>
</html>
